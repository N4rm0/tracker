2008-08-28  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-thumbnailer/tracker-thumbnailer.c: Use GChecksum instead
	of shipped MD5 implementation.
	* src/tracker-thumbnailer/Makefile.am:
	* src/tracker-thumbnailer/md5.[ch]: Removed MD5 implementation, no 
	longer necessary.

2008-08-28  Carlos Garnacho  <carlos@imendio.com>

	* data/sqlite-stored-procs.sql: Use '#' to begin comments.
	* src/libtracker-db/tracker-db-manager.c (load_prepared_queries): Skip
	lines that begin with '#'.

2008-08-28  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-thumbnailer/Makefile.am: Install thumbnailer in libexec.
	* src/tracker-indexer/Makefile.am:
	* tests/tracker-indexer/Makefile.am: define LIBEXECDIR
	* src/tracker-indexer/tracker-metadata-utils.c
	(tracker_metadata_query_file) (tracker_metadata_utils_get_thumbnail):
	Use LIBEXECDIR to locate both tracker-extract and tracker-thumbnailer.

2008-08-28  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (create_update_item): Avoid
	potential double frees.

2008-08-28  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-metadata-utils.c
	(tracker_metadata_watch_cb): Rename to process_watch_cb() and make
	generic to all spawned processes, so we don't leave defunct processes
	all around.

2008-08-27  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-ontology.c:
	(tracker_ontology_get_registered_field_types): Removed wrong
	g_critical, the categories can have "empty" parent.
	
2008-08-27  Ivan Frade  <ivan.frade@nokia.com>

	* data/services/default.service
	* data/sqlite-service-types.sql
	* data/sqlite-stored-procs.sql
	* data/sqlite-xesam.sql: Added new field to service type
	description called "PropertyPrefix", so we can specify that
	"Document" properties are "Doc:xxx"
	
	* src/libtracker-common/tracker-service.[ch]
	* src/libtracker-db/tracker-db-manager.c: Code to handle the new
	property.

	* src/libtracker-common/tracker-ontology.[ch]
	(tracker_ontology_get_registered_field_types): Implemented
	properly so now it return the property of the service type and his
	parent. This fixes the GetRegisteredTypes method in the API.
	
	* tests/libtracker-common/tracker-ontology-test.c: Updated tests.
	
2008-08-27  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-metadata-utils.[ch]
	(tracker_metadata_utils_get_thumbnail): Added back thumbnails
	creation.
	(tracker_metadata_utils_get_data): Call it from here.

2008-08-27  Mikael Ottela    <mikael.ottela@ixonos.com>
	* src/trackerd/tracker-rdf-query.c: Fixed a crash. Added
	additional '%' to sql like statements because vsprintf strips some 
	at execute_query level.

2008-08-27  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_check_state):
	Actually check the TRACKER_INDEXER_STATE_STOPPED flag...

2008-08-27  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Add new
	TRACKER_INDEXER_STATE_STOPPED flag.
	(check_started) (check_stopped): Use that flag.
	(tracker_indexer_init): Call directly tracker_indexer_check_state() to
	setup the idle functions.

2008-08-27  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-index.c (tracker_db_index_flush):
	Protect agains reentrancy, return the number of actually flushed
	items. Also, fail when adding if the cache is being flushed.
	* src/tracker-indexer/tracker-indexer.c
	(tracker_indexer_set_state_flags) (tracker_indexer_unset_state_flags)
	(tracker_indexer_get_state_flags): There are several reasons why the
	indexer would want to stop, and not all of them are relevant outside
	TrackerIndexer. This internal API will stop the indexer if any of the
	relevant flags is set.
	(tracker_indexer_[gs]et_running): Use internally the 
	TRACKER_INDEXER_STATE_PAUSED flag.
	(check_disk_space_cb): Use internally the
	TRACKER_INDEXER_STATE_DISK_FULL flag.
	(flush_data): Set the TRACKER_INDEXER_STATE_FLUSHING flag when
	flushing, so the indexing is temporarily stopped.

2008-08-27  Ivan Frade  <ivan.frade@nokia.com>

	* data/sqlite-stored-procs.sql
	* src/libtracker-common/tracker-ontology.[ch]
	* src/tracker-indexer/tracker-indexer-db.[ch]
	* src/tracker-indexer/tracker-indexer.c
	
	Added metadata updating when the file is updated. Remove the old
	embedded metadata and set the new values. Remove only the embedded to
	keep the tags and other user/application metadata.
	
2008-08-27  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-metadata-utils.c (tracker_metadata_read)
	(tracker_metadata_query_file): Handle again metadata_context being
	possibly invalidated during reading.
	(call_text_filter): Fix compiler warning.

2008-08-27  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-field.c
	* tests/libtracker-common/tracker-field-test.c
	* tests/libtracker-common/Makefile.am: Fixed detail in enum
	definition and added testing for enum->string function.

2008-08-27  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-daemon.c: Fixed a memory problem allocating 0
	bytes, found using valgrind

2008-08-26  Jamie McCracken <jamiemcc at gnome org>


	* src/libtracker-common/tracker-parser.c
	* src/libtracker-common/tracker-parser.h
	Made new API for tracker-parser more compatible
	with sqlite FTS3.
	
	* tracker-fts
	* tracker-fts/tracker-fts.c
	* tracker-fts/tracker-fts-hash.c
	* tracker-fts/Makefile.am
	* tracker-fts/tracker-fts.h
	* tracker-fts/tracker-fts-hash.h
	Created forked version of sqlite fts3 module called tracker-fts
	Integrated our parser and tweaked it to work fully with FTS3 api
	
	* tests/Makefile.am
	* configure.ac
	* src/Makefile.am
	* tests/tracker-fts
	* tests/tracker-fts/tracker-fts-test.c
	* tests/tracker-fts/Makefile.am
	Added test files for tracker-fts module

2008-08-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-metadata-utils.c (get_file_content):
	Don't allocate in the stack so much memory, even more when it's going
	to be copied around.

2008-08-26  Carlos Garnacho  <carlos@imendio.com>

	* src/Makefile.am:
	* src/libinotify/Makefile.am:
	* tests/common/Makefile.am:
	* tests/common/tracker-test-helpers.c:
	* tests/libtracker-common/Makefile.am:
	* tests/libtracker-db/Makefile.am: Fix distcheck, to some extent.

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-main.c: raised the "wait for more"
	timeout to 5 minutes. The indexer is harmless for the system's
	resources while waiting. VS. stopping and starting the indexer often
	isn't harmless for the system's resources.

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-processor.c: a patch fix for the processor. It
	seems that a timeout that happens after the indexer has shut down
	calls its callback. That callback sets the status back to indexing.

	When Martyn is back from holiday he should take a look at this.

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-processor.c: a patch fix for the processor. It
	seems that a timeout that happens after the indexer has shut down
	calls its callback. That callback sets the status back to indexing.

	When Martyn is back from holiday he should take a look at this.

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-daemon.c: Changed the way we emit the
	stats-changed signal. Fixes a crash.

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.c
	* src/libtracker-db/tracker-db-index.h
	* src/libtracker-db/tracker-db-index.c: Making flushing the index more
	responsive

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-index.c: removed a mutex. The API of
	tracker-db-index.h is never used by more than one thread. Therefore 
	can't there be a need for a mutex. If we do need a mutex, then just
	reverting this wont suffice: changes that will happen after this
	commit will require using a recursive mutex instead.

2008-08-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-daemon.c
	* src/trackerd/tracker-marshal.list
	* data/dbus/tracker-daemon.xml: Added a stats-changed signal

2008-08-26  Carlos Garnacho  <carlos@imendio.com>

	* tests/tracker-indexer/Makefile.am: Added LIBDIR define for
	tracker-metadata-utils.c

2008-08-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c
	(tracker_metadata_call_text_filter) (get_file_content): Moved to
	tracker-metadata-utils.c
	(tracker_module_file_get_text): Use these new functions.
	* src/tracker-indexer/tracker-metadata-utils.[ch]: Refactor
	MetadataContext so it can also spawn external text extractors.
	(tracker_metadata_utils_get_text): New helper function.

2008-08-25  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer-db.c
	* src/tracker-indexer/tracker-indexer.c:
	Using the new method also here to obtain path and name also here.
	
2008-08-25  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-file-utils.[ch]
	(tracker_file_get_path_and_name): New function to get the path and
	name of an uri. It removes some duplicate code and uses g_file
	to parse the path, so we can fix "x//y" in uris.
	
	* src/trackerd/tracker-db.c
	* src/trackerd/tracker-files.c: Using the new method, instead of
	the old code.
	
	* tests/libtracker-common/tracker-file-utils-test.c: Fixed minor
	things in previous tests and added test for the new method.
	

2008-08-25  Mikael Ottela   <mikael.ottela@ixonos.com>
	
	* src/tracker-extract/tracker-extract-gstreamer.c: Gstreamer
	extractor extracts now also images.	

2008-08-25  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-extract/Makefile.am:
	* src/tracker-extract/tracker-extract-ps.c: Fix up symbol not found
	that prevented the PS module to be loaded.
	* src/tracker-extract/tracker-extract.c (initialize_extractors):
	Provide a better error message if a module can't be loaded.

2008-08-22  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-monitor.c: Handle situations where the
	source or target are not monitored and emit the appropriate
	signals up the stack.
	
	* src/trackerd/tracker-processor.c: Check the source AND the
	target to see if they should be ignored or not when we get MOVE
	monitor events. If both are ignored, we do nothing, if source is
	ignored we create the new file in the database, if target is
	ignored we delete the old file in the database, if both are valid
	we do a simple move in the database. I say simple, it isn't that
	simple. :)

2008-08-22  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-dbus.c: Fix marshaller for Finished signal.

2008-08-22  Carlos Garnacho  <carlos@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-processor.c:
	* src/trackerd/tracker-xesam-manager.c: Added a missing argument to
	the Finished DBus signal definition in the indexer. Also updated all
	callers.

2008-08-22  Mikael Ottela    <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-db.c: Fixes to index and string type 
	metadata handling in queries.

2008-08-22  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-metadata-utils.c
	(tracker_metadata_read): Strip metadata separators when reading from
	the external extractor.

2008-08-22  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.c
	(tracker_indexer_module_file_get_uri): Reduce the warning to a debug
	message, it's still nice to have that info, but it isn't crucial
	either.

2008-08-22  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-index.c: (tracker_db_index_open),
	(tracker_db_index_flush): Fixed the g_return_val_if_fail() check
	for the priv->index already being set in tracker_db_index_open().
	Initially it is not set at all so the index was not being opened.
	Also, if we can't open the index, we now debug specifically if it
	was because the file doesn't exist yet or if it wasn't closed
	properly. 

2008-08-21  Martyn Russell  <martyn@imendio.com>

	* data/services/default.service: Added inode/; to the prefixes to
	recognise folders like $HOME/.xchat.
	
	* src/libtracker-common/tracker-ontology.[ch]: 
	* tests/libtracker-common/tracker-ontology-test.c: Added in
	tracker_ontology_get_db_by_service_type() a check for NULL service
	strings.

	* src/libtracker-common/tracker-parser.c: Cleaned up the code,
	fixed a nasty double free that was introduced recently. Do proper
	type checking for TrackerLanguage. Make sure we reference the
	language and unreference it when creating/freeing the parser.
	
	* src/libtracker-common/tracker-service.[ch]:
	(tracker_db_type_get_type): Added missing enumerations: unknown,
	files and xesam.
	
	* src/libtracker-db/tracker-db-manager.[ch]: Added
	TRACKER_DB_UNKNOWN type.
	
	* src/trackerd/tracker-db.[ch]: Make use of GStaticPrivate for the
	local data. Also instead of using priv->index, we now send the
	services we are interested in to TrackerQueryTree and it finds out
	what indexes it needs to use instead. Added a function to return a
	gint GArray for the service IDs needed for TrackerQueryTree too.

	* src/trackerd/tracker-query-tree.[ch]: Removed properties which
	shouldn't change after creation (like language and config).
	Removed the TrackerDBIndex parameter for _new() and just use the
	GArray for services now. We get the TrackerDBIndex from each
	service instead.
	
	* src/trackerd/tracker-search.[ch]: Use
	tracker_db_create_array_of_services() instead of duplicating the
	code here. Also try to get suggestions from the email index db if
	there are none from the files index db.

	* src/libtracker-db/tracker-db-index-manager.[ch]:
	* src/tracker-indexer/tracker-indexer.c: 
	* src/trackerd/tracker-db.c: 
	* src/trackerd/tracker-dbus.[ch]: 
	* src/trackerd/tracker-main.c: 
	* src/trackerd/tracker-processor.c: Now we have all email words
	indexed to their own email-index.db file instead of filling up one
	big index.db file. This was causing serious performance issues.
	
2008-08-21  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-index.c (tracker_db_index_open): Do not
	reopen/leak/corrupt data if there's already an index opened.
	(tracker_db_index_flush): Do not open index if it was closed, there
	could be good reasons for it.
	* src/tracker-indexer/tracker-indexer.[ch] (schedule_flush): Do not
	attempt to flush if the indexer is paused.
	(stop_transaction): No point in committing if there wasn't a
	transaction.
	(tracker_indexer_set_running): Refactored the flush out, calling it
	wherever it's needed. Also stop scheduled flushes so they aren't
	called while the indexer is paused.
	(check_disk_space_cb) (tracker_indexer_pause) (pause_for_duration_cb)
	(tracker_indexer_pause_for_duration) (tracker_indexer_continue):
	Update callers.

2008-08-21  Philip Van Hoof  <philip@codeminded.be>

        * src/libtracker-db/tracker-db-index.c: Regression fix on "There's 
	no need to flush the word index on pausing the indexer.": the current
	transaction was not always being committed anymore

2008-08-21  Mikael Ottela    <mikael.ottela@ixonos.com>

	* src/libtracker-db/tracker-db-interface.c: Bug fix. Added checking
	that row exists before reading for result sets.

2008-08-21  Carlos Garnacho  <carlos@imendio.com>

	* tests/tracker-indexer/Makefile.am: No need to include libxdgmime.la
	anymore.

2008-08-21  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c (get_text_for_mbox)
	(get_text_for_imap) (tracker_module_file_get_text): New functions, get
	the emails body through the get_text() module function, so it's saved
	in the contents DB.

2008-08-21  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-metadata-utils.[ch]
	(tracker_metadata_utils_calculate_merge): Addded funciont.
	Given two set of metadata (old and new) calculate a list of 
	actions to do in the DB (insert, delete or update)..
	
	* tests/tracker-indexer
	* tests/tracker-indexer/tracker-metadata-utils-test.c
	* tests/tracker-indexer/Makefile.am
	* tests/Makefile.am
	* configure.ac: Added unit tests to the previous function
	
2008-08-21  Ivan Frade  <ivan.frade@nokia.com>

	* data/service/image.metadata: Set the correct data types for the
	metadata.
	
2008-08-21  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (create_update_item)
	(should_index_file) (tracker_indexer_file_move): Check return value of
	tracker_indexer_module_file_get_service_type(), since it could return
	NULL for files the module doesn't handle.

2008-08-21  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-main.c: Run forever feature for the
	indexer, for debugging purposes

2008-08-21  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-ontology.c:
	(ontology_hash_lookup_by_str), (ontology_hash_lookup_by_id): Check
	the string is != NULL before using it in g_hash_table_lookup()
	which uses strcmp for string comparisons.

2008-08-21  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.c: Removed
	is_text_file() which is no longer used.

	* src/libtracker-common/tracker-parser.[ch]: Fixed the formatting
	and use gchar instead of char in new code. Removed unnecessary
	spacing and a LOT of trailing whitespace. Fixed the header file
	too.
	
	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/modules/Makefile.am:
	* src/trackerd/Makefile.am:
	* tests/libtracker-common/Makefile.am:
	* tests/libtracker-db/Makefile.am: Removed references to
	libxdgmime.la which was breaking the build.

2008-08-20  Jamie McCracken <jamiemcc at gnome org>

	* Added new API for tracker-parser so that it will be compatible
	with sqlite FTS3.

2008-08-20  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-file-utils.c
	(tracker_file_get_mime_type): Replace mimetype checking with GIO.
	* configure.in:
	* src/Makefile.am:
	* src/xdgmime/*: Nuked the local xdgmime copy.

2008-08-20  Martyn Russell  <martyn@imendio.com>

	* src/tracker-applet/tracker-applet.c: 
	* src/tracker-extract/tracker-extract-tiff.c:
	* src/tracker-indexer/tracker-indexer-db.c:
	* src/trackerd/tracker-xesam.c:
	* tests/libtracker-common/tracker-type-utils-test.c:
	* utils/qdbm/search-word.c: More uninitialised variable crapness
	fixed to make it the all new hotness.

2008-08-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-type-utils.[ch]: Renamed
	tracker_boolean_as_text_to_number() to
	tracker_string_boolean_to_string_gint(). 
	
	* src/libtracker-db/tracker-db-manager.c: Make use of
	tracker_string_boolean_to_string_gint() instead of using code
	which does the exact same thing. Also fixed 3 places which use
	uninitalised integers as part of their calculations.
	
	* src/tracker-indexer/modules/evolution.c:
	(get_mbox_recipient_list): When getting the recipients list, don't
	potentially add an uninitialised string.
	
	* src/trackerd/tracker-db.c: (get_backup_id): Don't reuse id here,
	call it something else and make this code work.
	
	* src/trackerd/tracker-keywords.c: (tracker_keywords_search):
	Don't check if "values" is != NULL since it is a local variable
	now not a gchar** like it used to be.
	
	* src/trackerd/tracker-metadata.c: (tracker_metadata_get): If
	there is no result set, set the values to NULL so we don't check
	for NULL against an uninitalised variable.
	
	* src/trackerd/tracker-monitor.c: (tracker_monitor_add): Fixed
	warning about unused variable when using libinotify.
	
	* src/trackerd/tracker-processor.c: (item_queue_processed_cb):
	Fixed warning about queue being uninitialised in NOP switch
	statement condition.
	
	* src/trackerd/tracker-search.c: (search_highlight_terms): If
	there are no search terms, don't rely on uninitialised "s"
	variable being set.
	
	* src/trackerd/tracker-xesam-query.c: (build_sql): Set value to
	NULL to initialise it and use
	tracker_string_boolean_to_string_gint() instead of duplicating the
	code to do the same thing.
	
	* src/trackerd/tracker-xesam.c: (tracker_xesam_get_state): Don't
	try to free random memory and make sure we NULL terminate the
	GStrv that is returned.

2008-08-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.c:
	(tracker_dbus_request_failed): If error is already set and there
	is no format, we do not set str which is used in a print statement
	and then freed. This could lead to serious stack corruption.

	* src/libtracker-db/tracker-db-index-manager.c:
	(has_tmp_merge_files): Don't print a warning with an uninitialised
	path string.
	
	* src/libtracker-db/tracker-db-index.c:
	(tracker_db_index_get_size): Actually return the size instead of
	returning an uninitialised size variable.
	
	* src/libtracker-db/tracker-db-interface-sqlite.c:
	(create_result_set_from_stmt): Set the busy count instead of
	incrementing random memory.
	
	* src/libtracker-db/tracker-db-manager.c:
	(load_service_file_xesam): If we can't map data id to a
	TrackerFieldType, don't just use an uninitialised integer. Now we
	use -1 and display a warning.

2008-08-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-dbus.c:
	(tracker_dbus_query_result_to_hash_table): Fixed a bug where
	field_count was redefined in a deeper code block overwriting the
	number of columns previously determined by an unintialised
	variable. 

2008-08-20  Martyn Russell  <martyn@imendio.com>

	* configure.ac: Clean up and remove the --enable-debug-tools. The
	-g option is automatic with autotools and most packaging systems
	(like debian's) have an option to strip binaries of debug symbols.
	In the worst case we can always use CFLAGS="..." before running
	./autogen.sh anyway.
	
	* src/trackerd/tracker-monitor.c: Fixed a nasty NULL deference
	spotted by Ross Burton.

2008-08-20  Carlos Garnacho  <carlos@imendio.com>

	* tracker.pc.in:
	* libtracker-gtk.pc.in: Moved also to data/
	* configure.ac:
	* Makefile.am:
	* data/Makefile.am: Modify corresponding autofoo.

2008-08-20  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/Makefile.am:
	* src/tracker-indexer/Makefile.am: Install both trackerd and
	tracker-indexer in $(prefix)/libexec, since they're not supposed to be
	executed by the user.
	* data/dbus/Makefile.am:
	* data/dbus/org.freedesktop.Tracker.service.in:
	* data/dbus/org.freedesktop.Tracker.Indexer.service.in: Look up the
	executables in $(libexecdir)
	* Makefile.am:
	* data/Makefile.am:
	* configure.ac:
	* trackerd.desktop.in.in: Moved trackerd.desktop.in.in to data/. Also
	correct path to trackerd.

2008-08-19  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-keywords.c: Removing keywords was not passing
	service_type correctly

2008-08-19  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.c
	* src/tracker-indexer/tracker-indexer.h
	* src/libtracker-db/tracker-db-index.c: There's no need to flush the
	word index on pausing the indexer.

2008-08-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-index.c: Don't try to open the
	index and flush if the cache size is < 1. This should fix a
	warning we were seeing about not being able to open the cache on
	startup and shutdown.
	
	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-monitor.c: Add support for libinotify to
	know about MOVE events.
	
	* src/trackerd/tracker-processor.[ch]: Added a move queue and API
	to use the new indexer move API when we know about
	files/directories that move.

2008-08-19  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-files.c
	(tracker_files_get_metadata_for_files_in_folder):
	Added NULL element at the end of the fields array. This fixes a
	segfault using the method.
	
2008-08-19  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/Makefile.am:
	* src/libinotify/.cvsignore:
	* src/libinotify/Makefile.am:
	* src/libinotify/inotify-handle.c:
	* src/libinotify/inotify-handle.h:
	* src/libinotify/inotify-listhash.c:
	* src/libinotify/inotify-listhash.h:
	* src/libinotify/inotify-log.h:
	* src/libinotify/inotify-monitor.c:
	* src/libinotify/inotify-monitor.h:
	* src/libinotify/libinotify.h:
	* src/libinotify/linux-inotify-syscalls.h:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-monitor.c: Add the initial inotify replacement work
	while glib upstream is fixed. This is to support MOVE events for
	files and directories. This is not yet working.
	
	* tests/common/Makefile.am: Fixed some small errors.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.[ch]
	(tracker_db_check_service): Modify to also get mtime.
	* src/tracker-indexer/tracker-indexer.c: Update all callers.
	(should_index_file) (process_file): Check mtimes before reindexing a
	file.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.c: Restore accidental
	revert of fix in r2093.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-extract/Makefile.am: Install tracker-extract in
	$prefix/libexec.
	* src/tracker-indexer/Makefile.am: specify tracker-extract path.
	* src/tracker-indexer/tracker-metadata-utils.c
	(create_metadata_context): Use defined tracker-extract path.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Emit the status signal every
	10 seconds, as flushes now can be more sparse.
	* src/libtracker-db/tracker-db-index.c (tracker_db_index_flush): Do
	not try to flush if there aren't items in the cache.

2008-08-19  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.c:
	(tracker_path_list_filter_duplicates): Don't append a trailing
	G_DIR_SEPARATOR_S when we return the list here. This standard is
	not used in the rest of Tracker and strcmp() was failing to notice
	ignored paths when checking against the config.
	
	* src/libtracker-common/tracker-type-utils.[ch]: 
	* src/libtracker-db/tracker-db-manager.c:
	* src/tracker-indexer/modules/evolution.c:
	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-indexer/tracker-indexer.c: 
	* src/tracker-indexer/tracker-metadata-utils.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-xesam-query.c:
	* tests/libtracker-common/tracker-type-utils-test.c: Changed all
	_{uint|int|long}_to_string() functions to rename them to
	_{guint|gint|glong}_to_string, to remain consistent with other
	functions. Added tracker_gslist_copy_with_string_data() to copy a
	list of strings. Also, changed many functions that return if an
	input parameter is NULL to actually return the proper data type if
	plausible since sometimes you would want to return an empty string
	list from NULL (for example).
	
	* src/trackerd/tracker-crawler.c: Make sure each directory is
	checked against the NoWatchDirectoryRoots config option and that
	each directory prefixed with "." is checked against the config
	WatchDirectoryRoots and CrawlDirectoryRoots options to know if we
	should NOT ignore those locations (by default they are). The
	crawler was also very slow (taking ~68 seconds to crawl my 130k
	files, so the throttle was decreased from 100 usecs to 25 usecs
	with the same CPU utilisation making the crawl take ~12 seconds
	instead). 
	
	* src/trackerd/tracker-processor.c: Make sure we check the
	NoWatchDirectoryRoots config before blindly adding roots to be
	checked to the crawler. Also print out what we are ignoring so we
	know why some things might not be crawled/watched.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-os-dependant-unix.c:
	* src/libtracker-common/tracker-os-dependant-win.c:
	* src/libtracker-common/tracker-os-dependant.h
	(tracker_spawn_async_with_channels): Added function.

	* src/tracker-extract/tracker-extract.c: Modified to read queried
	files from stdin and stay alive until it has stopped being asked for
	metadata. According to sysprof, tracker-metadata spent a long time in
	initialization due to being respawned once and again.

	* src/tracker-indexer/tracker-metadata-utils.c: Modified to send
	filename/mimetype pairs to the extractor through a pipe and keep track
	of the extractor state.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c (get_mbox_attachment_uri):
	Also remove ".sbd" from the mbox uris here.
	* src7tracker-indexer/tracker-indexer.c (struct
	TrackerIndexerPrivate): pack booleans into guints.
	(handle_metadata_add): Actually return a boolean if checks fail.

2008-08-19  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.c: Cleaned up a few things.

2008-08-19  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-index.c (indexer_update_word): Print
	error+cause if any insertion to the index fails.
	* src/tracker-indexer/tracker-indexer.c (create_update_item): Remove
	useless message, since there's already a similar one previous to it.

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* Makefile.decl:
	* tracker.spec:
	* README:
	* configure.ac:
	* acinclude.m4:
	* libtracker-gtk.pc.in: Fixed some trailing whitespace issues.

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-daemon.c: Use TrackerDaemonPrivate not Priv.
	* src/trackerd/tracker-db.c: Removed commented out code.

	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-files.[ch]: Use the processor for the
	org.freedesktop.Tracker.Files.{Create|Delete} interfaces so we
	make use of the processor's queues and do things all one way. This
	includes checking ignore lists, etc.

	* src/trackerd/tracker-keywords.c: Use TrackerKeywordsPrivate not Priv.
	* src/trackerd/tracker-processor.[ch]: Add public functions to
	check/update/delete files. This simply makes the functions we
	already have public which send files to the indexer to
	check/update/delete.

	* src/trackerd/tracker-search.c: Use TrackerSearchPrivate not Priv.

2008-08-18  Mikael Ottela    <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-rdf-query.c: Minor bug fix to rdf-queries.

2008-08-18  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.[ch]:
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-module.h: Move the module_name parameter
	from TrackerFile to PathInfo, such information is internal to the
	indexer, and modules shouldn't have to care about their own name.

2008-08-18  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.c
	(tracker_indexer_module_file_get_uri): Set dirname/basename to NULL if
	the function is going to return FALSE.
	* src/tracker-indexer/tracker-indexer.c (create_update_item): Check
	that the module could get the URI for the element being processed.

2008-08-18  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c
	(get_mail_storage_type_from_path): Ignore "Sent" folders.
	(get_mbox_uri): Remove ".sbd" from directory names, Evolution won't
	recognize that.

2008-8-18   Mikael Ottela    <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-search.c:
	* src/trackerd/tracker-search.h:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-rdf-query.h:
	* src/libtracker/tracker.h:
	* src/libtracker/tracker.c:
	* data/dbus/tracker-search.xml: Added sorting fields to rdf-queries.
	Fixed some problems with error reporting.

	* src/trackerd/tracker-metadata.c: Fixed limit and offset in unique
	values queries.

2008-08-18  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-index.c: Added a FIXME comment
	* ChangeLog: changed my E-mail address

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-ontology.c:
	* src/libtracker-common/tracker-type-utils.c:
	* src/libtracker-db/tracker-db-file-info.c:
	* src/libtracker-db/tracker-db-manager.c:
	* src/libtracker-gtk/tracker-metadata-tile.c:
	* src/tracker-extract/tracker-extract-html.c:
	* src/tracker-extract/tracker-extract-jpeg.c:
	* src/tracker-extract/tracker-extract-mp3.c:
	* src/tracker-extract/tracker-extract.[ch]:
	* src/tracker-indexer/modules/evolution.c:
	* src/tracker-indexer/modules/files.c:
	* src/tracker-indexer/modules/gaim-conversations.c:
	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-search-tool/tracker-search-tool-callbacks.c:
	* src/tracker-search-tool/tracker-search-tool-support.c:
	* src/tracker-search-tool/tracker-search-tool.c:
	* src/tracker-thumbnailer/tracker-thumbnailer.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-monitor.c:
	* src/trackerd/tracker-search.c:
	* tests/common/Makefile.am:
	* tests/common/tracker-test-helpers.[ch]:
	* tests/libtracker-common/tracker-file-utils-test.c:
	* tests/libtracker-common/tracker-ontology-test.c:
	* tests/libtracker-common/tracker-parser-test.c:
	* tests/libtracker-db/tracker-index-writer-test.c:
	* utils/qdbm/print-words.c:
	* utils/qdbm/search-word.c: Added -Wmissing-declarations
	-Wmissing-prototypes -Wunused warnings to the CFLAGS when using
	--enable-warnings. These files all had incorrect declarations or
	unused code which has been removed.

2008-08-18  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (handle_metadata_add): Correct
	check for GError.

2008-08-18  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c (get_file_content): Plug a leak.

2008-08-18  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-main.c: Unref the indexer before any
	manager it could make use of is shutdown. Also, ensure we disable the
	log handler after any other thing, so we catch any possible warning.

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* configure.ac: Add more warnings when they are enabled and clean
	up the summary of the configure script.

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/libtracker-common/Makefile.am:
	* src/libtracker-db/Makefile.am:
	* src/libtracker/Makefile.am:
	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/modules/Makefile.am:
	* src/tracker-utils/Makefile.am:
	* src/trackerd/Makefile.am:
	* tests/libtracker-common/Makefile.am:
	* tests/libtracker-db/Makefile.am:
	* tests/trackerd/Makefile.am:
	* tests/trackerd/xesam/Makefile.am:
	* utils/qdbm/Makefile.am: Don't use -g in every Makefile.am, it is
	added to CFLAGS with --enable-debug-code. Changed the CFLAGS to
	include -O0 too.

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-status.c: (tracker_status_signal):
	Incorrect state sent in status signal about pausing on battery.

2008-08-18  Martyn Russell  <martyn@imendio.com>

	* data/modules/files.module: Remove $HOME from the files module.
	It is not needed since it is in the user config already and it
	means users would have to change two places, IF they could change
	/usr/share at all anyway.

	* src/libtracker-common/tracker-utils.c: (tracker_throttle): If
	throttle is 0, don't return, always have a minimum of 5 for
	throttle added to whatever the config throttle value is. If we
	don't want to throttle, don't call the throttle function.

	* src/trackerd/tracker-crawler.c: (file_enumerate_children),
	(prune_none_existing_paths), (tracker_crawler_start):
	* src/trackerd/tracker-processor.c:
	(process_module_files_add_legacy_options):  Make sure that the
	legacy config option WatchDirectoryRoots ALSO crawls the file
	system, not just adds monitors. Plus check that we don't try to
	recurse non-existing paths when we start for paths NOT in the
	module config. Module config paths were already checked.

2008-08-14  Mikael Ottela   <mikael.ottela@ixonos.com>

	* src/tracker-extract/tracker-extract-tiff.c:
	(tracker_extract_tiff): Restored variables used conditionally by
	XMP extraction, previously removed because of compiler warnings.

2008-08-14  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/modules/files.c: Don't just use
	g_file_get_contents() because some files might be quite big.
	Instead only get the maximum size we would normally index for each
	file which is "Text" or a "Development" file.

2008-08-14  Carlos Garnacho  <carlos@imendio.com>

	Add FileMove DBus method to tracker-indexer.

	* data/dbus/tracker-indexer.xml: Define new method.
	* data/sqlite-stored-procs.sql: Add MoveService and
	MoveServiceChildren, stored procedures that actually switch paths in
	the DB.
	* src/libtracker-common/tracker-utils.[ch] (tracker_string_replace):
	Misc fix, that function should take const strings.
	* src/libtracker-db/tracker-db-manager.c (function_replace): Add a SQL
	function to replace a substring with other.
	* src/tracker-indexer/tracker-indexer-db.[ch]
	(tracker_db_move_service):
	* src/tracker-indexer/tracker-indexer.[ch]
	(tracker_indexer_file_move): Implement moving files in
	tracker-indexer.

2008-08-14  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-parser.[ch]: Fixed the way we
	handle memory with the hash words table here. We now also don't
	create the index word in memory before checking if we are
	filtering words and if it is a stop word only to then free it
	again which we were doing.

	* src/libtracker-db/tracker-db-index.c: (tracker_db_index_flush):
	If the index is not open when we try to flush, try and open it
	first.

	* src/tracker-extract/tracker-extract-tiff.c:
	(tracker_extract_tiff):
	* tests/libtracker-db/tracker-db-dbus-test.c:
	(test_dbus_query_result_to_ptr_array):  Fixed compiler warnings.

	* src/tracker-indexer/tracker-indexer.c: Fixed a nasty crash I
	introduced last commit and clean up the merge function for words
	tables. Plus make sure we free basename and dirname in
	delete_item(), this was quite a leak.

	* src/tracker-utils/tracker-files.c: (main): Fixed printing a %d
	as a %s.

	* src/trackerd/tracker-db.c: (update_metadata_index):
	* tests/libtracker-common/tracker-parser-test.c: Use
	g_hash_table_unref() instead of the custom function we had for the
	parser for freeing hash tables.

	* src/trackerd/tracker-processor.c: (tracker_processor_stop):
	Fixed a warning where the trackerd would stop before it started
	processing (due to Ctrl+C) and the private->timer was NULL, so
	using it caused warnings.

2008-08-14  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/modules/Makefile.am: Include -g so we get
	debugging symbols to use in gdb.

	* src/libtracker-common/tracker-language.[ch]: Change the
	_get_stem_word() API to return a const gchar*.

	* src/libtracker-common/tracker-ontology.c:
	(tracker_ontology_shutdown): Use g_hash_table_unref() instead of
	_destroy() in case the table is referenced somewhere else.

	* src/libtracker-common/tracker-parser.c: Use const strings from
	tracker_language_get_stem_word() instead of dups and modularise
	the code a bit more to make it clearer what is going.

	* src/tracker-indexer/modules/files.c:
	(tracker_module_file_get_text): Dont't use
	g_mapped_file_get_contents() with g_strdup() since the first call
	can return a NON-NULL-terminated string. Instead use
	g_file_get_contents(). We might want to improve this by using GIO
	functions later.

	* src/tracker-indexer/tracker-dbus.c: Fix compiler warning.

	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-indexer/tracker-indexer.c: Cleaned up the code,
	removed unnecessary parenthesis and casting.

	* src/tracker-indexer/tracker-indexer-module.c:
	(tracker_indexer_module_file_get_uri): If either basename or
	dirname pointers are NULL, make sure we free either one when they
	are.

	* src/tracker-indexer/tracker-indexer.c: Fixed a nasty memory leak
	in create_update_item() when calling tracker_db_get_text() and
	tracker_indexer_module_file_get_text() we now free the return
	values. Other memory improvements made here, like using the
	GHashTableIter instead of getting all keys and going through the
	list for after parsing text in send_text_to_index().

	* src/tracker-indexer/tracker-main.c: (main): Actually call the
	shutdown functions for dbus, log and db_index_manager. Now objects
	should all finalize properly.

	* src/tracker-utils/tracker-meta-folder.c: Refactored and made to
	use GOption now.

	* src/tracker-utils/tracker-files.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-tag.c:
	* src/tracker-utils/tracker-unique.c: Improved print formatting
	and don't use warnings for errors reported to us from DBus about
	the Tracker service.

2008-08-13  Mikael Ottela   <mikael.ottela@ixonos.com>

	* thumbnailers/image/Makefile.am:
	* thumbnailers/image/hildon:
	* thumbnailers/image/hildon/jpeg_thumbnailer:
	* thumbnailers/image/hildon/gif_thumbnailer:
	* thumbnailers/image/hildon/tiff_thumbnailer:
	* thumbnailers/image/hildon/png_thumbnailer:
	Added hildon-thumbnail based thumbnailer scripts for images.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c (get_metadata_for_imap): Do
	not perform any extra processing than just reading over mail when the
	message is junk/deleted.

2008-08-13  Mikael Ottela   <mikael.ottela@ixonos.com>
	* src/tracker-extract/tracker-extract-jpeg.c:
	* src/tracker-extract/Makefile.am:
	* src/tracker-extract/tracker-extract-tiff.c:
	* src/tracker-extract/tracker-xmp.c:
	* configure.ac: Extractors for jpeg and tiff added (EXIF and XMP).
	Old exif-extractor replaced.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-parser.c
	(tracker_parser_text_to_string): Check we're dealing with sane UTF8.
	* src/tracker-indexer/tracker-indexer.c	(index_metadata_item): Handle
	the case where tracker_parser_text_to_string() returns NULL.
	(delete_item) (create_update_item): Add debug messages that give a
	better clue about what is it doing at that moment.
	(process_file): Remove debug message from here.

2008-08-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-status.c: (tracker_status_signal): If we
	are told to signal but there is no TrackerDaemon object created
	yet, don't error, instead drop the signal request. This occurs
	when we start up the daemon with a reindex or first time index.

2008-08-13  Martyn Russell  <martyn@imendio.com>

	* src/tracker-utils/Makefile.am: Added GLib and GIO to the CFLAGS
	and LDFLAGS.

	* src/tracker-utils/tracker-tag.c: Refactored, fixed bugs, etc.

2008-08-13  Martyn Russell  <martyn@imendio.com>

	* src/tracker-utils/tracker-query.c: (get_meta_table_data):
	* src/tracker-utils/tracker-search.c: (get_meta_table_data):
	* src/tracker-utils/tracker-unique.c: (get_meta_table_data): Fix
	for these implementations.

2008-08-13  Martyn Russell  <martyn@imendio.com>

	* src/tracker-utils/tracker-files.c:
	* src/tracker-utils/tracker-query.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-stats.c:
	* src/tracker-utils/tracker-status.c:
	* src/tracker-utils/tracker-tag.c:
	* src/tracker-utils/tracker-unique.c: Fixed some of the printing
	where \n was omitted. Also fixed the includes for the Win32
	compatibility.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (main): Now shutdown the indexer
	when we shutdown.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/tracker-utils/tracker-query.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-unique.c: Fixed a memory leak.

	* src/tracker-utils/tracker-stats.c: Clean up.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/tracker-utils/tracker-files.c:
	* src/tracker-utils/tracker-meta-folder.c:
	* src/tracker-utils/tracker-query.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-stats.c:
	* src/tracker-utils/tracker-status.c:
	* src/tracker-utils/tracker-tag.c: Fix the tracker.h include to
	omit the "src/" part since we set up the include path in the
	CFLAGS.

	* src/tracker-utils/tracker-unique.c: Clean up.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-utils/tracker-files.c:
	* src/tracker-utils/tracker-meta-folder.c:
	* src/tracker-utils/tracker-query.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-stats.c:
	* src/tracker-utils/tracker-status.c:
	* src/tracker-utils/tracker-tag.c: Include correctly tracker.h.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/tracker-utils/Makefile.am: Added.

	* src/tracker-utils/tracker-files.c:
	* src/tracker-utils/tracker-query.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-status.c: Clean up these examples.
	More importantly make it show the help if the wrong parameters are
	used or none at all.

2008-08-12  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer.c: Added differential
	indexing of text contents when a file is updated.

2008-08-12  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-db/Makefile.am: Commented out some tests that
	need to run with an script. This fixes make distcheck.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-indexer.c (indexer_update_word): Behave
	nicely with 1-2 elements arrays. Use the correct array index when
	doing operations on the element at hand.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/Makefile.am:
	* src/libtracker/Makefile.am:
	* src/libtracker/tracker-files.c:
	* src/libtracker/tracker-get-meta-for-folder.c:
	* src/libtracker/tracker-query.c:
	* src/libtracker/tracker-search.c:
	* src/libtracker/tracker-stats.c:
	* src/libtracker/tracker-status.c:
	* src/libtracker/tracker-tag.c:
	* src/libtracker/tracker-unique.c:
	* src/tracker-utils/tracker-files.c:
	* src/tracker-utils/tracker-query.c:
	* src/tracker-utils/tracker-search.c:
	* src/tracker-utils/tracker-stats.c:
	* src/tracker-utils/tracker-status.c:
	* src/tracker-utils/tracker-tag.c: Moved all utilities to a
	tracker-utils folder instead of mixing them up with the libtracker
	library.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-dbus.c (indexer_continue_async_cb): Make error
	message more helpful.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* data/dbus/tracker-indexer.xml: Add Shutdown method.
	* src/tracker-indexer/tracker-indexer.[ch] (tracker_indexer_stop)
	(tracker_indexer_shutdown): Added internal and DBus method. Also added
	a gboolean parameter to ::finished so we know whether the indexing was
	interrupted.
	* src/tracker-indexer/tracker-marshal.list: modify marshaller for
	::finished.
	* src/tracker-indexer/tracker-main.c (indexer_finished_cb): Quit
	immediately if the indexing was interrupted.
	* src/tracker-indexer/tracker-dbus.c (name_owner_changed_cb)
	(dbus_register_object): Listen for changes in the daemon service
	ownership. If the daemon dissapears, shut down the indexer.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Change flushing parameters so
	it's not done that often. Ensure the number of elements left to
	process is reset to 0 after each flush.
	(process_directory): Do not get into hidden files/dirs.

2008-08-12  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-index.c (indexer_update_word): Improve
	performance CPU-wise when inserting words into the index. Perform
	binary searches on previous hits, since insertions are guaranteed to
	be ordered. Shift array over deleted values with g_memmove().

2008-08-12  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-keywords.c: Propagating errors coming from
	the indexer, instead overwrite them in the daemon.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-dbus.c: Don't resume indexing after the
	dbus request without checking if we are manually paused or paused
	for IO first.

	* src/trackerd/tracker-monitor.c: Make sure we pause when we get
	monitor events from the system.

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-processor.c: Don't send ANYTHING to the
	indexer or crawl any files while paused from IO as well as manually.

	* src/trackerd/tracker-status.c: Make sure we send the right state
	up to the applet about being paused from IO and for being on
	battery.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: Use GStaticPrivate for the private
	data here and make sure we tell the processor to stop now when we
	are given the shutdown signal.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (initialize_databases), (main):
	Fixed some errors in the last commit.

2008-08-12  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-processor.c:
	* src/trackerd/tracker-status.[ch]: Hold all valuable states in
	the status module, like is_readonly, is_first_time_index,
	is_running, etc.

2008-08-12  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-index
	(tracker_db_index_flush): It is not necessary to close and open
	the index after flush.

2008-08-11  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker/tracker-unique.c: Added new file.

2008-08-11  Ivan Frade  <ivan.frade@nokia.com>

	New methods GetSum, GetCount, GetUniqueValues. Patch by Mikael
	Ottela.

	* data/dbus/tracker-metadata.xml
	* src/trackerd/tracker-metadata.[ch]
	* src/trackerd/tracker-rdf-query.[ch]: Daemon side implementation.

	* src/libtracker/Makefile.am
	* src/libtracker/tracker.[ch]: Added methods in the library and
	created a tracker-unique program.

2008-08-11  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-dbus.c
	(tracker_dbus_query_result_to_ptr_array): Fixed memory leak and
	handle NULL content in a column.
	* tests/libtracker-db/tracker-db-dbus-test.c: Added tests for
	tracker_dbus_query_result_to_ptr_array

2008-08-11  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-monitor.c: (tracker_monitor_init),
	(monitor_event_cb): Improve the last commit so we use the _CHANGED
	event for FAM only because it is dumb and doesn't allow GIO to
	signal _CHANGES_DONE.

2008-08-11  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-monitor.c: (monitor_event_cb): Don't signal
	files to be reindexed on the _CHANGED event. Only on CHANGES_DONE
	which is for WRITE_CLOSE events.

2008-08-08  Martyn Russell  <martyn@imendio.com>

	* src/libstemmer/Makefile.am:
	* src/trackerd/Makefile.am:
	* src/tracker-indexer/Makefile.am:
	* tests/libtracker-common/Makefile.am: Renamed .la to just
	libstemmer from libstemmer-private.

	* src/libtracker-common/Makefile.am: Added libstemmer to the .la
	files we need so the tests don't fail to build.

	* src/libtracker-common/tracker-language.c: Fixed include path for
	libstemmer.

	* src/libtracker-common/tracker-utils.[ch]:
	* src/trackerd/tracker-crawler.c:
	* src/tracker-indexer/tracker-indexer.c: Added throttle function
	we use in the indexer to a common place for the daemon to use too.

	* src/trackerd/tracker-main.c: Add the throttle value to the
	sanity check for variables.

2008-08-08  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (process_func): Make sure we
	pause the crawling too when the user manually pauses.

2008-08-08  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (file_enumerate_next_cb),
	(file_enumerate_next): Now we get 100 files at a time from GIO
	instead of 1 at a time. This should reduce overheads when crawling
	the file system. Performance seems to be slightly better now too
	especially with the ioprio calls.

2008-08-08  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-ioprio.[ch]:
	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-ioprio.[ch]:
	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c: (main): Moved tracker_ioprio_init()
	to libtracker-common and use it in the daemon.

2008-08-08  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-ioprio.[ch]:
	* src/tracker-indexer/tracker-main.c: Don't require #ifdefs around
	the ioprio init, do it in the module instead.

2008-08-08  Martyn Russell  <martyn@imendio.com>

	* configure.ac: Improved the check for ioprio. Patch by Laurent
	Aguerreche.

2008-08-07  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c (get_metadata_for_imap):
	Ensure we parse the whole message if it was deleted/junk, so we keep
	parsing from the correct position for the next message.

2008-08-07  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-db/tracker-db-manager-test-attach.c:
	(test_always_same_iface_no_reindex): Removed. It was testing just
	an implementation detail.

	* tests/libtracker-db/tracker-index-reader-test.c
	* tests/libtracker-db/tracker-index-writer-test.c: Fixed namespace
	of the tests.

2008-08-07  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (check_disk_space_start)
	(check_disk_space_stop): New functions.
	(tracker_indexer_init): start the low disk check through these
	functions.
	(process_func):
	(tracker_indexer_set_running): Stop low disk check when the indexer
	finishes or is paused.
	(check_disk_space_cb): Pause the indexer if there's not enough disk
	space, but keep running the check.

2008-08-07  Ivan Frade  <ivan.frade@nokia.com>

	* tests/trackerd/example.index
	* tests/trackerd/tracker-index-test.c
	* tests/trackerd/Makefile.am: Moved trackerd index tests to
	libtracker-db as tracker-index-reader-test

	* tests/tracker-indexer
	* tests/tracker-indexer/Makefile.am
	* tests/tracker-indexer/tracker-index-test.c: Moved
	tracker-indexer tests to libtracker-db as
	tracker-index-writer-test. They were the only test for
	tracker-indexer so we also remove the folder.

	* tests/libtracker-db/example.index
	* tests/libtracker-db/tracker-index-writer-test.c
	* tests/libtracker-db/Makefile.am
	* tests/libtracker-db/tracker-index-reader-test.c
	* tests/Makefile.am
	* configure.ac: The index code is now merged in libtracker-db, so
	we move the unit tests to libtracker-db.

2008-08-07  Ivan Frade  <ivan.frade@nokia.com>

	* tests/trackerd/Makefile.am
	* tests/trackerd/tracker-index-test.c: Fixed tests and linked with
	new code.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (main): Fix the flag setting here.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (main): Make sure we open the db
	index in READONLY mode not READ/WRITE.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/Makefile.am: Make sure we compile with debug
	symbols for gdb.

	* src/libtracker-db/tracker-db-index.c: (tracker_db_index_open):
	Don't set priv->reload incorrectly, this meant we wouldn't get
	stats because we thought we couldn't open the file. This means
	t-s-t is now working again.

	* src/trackerd/tracker-query-tree.c: Use TRACKER_IS_LANGUAGE for
	TrackerLanguage now it is a GObject.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-index.c: Don't free the
	priv->filename before closing the index, causes weird debug
	messages which depend on that pointer.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-index.c: Make sure we close the
	index after flushing it and then reopen it.

	* utils/qdbm/Makefile.am: Added -g to CFLAGS here so we have debug
	symbols.

2008-08-07  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-index.c: Fixed min_bucket
	condition. It should be bigger than 0.

	* tests/tracker-indexer/tracker-index-test.c: Updated tests.

2008-08-07  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_set_running):
	Fix typo. Also try to flush the index before pausing.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* utils/qdbm/print-words.c: (main):
	* utils/qdbm/search-word.c: (main): Fixed printing help when args
	are broken.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* tests/libtracker-common/tracker-type-utils-test.c:
	* tests/tracker-indexer/Makefile.am:
	* tests/tracker-indexer/tracker-index-test.c: Removed dirty hacks
	for testing the index API and cleaned up the code a little.

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-index-item.[ch]:
	* src/libtracker-db/Makefile.am:
	* src/libtracker-db/tracker-db-index-item.[ch]:
	* src/libtracker-db/tracker-db-index.[ch]:
	* src/tracker-indexer/tracker-indexer.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-query-tree.c: Renamed TrackerIndexItem to
	TrackerDBIndexItem and TrackerSearchHit to TrackerDBIndexItemRank.
	Also moved those both to libtracker-db from libtracker-common.

	* src/tracker-indexer/tracker-index.[ch]: Removed in favour of the
	libtracker-db version.

	* utils/qdbm/Makefile.am:
	* utils/qdbm/print-words.c:
	* utils/qdbm/search-word.c: Fixed tools.

2008-08-07  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-index-item.h: Added
	TrackerSearchHit typedef here from the TrackerQueryTreeModule.

	* configure.ac:
	* src/libtracker-db/tracker-db-index-manager.[ch]:
	* src/libtracker-db/tracker-db-index.[ch]:
	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus.[ch]:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-metadata.[ch]:
	* src/trackerd/tracker-processor.c:
	* src/trackerd/tracker-query-tree.[ch]:
	* src/trackerd/tracker-search.[ch]:
	* src/trackerd/tracker-xesam.[ch]: Moved tracker-index.[ch] in the
	daemon and indexer into libtracker-db/tracker-db-index.[ch]
	combining the APIs and code.

	* tests/trackerd/tracker-index-test.c:
	* tests/trackerd/Makefile.am: Disabled the index test, it is
	broken.

	* utils/qdbm/print-words.c:
	* utils/qdbm/search-word.c: Fixed warnings.

2008-08-06  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-index-item.[ch]:
	* src/libtracker-db/Makefile.am:
	* src/libtracker-db/tracker-db-index-manager.[ch]:
	* src/libtracker-db/tracker-index-manager.[ch]:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-index.[ch]: Moved tracker-index.[ch] from
	the trackerd directory to the libtracker-db library.

2008-08-06  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/Makefile.am:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-index-manager.c:
	* src/trackerd/tracker-index-manager.h: Moved index manager to the
	libtracker-db.

2008-08-06  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-dbus.[ch]:
	* src/trackerd/tracker-index-manager.[ch]:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-processor.c:
	* src/trackerd/tracker-search.[ch]: Removed the email index since
	it is unused now.

2008-08-06  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c: Index IMAP attachments.

2008-08-06  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-index.c: Using g_param_spec_boolean to set
	a boolean parameter.
	* tests/trackerd/tracker-index-test.c: Updated test.

2008-08-06  Ivan Frade  <ivan.frade@nokia.com>

	* data/services/default.service: Set HasMetadata to False in
	Folder category. It is not necessary to call tracker-extractor
	for folders.

2008-08-06  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-index-manager.c
	(tracker_index_manager_init): Dont force reindex if one file is
	missing. It was removing file-index.db every time we started
	trackerd.

2008-08-06  Martyn Russell  <martyn@imendio.com>

	* AUTHORS: Sorted the AUTHORS file alphabetically and added Me,
	Carlos, Ivan, Mikael and Phillip.

2008-08-05  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-module.h
	(tracker_module_file_get_service_type):
	* src/tracker-indexer/tracker-indexer-module.[ch]
	(tracker_indexer_module_file_get_service_type): Modify to receive a
	TrackerFile.
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/modules/dummy.c:
	* src/tracker-indexer/modules/files.c: Adapt to this change.
	* src/tracker-indexer/modules/evolution.c: Implement this method to
	get the correct service type for attachments.

2008-08-05  Ivan Frade  <ivan.frade@nokia.com>

	* data/services/default.metadata: User:Keywords is not filtered.

	* src/tracker-indexer/tracker-indexer-db.[ch]:
	(tracker_db_get_property_values): Implemented new method to obtain
	the values of a property. Needed to unindex those values before
	remove the property.
	(tracker_db_set_metadata): Handle deletion of keyword properties
	without specified value (for instance, to remove all User:Keyword
	properties of a file.

	* src/tracker-indexer/tracker-indexer.c: Now takes into acount if
	the field has multiple values. Set a field with no-multiple values
	remove the old value and set the new one.

	* src/trackerd/tracker-keywords.c
	(tracker_keywords_remove_all): Implemented calling to the indexer
	directly, instead retrieving the old values from the DB and
	calling the indexer for each one.

	* src/trackerd/tracker-metadata.c
	(tracker_metadata_set_property): Removed useless service type
	check.

2008-08-05  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c: Add attachments indexing
	for mboxes. Now the module iterates through messages, and through the
	contained identifiable mime parts (if any).

2008-08-05  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-metadata-utils.[ch]: Added files,
	generic utility functions for extracting metadata from a file.
	* src/tracker-indexer/modules/files.c: Use these functions to get
	metadata from files.

2008-08-05  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-dbus.[ch]: Added new method
	(tracker_dbus_result_set_numeric_to_strv) needed to retrieve data
	from the numeric metadata table.

2008-08-05  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-processor.c: Don't send items to the
	indexer if we are manually paused. This was caused by receiving
	monitor events and just blindly sending them without checking if
	we should or not.

2008-08-05  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-main.c: Make sure we don't just exit
	when we have processed items. ALWAYS wait at least 10 seconds
	before quitting after EVERY "finished" signal. The indexer was
	being started/stopped constantly for small monitor event groups.
	Now it runs constantly.

	* src/trackerd/tracker-monitor.c: Make some of the logging debug
	level so we don't spam the console so much.

	* src/trackerd/tracker-processor.c: Set state as indexing in the
	queue handler callback.

2008-08-05  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-monitor.[ch]: Add property to enable and
	disable monitor events from being processed.

	* src/trackerd/tracker-processor.c: Make sure we disable monitor
	events while crawling the file system and enable then once done.
	This way we can't get monitor events causing the daemon to signal
	"indexing" state up before we have finished processing each module
	for crawling. Also, when we start processing new files from
	monitor events, put us into "indexing" state instead of staying
	"idle".

2008-08-05  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	(tracker_crawler_is_path_ignored): Add to the comment in this
	function so people know why we have an internal function and an
	external function doing the same thing.

	* src/trackerd/tracker-monitor.c:
	* src/trackerd/tracker-processor.[ch]: Changed the way we get
	*Private data in these modules so we don't do type checking on the
	GObjects for every function just to get the private struct.
	This should improve speed slightly. This is exactly what the
	crawler does.

2008-08-05  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/modules/evolution.c: Use g_try_malloc0
	instead of just g_malloc0 so we don't try to allocate rediculous
	lengths of memory and abort. Also, if we can't parse the file, we
	now return NULL metadata and continue as usual.

	* src/tracker-indexer/tracker-indexer.c: Improved messaging.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer.c: Using GError in the
	metadata handlers to report proper error to the daemon.

2008-08-04  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (delete_item): Do not try to
	delete items that don't exist in the database.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-dbus.c
	(tracker_dbus_request_failed): If the format of the message is
	null and the error is set, we log the existing message. This
	allows tracker to log the errors coming from the indexer.

	* tests/libtracker-common/tracker-dbus-test.c: Unit test to the
	implementation.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-metadata.c: Now uses the indexer to write
	metadata in the database.

	* src/trackerd/tracker-db.[ch]
	(tracker_db_metadata_get_array): Added this new method moving code
	from tracker-metadata.
	Removed old commented code.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* data/services/audio.metadata: The embedded properties cannot be
	written by the user. Marked "PlayCount" and "Last play date" as
	not embedded.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-type-utils.[ch]
	(tracker_string_to_string_list): new helper function.

2008-08-04  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-monitor.c: Added black listing. This works
	slightly differently to TRUNK. Files are given a black list count
	for the number of times an event is seen. If a file gets an event
	more than 5 times they are black listed for 30 seconds, after that
	time the item is taken off the black list and the indexer is
	prompted to reindex the file. The 30 second period has to be
	completely clear of events for that file during that time. If an
	event occurs in the mean time, the timestamp is reset.

2008-08-04  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.[ch]:
	* src/trackerd/tracker-processor.c: Removed TrackerHal
	dependency, it is unused in this module now.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer-module.[ch]
	(tracker_indexer_module_file_get_service_type): Call the function
	tracker_module_file_get_service_type in the module. If this
	function doesnt exist, use the module name as service type of the uri.
	* src/tracker-indexer/tracker-indexer.c
	* src/tracker-indexer/tracker-module.h
	* src/tracker-indexer/modules/dummy.c
	* src/tracker-indexer/modules/files.c
	(tracker_module_file_get_service_type): New function to obtain the
	service type of an uri. Implementation in the files module and
	explanation in "dummy" module.

2008-08-04  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.[ch]: Make the is_path_ignored()
	function we used internally available externally as an API for the
	processor to call when we get new monitor events. This is to make
	sure we don't monitor files newly created just because they are in
	some directory. They too adhear to the filtering.

	* src/trackerd/tracker-daemon.c: Fixed referencing so we now
	actually finalize the daemon and the processor modules.

	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-monitor.c: Added "is_directory" boolean
	to monitor events.

	* src/trackerd/tracker-processor.c: Now we create a TrackerCrawler
	for each module and we don't clean them up after the module is
	processed, we keep them around for the duration of the daemon's
	life. The reason being, we need to make sure we can call on the
	crawler for monitor event path filtering.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	Reverted previous commit.

2008-08-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/Makefile.am
	* src/trackerd/tracker-index-searcher.[ch]: Added
	* src/trackerd/tracker-query-tree.[ch]: Removed
	* src/trackerd/tracker-index.c
	* src/trackerd/tracker-search.c
	* src/trackerd/tracker-xesam.c
	* src/trackerd/tracker-db.c:
	Renamed tracker-query-tree to tracker-index-searcher

2008-08-01  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-keywords.c:
	Use sync calls to the indexer. Tracker-search-tool query for the
	tags just after setting them.

2008-08-01  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.[ch]:
	* src/tracker-indexer/tracker-main.c: Add check for low disk space,
	which pauses the indexer when it detects the available space at the
	home partition is below some configurable threshold.

2008-08-01  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer.c:
	(tracker_indexer_property_remove)
	(tracker_indexer_property_add):
	Return a dbus error if something fails.

2008-08-01  Carlos Garnacho  <carlos@imendio.com>

	Make tracker-indexer delete items if the module returns NULL metadata,
	instead of getting requests from tracker. This is necessary to delete
	mails and contents of other container files.

	* src/tracker-indexer/tracker-module.h (tracker_module_file_get_uri):
	New method for modules to optionally implement. It will return
	dirname/basename for the current item.
	* src/tracker-indexer/tracker-indexer-module.[ch]
	(tracker_indexer_module_file_get_uri): Added wrapping method.
	* src/tracker-indexer/tracker-indexer.c: Do not pass the ItemAction
	around, instead take the decision based on whether the module returns
	metadata or not for the current item. Use new module API to know the
	item URI, instead of looking it up in the metadata.
	* src/tracker-indexer/tracker-indexer-db.[ch]
	(tracker_db_get_service_type) (tracker_db_create_service)
	(tracker_db_check_service): Modify API to pass directly the
	dirname/basename.
	* src/tracker-indexer/modules/dummy.c:
	* src/tracker-indexer/modules/files.c:
	* src/tracker-indexer/modules/evolution.c: Implement new method where
	necessary, also return NULL metadata if the item doesn't exist, was
	deleted, etc...

2008-08-01  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Mere whitespace/formatting
	fixes.

2008-08-01  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer-db.c:
	(tracker_db_delete_metadata): It is neccesary to specify the value
	to remove a keyword property.

	* src/trackerd/tracker-keywords.c:
	Use the indexer to set and remove tags

2008-07-31  Ivan Frade  <ivan.frade@nokia.com>

	* data/dbus/tracker-indexer.xml
	* src/tracker-indexer/tracker-indexer-db.[ch]
	* src/tracker-indexer/tracker-indexer.[ch]:
	New methods ("PropertySet" and "PropertyRemove") in
	tracker-indexer.

2008-07-31  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-index.c
	* tests/tracker-indexer/tracker-index-test.c:
	When we added and removed a word before indexing, the word was
	saved with score 0 (and it is wrong). Test and fix.

2008-07-31  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Add back some leak fixes, and
	fix some trailing whitespaces.

2008-07-31  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-processor.c:
	(crawler_processing_directory_cb): Send the folders as regular
	file to the indexer.

2008-07-31  Ivan Frade  <ivan.frade@nokia.com>

	* data/sqlite-stored-procs.sql
	* src/tracker-indexer/tracker-indexer-db.[ch]
	* src/tracker-indexer/tracker-indexer.c:
	Added deletion superpowers to the indexer.

2008-07-31  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-common/tracker-parser-test.c:
	Added test to tracker_parser_text_fast

2008-07-31  Ivan Frade  <ivan.frade@nokia.com>

	* utils/qdbm/Makefile.am
	* utils/qdbm/print-words.c
	* src/libtracker-common/tracker-index-item.[ch]
	* src/libtracker-common/tracker-index-item.h:
	(tracker_index_item_get_id): New method to access id.
	Using the common tracker-index-item instead a local copy in the
	utility program.

2008-07-30  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-utils.c (tracker_seconds_to_string):
	* src/tracker-indexer/tracker-indexer.c (index_text_contents)
	(process_file): Plug a few leaks.

2008-07-30  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-metadata.[ch]: Make it accept just
	strings and lists of strings at the moment, strings are anyways needed
	to insert values through stored DB procedures, and there are some
	metadata types that will be difficult to store in a generic way.
	Since this API will be used from third party code, any failure in
	there will be quite hard to debug if we use a generic API, (it will
	probably crash inside tracker-indexer code, making things harder).
	By using strings we guarantee that at least sloppy third party module
	developers will get compiler warnings, which is safer.
	* src/tracker-indexer/tracker-indexer.c (index_metadata_item): Adapt
	to API change.
	* src/tracker-indexer/modules/files.c (tracker_metadata_get_embedded):
	Remove unnecessary check.

2008-07-30  Carlos Garnacho  <carlos@imendio.com>

	* data/services/audio.metadata: Genre and Performer shouldn't have
	multiple values.

2008-07-30  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (process_func): Reset the
	number of processed items after committing a transaction.

2008-07-29  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-common/tracker-file-utils-test.c
	* src/libtracker-common/tracker-file-utils.c: Set correct mime
	type to directories.

	* data/services/default.service: Lined x-directory/ mime with
	Folders category.

	* tests/libtracker-common/tracker-ontology-test.c:
	Test for the previous fix.

2008-07-29  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-ontology.c
	(tracker_ontology_metadata_key_in_service): Valid metadata keys start
	from number 1.
	* src/tracker-indexer/tracker-indexer-db.c (tracker_db_set_metadata):
	Store corresponding metadata into the Services table.

2008-07-29  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-index-manager.[ch]: Rework the code here to
	initialize a bit more thoroughly and to print what is going on
	more clearly similar to how we do the db manager. Also make sure
	we remove indexes on reindex, not just temporary files.

2008-07-29  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c (get_metadata_for_mbox)
	(get_imap_message_body) (get_metadata_for_imap): Index message body
	for both mbox and imap.

2008-07-29  Carlos Garnacho  <carlos@imendio.com>

	Support saving metadata with multiple items.

	* src/tracker-indexer/tracker-metadata.[ch]: Old code was removed,
	these files now contain a TrackerMetadata struct, which is used to
	store metadata, taking care of the type, whether it has multiple
	items, how data must be freed, ...
	* src/tracker-module.h:
	* src/tracker-indexer-module.[ch]: Adapt modules API to return a
	TrackerMetadata instead of a GHashTable for metadata.
	* src/tracker-indexer/tracker-indexer-db.c: Use TrackerMetadata API.
	Also support storing metadata with multiple values.
	* src/tracker-indexer/modules/*.c: Adapt to module API changes, also
	store metadata lists where appropriate (mimetypes/categories for
	applications, recipients for mail).

2008-07-28  Ivan Frade  <ivan.frade@nokia.com>
	* src/tracker-search-tool/tracker-search-tool.c:
	(g_search_app_create): Remove hardcoding in the category ->
	service description hash table. This fixes the categories in
	tracker-search-tool.

2008-07-28  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-indexer.c:
	(index_text_contents): Added function to add the contents of the
	file into QDBM.

2008-07-28  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-index-manager.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-index-manager.h:

	Removing the QDBM indexes in case of force-reindex

2008-07-28  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-language.c:
	(tracker_language_stem_word): Return always a valid word, the
	input or the stemmed one.

	* src/libtracker-common/tracker-parser.c:
	(analyze_text): Added stop words checking

	* tests/libtracker-common/tracker-parser-test.c: Updated tests
	with stop words.

2008-07-28  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-language.c:
	(tracker_language_new): Set stop words on creation.
	(language_get_stopword_filename): Build correct filename.
	(language_add_stopwords): Dont free contents of g_mapped_file

	* tests/libtracker-common/Makefile.am
	* tests/libtracker-common/tracker-parser-test.c: Added tests to
	tracker_parser_

2008-07-28  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-common/tracker-ontology-test.c:
	(test_get_db_for_service): Updated to new default value.
	Used proper namespace for tests.

	* src/libtracker-common/tracker-parser.c:
	(tracker_parser_text): Fixed max words to index

2008-07-28  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Added compress and
	uncompress functions for attached database connections

2008-07-28  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-metadata.c:
	* src/libtracker-db/tracker-db-dbus.h:
	* src/libtracker-db/tracker-db-dbus.c:

	Make tracker_metadata_get return the columns as a GStrv, not the rows.
	This patch fixed tracker-search-tool's crash

2008-07-28  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-crawler.c (file_enumerate_next_cb): Do not leak
	file infos and the enumerator.
	(tracker_crawler_start): Free remaining elements in the list.
	* src/trackerd/tracker-main.c (main): The index objects are owned by
	the index manager. Do not free them there.
	* src/trackerd/tracker-monitor.c (tracker_monitor_init): Do not leak
	the test monitor.

2008-07-28  Philip Van Hoof  <philip@codeminded.be>

	* utils/qdbm/print-words.c: Open the qdbm file in DP_ONOLCK mode, like
	the application itself does

2008-07-28  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-index.c:
	* src/tracker-indexer/tracker-index.h:
	* src/tracker-indexer/tracker-indexer.c:

	Open and close the QDBM file during pause and continue

2008-07-28  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-config.c (config_load_string_list)
	(tracker_config_add_watch_directory_roots)
	(tracker_config_add_crawl_directory_roots)
	(tracker_config_add_no_watch_directory_roots): Plug some leaks.
	* src/libtracker-db/tracker-db-manager.c (db_get_static_data)
	(db_get_static_xesam_data): Same here.
	* src/tracker-indexer/modules/evolution.c
	(get_account_name_from_imap_uri): Do not try to parse the wrong mail
	URIs.
	* src/tracker-indexer/tracker-index.c (tracker_index_free): Fix
	invalid memory reads.
	* src/tracker-indexer/tracker-indexer (tracker_indexer_finalize): Fix
	invalid free().

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-dbus.c:
	(tracker_dbus_query_result_to_ptr_array): Make sure we rewind
	result sets before trying to create GStrv, GPtrArray or GHashTable
	pointers from them. This means the tracker-search-tool now shows a
	list of categories with the indexed count next to them - still not
	sure why the content is not listed but the service types are all
	wrong.

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db.c: Finding a dud hit is no longer a
	warning, just a regular message.

	* src/trackerd/tracker-index-manager.c: Reworked the way we get
	indexes so we remember them to avoid creating too many
	TrackerIndex objects. Also fixed a nasty bug here which was
	getting one for EVERY time the status callback was triggered by
	the indexer :O

	* src/trackerd/tracker-index.c: Cleaned up the code a bit and put
	some more locking in place. This is redundant for now since we
	don't have a multithreaded approach at the moment.

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* tests/trackerd/Makefile.am:
	* tests/trackerd/tracker-index-test.c:
	(test_created_file_in_the_mean_time): Fixed compilation errors.

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-processor.c: (indexer_status_cb),
	(indexer_finished_cb): Call the index reload function when we get
	status updates from the indexer.

	* tests/trackerd/tracker-indexer-test.c: Renamed to reflect new
	TrackerIndex name.

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus.[ch]:
	* src/trackerd/tracker-index-manager.[ch]:
	* src/trackerd/tracker-index.[ch]:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-query-tree.[ch]:
	* src/trackerd/tracker-search.[ch]: Renamed
	TrackerIndexer->TrackerIndex, since it is the index not the
	indexer.

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-db.h:
	* src/trackerd/tracker-dbus.h:
	* src/trackerd/tracker-index-manager.h:
	* src/trackerd/tracker-index.c:
	* src/trackerd/tracker-indexer.[ch]:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-metadata.[ch]:
	* src/trackerd/tracker-query-tree.h:
	* src/trackerd/tracker-search.[ch]:
	* src/trackerd/tracker-xesam.[ch]: Renamed tracker-indexer to
	tracker-index.

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-index-manager.[ch]:
	* src/trackerd/tracker-indexer.h: Code clean ups.

2008-07-25  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-indexer.[ch]: Added "reload" capabilities
	to the indexer.

	* tests/trackerd/Makefile.am
	* tests/trackerd/tracker-indexer-test.c: Tests to the new
	functionality. This tests use GIO to copy a file.

2008-07-25  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus.c: Don't try to pause the indexer if
	it's not running

2008-07-25  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker/tracker-query.c
	* src/libtracker/tracker-search.c
	* src/libtracker/tracker-tag.c
	* src/libtracker/tracker-stats.c
	* src/libtracker/Makefile.am
	* src/libtracker/tracker-get-meta-for-folder.c
	* src/libtracker/tracker-files.c
	* src/libtracker/tracker-status.c:

	Various code improvements to the clients

2008-07-25  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.c: If we can't get the
	property for a device that no longer exists, then don't make that
	a critical, just set the device as unmounted and print a regular
	message.

	* src/trackerd/tracker-crawler.[ch]: Move the removable media path
	check to the processor since we should be filtering paths before
	the crawler even starts. Also, make it possible to crawl special
	locations set with the API instead of the module-config paths.

	* src/trackerd/tracker-monitor.c: (monitor_event_cb): On unmount,
	tell the indexer that the directories has gone. Not sure yet if
	the indexer will be clever enough to remove all files below it.

	* src/trackerd/tracker-processor.c: Handle removable media now.
	This work is working on a basic level, there are some issues still
	to be ironed out.

2008-07-24  Carlos Garnacho  <carlos@imendio.com>

	* data/modules/files.module: Remove service type, so the indexer uses
	file mimetype.

2008-07-24  Carlos Garnacho  <carlos@imendio.com>

	Store things in the correct DB based on the service type.

	* src/libtracker-common/tracker-ontology.c
	(tracker_ontology_get_db_for_service_type): Return
	TRACKER_DB_TYPE_FILES by default, as most of the services want to end
	up there.
	* src/libtracker-db/tracker-db-manager.[ch]
	(tracker_db_manager_get_db_interface_by_type): New function, returns a
	non-attached interface given the service type and the data content we
	want to deal with (contents/metadata).
	* src/tracker-indexer/tracker-indexer-db.[ch]: Pass the TrackerService
	instead of a TrackerDBInterface where it's relevant, so functions can
	guess the correct database based on it.
	* src/tracker-indexer/tracker-indexer.c: Adapt to API changes in
	tracker-indexer-db.[ch].

2008-07-24  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.[ch]:
	* src/trackerd/tracker-main.c: Make it possible to disable modules
	on the command line.

2008-07-24  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-extract/tracker-extract-mp3.c: Property names with
	":" instead of ".". Fixed mime. Mp3 are audio/mpeg and not audio/mp3.

2008-07-24  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-processor.c: Fixed some warnings.

2008-07-24  Ivan Frade  <ivan.frade@gmail.com>

	* Makefile.am
	* configure.ac
	* utils/Makefile.am
	* utils/qdbm/Makefile.am: Using autotools to build helper
	programs.

	* utils/qdbm/Makefile: Removed.

2008-07-24  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-daemon.xml:
	* src/tracker-applet/tracker-applet.c: Signal how many items are
	done/remaining/total instead of files/folders. This is much more
	generic for whatever is being indexed.

	* src/trackerd/tracker-daemon.c: Don't set the daemon/indexer as
	"manually paused" if we get paused/continued state from the
	indexer, only set that when the user sets it using DBus.

	* src/trackerd/tracker-dbus.c:  Don't synchronously continue the
	indexer, do it asynchronously.

	* src/trackerd/tracker-processor.c: When we get state from the
	indexer, signal it up the stack so the applet knows how many items
	have been indexed as we are doing it. This was completely
	forgotten about until now!

	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-status.[ch]: Initialize and shutdown the
	status module. The only reason for adding this is because we need
	TrackerConfig for some of the information we emit when we signal
	status. We now correctly signal if we are on battery or not and if
	we are paused for IO (i.e. if we are indexing or not). This is now
	correctly reflected in the tooltip in the applet.

2008-07-24  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Don't increase incorrectly
	the number of items processed. Also, split Files/Items processed
	count, so we get status signalling correctly, and we still flush when
	processing files with several items in it.

2008-07-24  Ivan Frade  <ivan.frade@nokia.com>

	Small programs to show and search in the contests of QDBM file.
	Useful for testing.

	* utils/qdbm/Makefile
	* utils/qdbm/search-word.c: search a word in the QDBM file
	* utils/qdbm/print-words.c: print all words in the file and also
	their hits (pairs of service id and service type).

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.c: Don't leak from calling
	tracker_path_list_filter_duplicates().

	* src/trackerd/tracker-crawler.[ch]: Don't just iterate the FIRST
	path in the list of paths and recurse paths, make sure we iterate
	2,3,4,etc. too. Also make it possible to add paths to be iterated
	as a public API.

	* src/trackerd/tracker-monitor.[ch]: Put the module_name parameter
	before the GFile since that's how it is done everywhere else.

	* src/trackerd/tracker-processor.c: Implemented the old config
	option WatchDirectoryRoots and CrawlDirectoryRoots.

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.c:
	(config_dir_ensure_exists_and_return): Use file-utils functions
	instead of duplicating code here. Make sure we filter for
	duplicates no-watch-roots, watch-roots and crawl-roots.

2008-07-23  Carlos Garnacho  <carlos@imendio.com>

	Check that a service exists before inserting it again in the database.

	* src/tracker-indexer/tracker-indexer-db.[ch]
	(get_dirname_and_basename): New helper function.
	(tracker_db_check_service): New function, returns the ID for the
	service (if any).
	* src/tracker-indexer/tracker-indexer.c (process_file): Check that the
	service doesn't exist before trying to index it.

2008-07-23  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/applications.c:
	* src/tracker-indexer/modules/evolution.c:
	* src/tracker-indexer/modules/files.c:
	* src/tracker-indexer/tracker-indexer.c: Revert the "use TrackerField
	as metadata keys" patch, it's incomplete at the moment and adds extra
	lookup overhead. Probably a TrackerMetadata simple object to collect
	data and do some caching would be the best option.

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/tracker-indexer/tracker-indexer.[ch]: Changed _set_paused()
	API to have _pause(), _continue() and _pause_for_duration().

	* src/libtracker-common/tracker-dbus.[ch]:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-dbus.[ch]:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-search.c:
	* src/trackerd/tracker-xesam.c: Completely rework Phillip's patch
	to pause the indexer when daemon requests come in. Instead of
	littering the DBus code with pause/continue calls, we add a
	hook to the DBus request_new() and request_{success|failed)()
	functions so we know when a request starts and ends. We then
	simply pause the indexer and wait for at least 10 seconds of
	DBus request inactivity before allowing the indexer to continue as
	normal.

	* src/trackerd/tracker-main.c: Used the new _pause_for_duration()
	API when shutting down because sometimes the daemon has to wait
	because the indexer has the lock on the database.

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (main): Call nice() to try and
	limit how much attention the daemon gets from the CPU.

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (main), (tracker_shutdown): Make
	sure we signal when we shutdown and also if we are started in
	readonly mode make sure we set our status to IDLE.

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-monitor.c: Code clean ups.

	* src/trackerd/tracker-processor.c: Improved efficiency of the get
	queue function we use in each timeout to send files to the indexer.

2008-07-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-monitor.c:
	* src/trackerd/tracker-processor.c: Don't create a gchar* for
	EVERY file we crawl just to move it from one queue to another,
	instead, just make the queue use GFile pointers and ref the one we
	are passed. This has halved the memory consumption of the daemon
	and speed things up. It also shouldn't hang while crawling now.

2008-07-23  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus.c: Style fixes
	* src/trackerd/tracker-xesam.c: Wrapped db related functions

2008-07-22  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-index.c:
	Use the new TrackerIndexItem instead old duplicate code.

2008-07-22  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-dbus.h:
	* src/trackerd/tracker-indexer.h:

	Moving some code around

2008-06-22  Ivan Frade  <ivan.frade@nokia.com>

	* tests/trackerd/example.index: Small QDBM index to use in tests.

	* tests/trackerd/run-tests.sh (removed)
	* configure.ac: Create symbolic links in autoconf instead a bash
	script.

2008-07-22  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.c:
	* src/trackerd/tracker-search.c:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-utils.c:

	Wrapped all database access in the DBus implementations with two
	convenient functions.

2008-07-22  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/Makefile.am
	* src/libtracker-common/tracker-index-item.[ch]:
	Common struct to write and read in the index.

	* src/trackerd/tracker-query-tree.c
	* tests/tracker-indexer/tracker-index-test.c: Updated to use the
	new index-item struct.

	* src/libtracker-db/tracker-db-manager.[ch]:
	(tracker_db_manager_are_db_too_big): Moved code here. It looks
	like nobody uses this function.

	* src/trackerd/Makefile.am
	* src/trackerd/tracker-index-manager.[ch]:
	New module to handle indexes and their directories.

	* src/trackerd/tracker-indexer.[ch]
	Refactored GObject representing one index.

	* src/trackerd/tracker-main.c: added _init and _shutdown to the
	new index manager.

	* tests/trackerd/Makefile.am
	* tests/trackerd/run-tests.sh: Script to compile the test for
	trackerd modules. Ugly but the only fast and easy solution.
	* tests/trackerd/tracker-indexer-test.c: Test for the new object

2008-07-22  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/tracker-indexer/tracker-indexer.c: Fixed HAL warning when it
	isn't compiled in. Fixed the indexer pausing so it works properly
	and has proper debugging so we know when it is called like all
	other DBus functions.

	* src/trackerd/tracker-daemon.c: Connected the "Paused" and
	"Continued" signals of the indexer so we know when to signal it
	up the stack.

	* src/trackerd/tracker-dbus.c: Add the prototypes for "Paused" and
	"Continued" for the indexer proxy.

	* src/trackerd/tracker-main.c: Removed some debugging which was
	duplicated when we changed state between paused/resumed.

2008-07-22  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.c:
	* src/libtracker-common/tracker-ontology.c:

	Fixed two major problems with r1898

2008-07-22  Philip Van Hoof  <philip@codeminded.be>

	* data/sqlite-stored-procs.sql:
	* data/sqlite-cache.sql:
	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-indexer/tracker-indexer-db.h:
	* src/tracker-indexer/tracker-indexer.c:

	Removed the need for GetNewID and UpdateNewID from the indexer
	Replaced the GetNewEventID and UpdateNewEventID with an autoincrement

2008-07-22  Carlos Garnacho  <carlos@imendio.com>

	Improve data flushing to DBs/Indexes, based on a patch by Ivan Frade

	* src/tracker-indexer/tracker-index.c (tracker_index_free): Just flush
	if there are remaining items before the index is destroyed.
	* src/tracker-indexer/tracker-indexer.c (schedule_flush_cb): Renamed
	to flush_data(). Always flush the Index, which is completely unrelated
	to DB transactions.
	(schedule_flush): Call flush_data() if needed immediately
	* src/tracker-indexer/tracker-main.c (indexer_finished_cb): Attach the
	extra refcount to indexer to the timeout. So it's unreferenced when
	the timeout source is removed.

2008-07-22  Carlos Garnacho  <carlos@imendio.com>

	Several random fixes by Philip Van Hoof.

	* src/libtracker-db/tracker-db-dbus.c
	(tracker_dbus_query_result_to_hash_table): tabify.
	* src/libtracker-db/tracker-db-manager.c: Initialize correctly the
	TrackerDBDefinition structure
	* tests/libtracker-common/tracker-file-utils-test.c
	(test_path_list_filter_duplicates): Avoid compiler warning.

2008-07-22  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-processor.c: (item_queue_handlers_cb),
	(crawler_finished_cb): Make it clear which module we are sending
	items for and also fixed the cut and paste bug I introduced which
	was using the _files_delete() API for new and updated files. Plus
	now we have some main context iteration code in the tight loop
	where we get back all files from the crawler. Being unresponsive
	for 10 seconds while the processor adds 100k items into a queue
	and create strings for each of them is not acceptable.

2008-07-22  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.[ch]:
	* src/trackerd/tracker-processor.c: (process_module): Make it
	possible to disable modules from the user's config, not just in
	the module files which are owned by root. Added config option
	"disabled-modules".

2008-07-21  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/modules/files.c:
	* src/tracker-indexer/modules/evolution.c:
	* src/tracker-indexer/modules/applications.c:
	* src/tracker-indexer/tracker-indexer.c:

	tracker-indexer modules returned a GHashTable with field name/value
	pairs, we now use TrackerField pointers for the hashtable keys, so we
	could deal with values in their native format (instead of having to
	convert everything to strings)

2008-07-21  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.[ch]:
	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-processor.c: Completely rework the crawler,
	so we have ONE per module. It also now will crawl non-recursive
	directories set in the .module files. All non-recursive
	directories are crawled first. This also moves the "sending" of
	items to the indexer into the processor module so it is in ONE
	place not TWO.

2008-07-21  Philip Van Hoof  <philip@codeminded.be>

	* Reverted TrackerField instances as hash keys patch

2008-07-21  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-monitor.[ch]:
	* src/trackerd/tracker-processor.c: Make tracker-monitor a GObject
	with signalling when there are items created/updated/deleted and
	move all the code which sends file notifications to the indexer
	into the processor.

2008-07-21  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Functions for attached
	connections

2008-07-18  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.[ch]:
	* src/libtracker-common/tracker-module-config.c: Added functions
	to remove duplicates or hierarchical conflicts between monitor
	directories and monitor recurse directories.

	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-crawler.c: Emit a signal for each directory
	we process so the processor can add monitors. The bug where we
	don't monitor or crawl the toplevel directory/files for each
	module is fixed now. We now only send files to the indexer AFTER
	we have crawled the file system. This time is insignificant, for
	100k files it takes ~10 seconds.

	Emitting a signal for each directory is not really the best way
	forward here, since the directories we crawl are the directories
	which are "recursive monitor directories". What we should do is
	set flags on the crawler before we start it so we know if we are
	crawling to set up monitors or to get files. We should also return
	the files to the processor to send to the indexer, instead of
	doing all that in this module too. This needs more work.

	* src/trackerd/tracker-processor.c: Removed add_recurse_monitors()
	and add_monitors(), they are not needed. Added the code to handle
	adding monitors from the process-directory callback in the crawler.

2008-07-18  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-search.c: Fixed assertions that are not
	necessary (and even wrong).

2008-07-18  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-manager.c:
	Commented out the code to load xesam categories in
	tracker_ontology. It overwrittes the real categories because the
	IDs are not unique.

	* src/tracker-indexer/tracker-indexer.c
	Obtain the mimetype and service type from the file, instead from
	the module name.

2008-07-18  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-indexer.h:
	* data/dbus/tracker-indexer.xml:

	Added a SetPaused DBus API to the indexer

2008-07-17  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-ontology.[ch]:
	(tracker_ontology_registered_service_types)
	(tracker_ontology_registered_field_types): new functions to obtain
	services and field type names registered in the ontology.

	* src/trackerd/tracker-metadata.c:
	(tracker_metadata_get_registered_types)
	(tracker_metadata_get_registered_classes): Use the new functions
	instead accessing to the DB.

	* tests/libtracker-common/tracker-ontology-test.c: Tests for the
	new methods.

2008-07-17  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-processor.c:
	* src/trackerd/tracker-main.c: Initialize module config before
	initializing the monitor module. The monitor module uses the
	module config to set up queues and hash tables.

	* src/trackerd/tracker-monitor.[ch]: Make all API calls require a
	module name. This is because now we have separate queues for each
	module and 3 queues for each type of event (created, updated,
	deleted). This means we now don't just send "Files" as the service
	type when telling the indexer about monitor events.

2008-07-17  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-search.c:
	* data/dbus/tracker-search.xml:

	Async search API.

2008-07-17  Ivan Frade  <ivan.frade@nokia.com>

	* data/dbus/tracker-files.xml
	* src/trackerd/tracker-files.[ch]:

	Async files API.

2008-07-17  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.[ch]: Cleaned up the code here
	a bit and only open the file descriptor on init and close on
	shutdown, instead of once per write. This should fix the error we
	get when we can't open the file because too many files are already
	open. It should also be marginally quicker. If we can't open the
	file, we print everything to stderr too now.

2008-07-17  Ivan Frade  <ivan.frade@nokia.com>

	* data/dbus/tracker-metadata.xml
	* src/trackerd/tracker-metadata.[ch]:
	Async metadata API.

2008-07-17  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Add the functions for the
	combine-attached db connections

2008-07-16  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-field.[ch]:
	(tracker_field_type_as_string): Added method to translate field types
	in readable format.

	* data/sqlite-stored-procs.sql: Removed SelectMetadataClasses and
	added SelectRegisteredClasses.

	* src/trackerd/tracker-db.c:
	(tracker_db_service_get_by_entity): Reimplemented using an easier
	DB query and tracker_ontology to translate the result to string.
	(tracker_db_metadata_set_single): Added NULL at the end of the
	array.
	Renamed service -> service_type and id -> service_id

	* src/trackerd/tracker-metadata.c:
	(tracker_metadata_get_type_details): Implemented using
	tracker_ontology instead accessing to the DB.
	Fixed things here and there. Now the metadata API actually works.

2008-07-16  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-utils.[ch]: Make it possible to
	have a shortened version of the time string.

	* src/libtracker-db/tracker-db-manager.c: When setting up multiple
	interfaces, don't assume we ALWAYS want to "add_functions",
	instead use the array value for that database type (as we do
	normally).

	* src/tracker-indexer/tracker-indexer.c: Don't print a status
	message if there are 0 items remaining and change the transaction
	limit to 200.

	* src/trackerd/tracker-dbus.c: Added signal prototypes for the
	indexer for module-started, module-finished and started signals.

	* src/trackerd/tracker-processor.c: Use nicer debugging and
	include the time elapsed now in the status update.

	* src/trackerd/tracker-xesam-manager.c: Disable live search event
	updates during indexing. This causes havoc with the cache. The
	cache is already being written to by the indexer so the daemon
	becomes completely unresponsive. This is Enabled after indexing is
	finished.

2008-07-16  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml: Add argument information about signals.

	* src/libtracker-common/tracker-utils.[ch]: Change the time
	estimation function and added a function to convert seconds into a
	readable string format.

	* src/tracker-indexer/tracker-indexer-module.[ch]:
	* src/tracker-indexer/tracker-module.h: Added module_name to the
	PathInfo->file type. This isn't so great, it means a lot of string
	duplication. For now this is probably best, but ultimately we
	should have separate queues in indexer like we do in the daemon so
	we know by queue which module_name we are processing and we can do
	them in the order they are sorted by (which is unsorted right now
	but a potential future design).

	* src/tracker-indexer/tracker-indexer.[ch]:
	* src/tracker-indexer/tracker-main.c: Changed the flush time
	to 5 seconds from 10 and the transaction limit to 100 from 50.
	Also make sure we reset the timer when restarting an index so the
	estimated time is correct. Added elapsed time to the "Finished"
	and "Status" signals. Plus the current module name is in the
	"Status" signal too.


	* src/trackerd/tracker-dbus.c: Add signal signatures for the
	indexer proxy and remove som unused code.

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-xesam-manager.[ch]: Don't initialize the
	indexer signal set up for XESAM here, do it in
	tracker-xesam-manager's init function. Also, only disconnect the
	signal on shutdown and make sure that is done BEFORE we shutdown
	the dbus module to avoid warnings.

	* src/trackerd/tracker-marshal.list: Added Indexer signal marshals.

	* src/trackerd/tracker-processor.c: Set up signal handlers to know
	when the indexer is finished and to get status updates. This way
	we can now effectively signal the daemon status as IDLE when we
	have finished indexing, not before as we did do.

2008-07-15  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-interface.c:
	(tracker_db_result_set_get): Check that the result set was
	initialized before getting results.

	* src/libtracker-db/tracker-db-dbus.c:
	(tracker_dbus_query_result_to_strv): Fixed crash when the result
	set contains a NULL result.

	* tests/libtracker-db/Makefile.am
	* tests/libtracker-db/tracker-db-dbus-test.c: Added unit test to
	tracker_dbus_query_result_to_strv.

2008-07-15  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml: Removed GetRunning and SetRunning
	since these are quite pointless because DBus spawns the process if
	it isn't running. Added signals for "status" and
	"module-started"/"module-finished" to replace "index-updated".

	* src/libtracker-common/tracker-type-utils.c: Use gsize instead of
	gint to fix some compiler warnings.

	* src/libtracker-common/tracker-utils.[ch]: Added function to
	estimate time left in the indexer based on elapsed, items done and
	items remaining.

	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-marshal-main.c:
	* src/tracker-indexer/tracker-marshal.list: Added marshalling for
	unique function signatures in signal emissions.

	* src/tracker-indexer/tracker-indexer.[ch]: Added more signals to
	know what is going on here. Also cleaned up the flusher so we do
	it either on a timeout OR maximum items reached per transaction.
	Also optimized the way we get TrackerIndexerPrivate, so the
	object->private pointer is used (this avoids casting and type
	checking internally to make things quicker).

	* src/tracker-indexer/tracker-main.c: Removed unused code in the
	indexer_initialize() and moved that code to the main() function
	since it was quite small. Implemented the "LowMemoryMode" by
	checking the config and passing the flag to the database manager
	when initializing that.

	* src/trackerd/tracker-monitor.c: Don't check if the indexer is
	running, simply do what the crawler does, which is to readd items
	to the queue if the indexer isn't running or couldn't be
	contacted.

2008-07-14  Ivan Frade  <ivan.frade@nokia.com>

	* data/dbus/tracker-keywords.xml
	* src/trackerd/tracker-keywords.c
	* src/trackerd/tracker-keywords.h: Keywords dbus interface async.

	* src/libtracker-common/tracker-dbus.c
	* src/libtracker-common/tracker-dbus.h
	* tests/libtracker-common/tracker-dbus-test.c:
	(tracker_dbus_results_ptr_array_free): new function to free
	GPtrArrays in the dbus API.

2008-07-14  Laurent Aguerreche  <laurent.aguerreche@free.fr>

	* src/trackerd/tracker-crawler.c:
	(tracker_crawler_new): Fix crawler->private->hal that was initialized
	with g_object_ref (config). Use g_object_ref (hal) instead.

2008-07-14  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-index.c:
	* src/tracker-indexer/tracker-indexer.c: Give better debugging and
	messaging information and add some detail about how long is
	estimated to be left before complete. Also, don't spam the console
	with EVERY file we process, make that a debug message. Instead
	update the console with every transaction flush.

2008-07-14  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.[ch]: Make it possible to
	remove all databases using a public API and use that when shutting
	down and reindexing (instead of removing the WHOLE directory where
	databases reside).

	* src/trackerd/tracker-crawler.c: Added a signal to know when all
	items have been sent to the indexer.

	* src/trackerd/tracker-daemon.[ch]: Use the new tracker-main API
	instead of setting tracker-> members ourselves.

	* src/trackerd/tracker-db.[ch]: Write the init and shutdown
	functions to require config, language and the file index which are
	used in a lot of db functions.

	* src/trackerd/tracker-dbus.[ch]: Use the _new() functions to
	create objects we register here and pass all the object we need
	instead of the Tracker pointer.

	* src/trackerd/tracker-main.[ch]: Completely remove the Tracker
	structure. Now we have APIs for everything that is needed
	externally and we make the rest private.

	* src/trackerd/tracker-processor.[ch]: Added state signalling so
	clients know if we are indexing, pending, etc. This needs a little
	more work so the indexer itself tells us what it is doing.

	* src/trackerd/tracker-search.[ch]: Fixed crasher where we didn't
	get the private struct from the TrackerSearch before dereferencing
	it for _get_count(). Also, removed _set_{config|language|...}
	functions which are used only when the object is created. Instead
	pass these to the _new() function. Fixed a memory leak here too,
	where we didn't unref all objects we ref when the object is
	created (in finalize).

	* src/trackerd/tracker-status.[ch]: Make it possible to signal
	state change without needing all the parameters that are sent in
	the function signature.

	* src/trackerd/tracker-utils.[ch]: Remove unused functions.

2008-07-14  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/tracker-indexer/tracker-indexer.[ch]:
	* src/tracker-indexer/tracker-main.c: Commit patch from Ivan to
	make the indexer DBus API completely asynchronous.

2008-07-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-daemon.c: (tracker_daemon_get_services),
	(tracker_daemon_get_stats): Small code clean ups.

2008-07-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-index.c
	* tests/tracker-indexer/tracker-index-test.c: Added "remove"
	functionality in the indexer including unit tests. Delete a word
	from a document means to add the word with weight = -1.

2008-07-04  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-daemon.c: Error handling for some DBus Apis

2008-07-04  Ivan Frade  <ivan.frade@nokia.com>

	* data/dbus/tracker-daemon.xml
	* src/trackerd/tracker-daemon.[ch]: Tracker daemon dbus API is now
	async.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: Don't check if the indexer is
	running first, just send files. Also, don't send the next batch
	until the last patch was sent successfully. Make sure we add files
	back onto the queue if they couldn't be sent.

2008-07-04  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-dbus.c:
	(tracker_dbus_query_result_to_hash_table): Fixed warning caused by
	uninitialized GValues.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (check_runtime_level): Fixed this
	function so it sets the daemon to readonly mode depending on
	battery use + config and if there is a reindex needed.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: (main): Make the message clearer as
	to why we are not running the crawler/indexer when in read only mode.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.h: Define TrackerHal as a void
	pointer if it is disabled and just don't use it anywhere, this is
	so function signatures can include it but it will be NULL where it
	is called. Can't think of a better way to do this really.

	* src/trackerd/tracker-crawler.[ch]:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-processor.[ch]: Create TrackerHal in main
	again and pass it around the processor and crawler to use. It is
	need in main now to detect if we are using the laptop battery or
	not to put the daemon into readonly mode.

2008-07-04  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (index_metadata_foreach):
	Avoid a crash.

2008-07-04  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c: Fix typo.

2008-07-04  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/evolution.c
	(get_account_name_from_imap_uri): Avoid potential invalid memory
	reads.
	(account_text_handler): Check that we're getting the right url tag
	contents.
	(get_imap_accounts): Avoid potential leaks.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.c: (log_output): Use
	g_strerror() and errno when we can't open the log file so we know
	why.

	* src/trackerd/tracker-main.c: Removed the throttle command line
	option, it is only used by the indexer which loads the config file
	separately. Also, plugged a leak in the check_runtime_level()
	function which checks if we are already running.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/modules/files.c: Fixed warning.

	* src/libtracker-common/tracker-config.[ch]:
	* src/tracker-indexer/tracker-main.c:
	(sanity_check_option_values): Removed config options we now no
	longer have, "OptimizationSweepCount", "Divisions",
	"BucketRatio" and  "Padding".

2008-07-04  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/modules/evolution.c: Avoid a crash in case the
	url string of a Evolution account is empty.

2008-07-04  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.c: If we can't open the log,
	add a "\n" to the error so we don't get 2 messages on the same
	line.

	* src/trackerd/tracker-crawler.c: Make sure we set module_name to
	NULL when getting the next queue with data and recheck the next
	queue in the running callback in case things have changed.

2008-07-03  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_files_check)
	(tracker_indexer_files_update) (tracker_indexer_files_delete): Return
	module name in case of error.

2008-07-03  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: Make sure we have a queue PER
	module name, this way we don't get the "module not loaded" error
	when we stop crawling one module and start another (cause we were
	freeing the priv->module_name and the queues are handled AFTER
	crawling has stopped).

2008-07-03  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-nfs-lock.c: using username instead
	of PID to the nfs lock filename.

	* src/trackerd/tracker-main.c: Updated code to handle multiple
	instances.

2008-07-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.c: Don't set the
	LowMemoryMode to True by default!

2008-07-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.[ch]: Removed
	ThreadStackSize since it is no longer used.

	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c: Improved startup option sanity
	check output so we only show daemon or indexer options, not
	everything.

2008-07-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.c: (hal_setup_batteries),
	(hal_device_property_modified_cb): Fixed some debugging.
	* src/tracker-indexer/tracker-indexer.c: (set_up_throttle): Make
	sure we set to the right the default when we come off battery only
	use.

2008-07-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.c: (hal_setup_batteries),
	(hal_device_property_modified_cb): Make sure we call
	g_object_notify() when properties change.

2008-07-03  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Added throttling support.

2008-07-03  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c:
	* src/libtracker-db/tracker-db-manager.c:
	* src/libtracker-db/tracker-db-manager.h:

	LowMemoryMode for the new generation!

2008-07-03  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-files.c: Using the indexer to implement
	deleting files from the index

2008-07-02  Ivan Frade  <ivan.frade@nokia.com>

	* src/tracker-indexer/tracker-index.c
	* tests/tracker-indexer/tracker-index-test.c: Implemented the
	addition of words to the index. Added unit tests to the new
	functionality.

2008-07-02  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c:
	* src/libtracker-common/tracker-config.[ch]: Removed the email
	client option, it is redundant now. Removed the index-modules
	since that is now going to be changed to be ignore-modules.

	* src/libtracker-common/tracker-log.c: Use gsize for log size and
	remove perror, instead use g_fprintf(stderr, ...) when we get an
	error so we don't recurse.

	* src/trackerd/tracker-crawler.c: Only add monitors when we
	process directories, so they are added breadth ways not depth
	ways. Also, make the debugging ALWAYS available, this changes with
	the -v option or the config setting.

	* src/trackerd/tracker-monitor.c: Don't add any monitors if it is
	disabled in the config. Also, make the debugging ALWAYS available.

2008-07-02  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-main.c
	* src/trackerd/tracker-main.c
	* src/libtracker-db/tracker-db-manager.c
	* src/libtracker-db/tracker-db-manager.h
	* tests/libtracker-db/tracker-db-manager-test-attach.c
	* tests/libtracker-db/union-performance.c
	* tests/libtracker-db/tracker-db-manager-test-unattach.c
	* tests/libtracker-db/tracker-db-manager-test-custom.c

	Removing the dir in the temp dir must always happen at startup, never
	at shutdown

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c (tracker_metadata_get_embedded):
	* src/tracker-indexer/modules/evolution.c (get_imap_accounts): Plug
	some leaks.

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-module.h: Remove get_directories() and
	get_ignore_directories() from modules API. The data specified in the
	.module file will be used.
	* src/tracker-indexer/tracker-indexer-module.[ch]: Remove internal
	API for these as well.
	* src/tracker-indexer/applications.c:
	* src/tracker-indexer/dummy.c:
	* src/tracker-indexer/evolution.c:
	* src/tracker-indexer/files.c:
	* src/tracker-indexer/gaim-conversations.c: Remove the corresponding
	functions in modules.

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Remove at the moment the code
	to ignore directories. I must be replaced with TrackerModuleConfig and
	would be used only if --process-all is specified.

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* data/modules/evolution.module: Add local and IMAP storage
	directories.

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-module.h: Add tracker_module_init() and
	tracker_module_shutdown() to modules API. This is needed since we now
	don't have an entry point that will be called just once, as happened
	with tracker_module_get_directories().
	* src/tracker-indexer/tracker-indexer-module.[ch]: Updated.
	* src/tracker-indexer/tracker-indexer.c (close_module)
	(tracker_indexer_init): Ensure the initialization/shutdown methods are
	called for the modules.
	* src/tracker-indexer/modules/evolution.c: Use these functions to
	manage persistent data.

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-module-config.c
	(module_config_load_file):
	* src/libtracker-common/tracker-ontology.c
	(tracker_ontology_shutdown):
	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_finalize):
	Plug some leaks.

2008-07-02  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-main.c: Get TrackerModuleConfig to get
	available modules, directories to scan, etc...

2008-07-02  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.[ch]:
	* src/libtracker-db/tracker-db-dbus.c:
	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-monitor.c:
	* tests/libtracker-common/tracker-dbus-test.c: Use a GQueue
	instead of a GAsyncQueue. We don't have any threads so there is no
	need for the extra locking overhead.

2008-07-02  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-db.h:
	* src/libtracker-db/tracker-db-manager.c:
	* src/libtracker-db/tracker-db-manager.h:

	Commented out code that is simply never called

2008-07-02  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (crawler_finalize): Don't use
	g_free() to free a GFile. This is a hangover from when the files
	and directories queues had strings in them, now they have GFiles.

2008-07-02  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-db.c:

	Various database connection usage improvements

	* src/libtracker-common/tracker-log.c:

	Added a perror() to find out about a race condition while writing to
	the log file

2008-07-02  Ivan Frade  <ivan.frade@nokia.com>

	* tests/Makefile.am
	* tests/tracker-indexer/Makefile.am
	* tests/tracker-indexer/tracker-index-test.c: Added tests to
	tracker-index.

2008-07-02  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-module-config.c:
	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-monitor.c: Plugged leaks which took the
	memory lost from 1.8Mb (33,498 blocks) to 36 bytes (1 block). Good
	old valgrind!

2008-07-02  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (tracker_crawler_start):
	Actually set the path before checking if it exists or not, eek.

2008-07-02  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Memory leak fix

2008-07-02  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-search.c:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/libtracker-db/tracker-db-manager.h:

	Replaced a few strings with defines

2008-07-02  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-indexer/tracker-indexer-db.h:
	* src/tracker-indexer/tracker-indexer.c:

	Transactions per TRANSACTION_MAX items
	One possible cause for the constraint errors fixed

2008-07-01  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.h:
	* src/trackerd/tracker-search.c:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/trackerd/tracker-db.h:
	* src/libtracker-db/tracker-db-manager.c:
	* src/libtracker-db/tracker-db-manager.h:
	* src/libtracker-common/tracker-service.h:
	* src/libtracker-common/tracker-ontology.c:
	* tests/libtracker-db/tracker-db-manager-test-attach.c:
	* data/sqlite-stored-procs.sql:


	Removes attach_iface and attach_all as this was broken by design

	Adds "Xesam" as possible service for get_db_interface_by_service

	Removes tracker_db_manager_get_db_interface_by_service's content
	boolean since ALL users of it require the content db attached

	Makes tracker_db_manager_get_db_interface always return just a
	connection to just the requested file. Making it ideal for the indexer

	Makes the Xesam code always use get_db_interface_by_service

	Makes some of the tracker_db_manager_get_db_interface users that
	expected an attached connection use get_db_interface_by_service
	instead

	Makes some of the tracker_db_manager_get_db_interface users request
	the right db file. Some of these requested FILE_META while the tables
	that they influence or request from reside in common.

	Prepares for preferred use of get_db_interface_by_service over
	tracker_db_manager_get_db_interface

	Commit reviewed and approved by Ivan Frade

2008-07-01  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.[ch]: Added a function to
	convert n GQueue GFile items to a gchar**.

	* src/tracker-indexer/tracker-indexer.[ch]: Include the number of
	items that were indexed in the finished signal.

	* src/tracker-indexer/tracker-main.c: Don't quit immediately, wait
	10 seconds or so, otherwise if the daemon calls "are we running"
	it replies and quits before the daemon can send the next message.

	* src/trackerd/tracker-crawler.c: Added back the code to handle
	sending files to the indexer.

	* src/trackerd/tracker-processor.c: Removed commented out code.

2008-07-01  Carlos Garnacho  <carlos@imendio.com>

	Generate email:// uris for IMAP in the Evolution module.

	* src/libtracker-common/tracker-utils.[ch] (tracker_string_remove):
	New function, removes a substring from a string in place.
	* configure.ac:
	* src/tracker-indexer/modules/Makefile.am: Add optional dependency on
	GConf, compile the Evolution module if it's available.
	* src/tracker-indexer/modules/evolution.c: Parse and find out correct
	email:// uri for IMAP messages from the /apps/evolution/mail/accounts
	GConf key.

2008-07-01  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-module-config.[ch]: Added
	index_file_patterns to the API and generate the patterns for the
	crawler to use for pattern matching files to index.

	* src/trackerd/tracker-crawler.c: Make sure we check the
	file_index_patterns now. Improve statistics.

	* src/trackerd/tracker-marshal.list: Added to extend finished
	signal to include some statistics.

	* src/trackerd/tracker-processor.c: Make use of the enable/disable
	flag in the module config.

2008-07-01  Ivan Frade  <ivan.frade@nokia.com>

	* tests/common/tracker-test-helpers.[ch]
	* tests/libtracker-common/tracker-dbus-test.c:
	(tracker_test_helpers_get_nonutf8) Moved to common helper
	functions.

	* tests/libtracker-common/non-utf8.txt: Updated test string to
	look like a file.

	* tests/libtracker-common/Makefile.am
	* tests/libtracker-common/tracker-file-utils-test.c: Test for
	(tracker_path_list_filter_duplicates) and
	(tracker_path_evaluate_name)


2008-07-01  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (crawler_finalize):
	* src/trackerd/tracker-main.c: (main): Fixed some shutdown
	warnings and turned off the debugging in the crawler.

2008-07-01  Martyn Russell  <martyn@imendio.com>

	* data/modules/files.module: Added $HOME to the list of recursive
	monitored directorys.

	* src/libtracker-common/tracker-file-utils.c: Add comment to the
	source so we know if memory is created or if a new list is the
	only thing that is created from the
	tracker_path_list_filter_duplicates() function.

	* src/libtracker-common/tracker-module-config.[ch]: Push all paths
	returned from config into a hash table not a list, this way we can
	have APIs to look up strings more quickly. Also added APIs to get
	directory and file ignore patterns (these patterns are created by
	the module config now).

	* src/trackerd/tracker-crawler.[ch]: Make the crawler crawl ALL
	locations according to the module configuration details. The
	ignore patterns for files and directories are now retrieved from
	this config too. Also, stole the code from the indexer to handle
	directory crawling breadth wise instead of depthwise. This means
	all the top level files are monitored and indexed first since they
	are usually the most important.

	* src/trackerd/tracker-processor.c: Added code to iterate all
	modules and crawl each of them in turn. More work is needed here
	to do other things like setting up monitors. This shouldn't be
	done in the crawler on EVERY directory as it currently is.

2008-06-30  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process.c:
	* src/trackerd/tracker-process.h:
	* src/trackerd/tracker-processor.c:
	* src/trackerd/tracker-utils.c: Renamed tracker-process to
	tracker-processor

2008-06-30  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-module-config.c (module_config_load):
	Do not call g_file_info_get_name() twice.

2008-06-30  Carlos Garnacho  <carlos@imendio.com>

	Change tracker-indexer DBus methods, now they also take a string for
	the module name to use when indexing a path.

	* data/dbus/tracker-indexer.xml: Add new argument to functions.
	* src/tracker-indexer/tracker-indexer.[ch]
	(tracker_indexer_files_check) (tracker_indexer_files_update)
	(tracker_indexer_files_delete): Lookup the passed module name instead
	of just assuming the "files" module.
	* /src/trackerd/tracker-crawler.c (indexer_get_running_cb):
	* /src/trackerd/tracker-monitor.c (indexer_get_running_cb): Update
	callers, at the moment it just assumes the "files" module.

2008-06-30  Carlos Garnacho  <carlos@imendio.com>

	Make tracker-indexer just process petitions through DBus by default,
	add a --process-all parameter to allow standalone testing.

	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_process_all):
	Added, queues all known modules in the modules list, so all data is
	processed.
	* src/tracker-indexer/tracker-main.c: Add a --process-all commandline
	argument, which triggers all modules processing without need of
	DBus petitions.

2008-06-30  Martyn Russell  <martyn@imendio.com>

	* data/modules/applications.module: Changed the location to
	$prefix/share/applications for now, it was just $prefix/share,
	there are too many files there and we need the appropriate ignore
	patterns in place before we can really do this.

	* src/trackerd/tracker-main.[ch]: Removed the HAL and Crawler from
	the Tracker struct. Now they are created and stored in the
	TrackerProcessor object.

	* src/trackerd/tracker-process.[ch]: Added the initial workings
	from the indexer code which Carlos wrote and copied over to the
	daemon to start iterating all locations according to the module
	config.

2008-06-27  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-common/tracker-type-utils.c:
	(string_to_date): Using GDate instead of time_t to compare the
	result without timezone.

2008-06-27  Ivan Frade  <ivan.frade@nokia.com>

	* tests/**: Added license in .c/.h files.

2008-06-27  Philip Van Hoof  <philip@codeminded.be>

	* svn merge -r 1769:1798 ../xesam-support

2008-06-27  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.c
	(tracker_db_create_service): Allow modules to specify a custom dirname
	and basename for the service.
	* src/tracker-indexer/modules/evolution.c: And use it for local mail.
	IMAP has yet to come.

2008-06-27  Ivan Frade  <ivan.frade@nokia.com>

	* test/libtracker-common/tracker-type-utils-test.c:
	(test_date_to_string): now it doesnt depend on the timezone of the
	tester.

2008-06-27  Philip Van Hoof  <philip@codeminded.be>

	* tests/libtracker-db/union-performance.c: Added a performance test
	for a UNION query structure vs. views that me and ottela want to
	start using for certain Xesam related queries

2008-06-27  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-query.c:
	* src/trackerd/tracker-rdf-query.c:

	Incorrect queries (user input) should never crash the service
	(critical assertions)

2008-06-27  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-module-config.[ch]: Add API to get
	all modules. Fixed the module naming now we don't use the .xml
	extension.

	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process.[ch]: Start by setting up monitors
	and recursive monitors. The recursive monitors are still not
	finished, this requires some work.

2008-06-27  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.[ch]:
	* src/libtracker-common/tracker-config.c:
	* src/libtracker-common/tracker-module-config.c: Added
	tracker_path_evaluate_name() to convert $HOME and "~/foo" into
	real paths. This is now used by the module config and the main
	config module when loading directory strings or string lists.

2008-06-27  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/Makefile.am: Fixed a LIBS in an INCLUDES

	* tests/libtracker-db/tracker-db-manager-test-attach.c: Fixed the
	tests, the reinit tests made a few incorrect assumptions. Hence why
	they failed. I just removed them for now.

2008-06-26  Carlos Garnacho  <carlos@imendio.com>

	* data/modules/Makefile.am:
	* data/modules/*.xml: rename to *.module.
	* data/modules/evolution.module: Added.

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* data/modules/applications.xml:
	* data/modules/files.xml:
	* data/modules/gaim-conversations.xml: Use "true" not "True",
	breaks the GKeyFile.

	* src/libtracker-common/tracker-module-config.c: Don't set the
	modules to NULL and set GError to NULL before using it.

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-module-config.c: Make sure we set
	the separator as the right thing when building the path here.

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* data/Makefile.am:
	* data/modules/Makefile.am:
	* data/modules/applications.xml:
	* data/modules/files.xml:
	* data/modules/gaim-conversations.xml: Added these module files
	which should get read on startup.

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-module-config.[ch]: Added this
	module to load the .xml files which get installed into
	$prefix/share/tracker.

	* src/libtracker-common/tracker-type-utils.[ch]: Added
	tracker_gslist_to_string_list().

	* src/trackerd/tracker-crawler.[ch]:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process.[ch]: Use the new module config
	code when initialising the process module.

2008-06-26  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-db/run-test-in-tmp-dir.sh
	* tests/libtracker-db/tracker-db-manager-test-attach.c:
	Added more tests.

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process.c:
	* src/trackerd/tracker-process.h: Remove all functions in
	tracker-process and clean up any place that depends on functions
	from there currently.

2008-06-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-query-tree.c: Replaced a g_value_get_pointer
	with a g_value_get_object. It seems that the indexer instance is
	nowadays a GObject rather than a arbritary pointer.

2008-06-26  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Giving out correct ifaces
	with correct attachments for service-specific database connections

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-indexer.[ch]:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-monitor.c:
	* src/trackerd/tracker-query-tree.[ch]:
	* src/trackerd/tracker-search.[ch]: Refactored the TrackerIndexer
	code and API so we now use GObject and do proper type checking in
	the query tree code. The indexer API has been cut down to cater
	JUST the daemons needs here. All the indexing code is in the
	indexer instead now.

2008-06-26  Philip Van Hoof  <philip@codeminded.be>

	* svn merge -r 1726:1769 ../xesam-support

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-email.h:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-plugin.h:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-email-utils.h:
	* src/trackerd/tracker-email.c:
	* src/trackerd/tracker-email.h:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process.c: Remove all email modules here,
	this code is all done in the indexer now or is in the process of
	being moved over. It is redundant in the daemon.

2008-06-26  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-indexer.c: Cleaned up some code.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-process-files.h:
	* src/trackerd/tracker-process.c:
	* src/trackerd/tracker-utils.c: Renamed tracker-process-files.[ch]
	to tracker-process.[ch] since this module will be stripped and
	used to process all categories of data not just files.

2008-06-25  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-db/Makefile.am
	* tests/libtracker-db/tracker-db-manager-common.c
	* tests/libtracker-db/tracker-db-manager-common.h
	* tests/libtracker-db/tracker-db-manager-test-custom.c:
	Added test creating "custom attach" connections

2008-06-25  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/Makefile.am: Do not put libs in
	INCLUDES.

2008-06-25  Michael Biebl  <mbiebl@gmail.com>

	* filters/application/vnd.*: Use odt2txt instead of o3totxt. o3read
	has been deprecated and superseded by odt2txt. See also
	http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=477311
	* README: Add odt2txt to the list of recommended dpendencies.

	* configure.ac
	* src/Makefile.am
	* src/text-filters/*:
	Remove inlined sources of o3totxt. They are no longer used.

2008-06-24  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/modules/Makefile.am: Use "Tracker" as the
	domain (not NULL) for modules.

2008-06-24  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.c: (log_output),
	(tracker_log_handler), (tracker_log_init): Actually make sure we
	log to disk, we were just printing to screen.

	* src/tracker-indexer/Makefile.am: Change the domain for the
	indexer to just "Tracker", the libraries are this too, makes sense
	to stay consistent.

2008-06-24  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-db/Makefile.am
	* tests/libtracker-db/run-test-in-tmp-dir.sh
	* tests/libtracker-db/tracker-db-manager-common.c
	* tests/libtracker-db/tracker-db-manager-common.h: Common
	functions to -attach and -unattach tests

	* tests/libtracker-db/tracker-db-manager-test-unattach.c: new
	test to tracker_db_manager with no attach_all

	* tests/libtracker-db/tracker-db-manager-test.c: renamed to -attach.c
	* tests/libtracker-db/tracker-db-manager-test-attach.c:

2008-06-24  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/dummy.c: Update API, also add more
	thorough comments about what should be going on in each method.

2008-06-24  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/Makefile.am:
	* src/tracker-indexer/modules/evolution.c: Module for Evolution,
	initially it supports local and IMAP mailboxes. It's still missing
	message body and attachments retrieval.

2008-06-24  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.c
	(tracker_indexer_module_file_iter_contents): return FALSE if
	file->data is NULL, since there is no possibility the module
	implements this function for such a file, since it has to keep state
	internally.

2008-06-24  Carlos Garnacho  <carlos@imendio.com>

	Extend/Change indexer modules API. From now on, modules will deal with
	TrackerFile structs instead of paths. This struct, besides the path,
	contains a pointer to private data that modules can attach/free
	through tracker_module_file_get_data() and
	tracker_module_file_free_data().

	In order to deal with files that are potential containers for sets of
	metadata, tracker_module_file_iter_contents() has been added, for
	modules that implement this call, tracker-indexer will be able to
	collect data through tracker_module_file_get_metadata(). If
	iter_contents() returns FALSE, the indexer assumes no more data is
	left in the file, moving on to the next one.

	* src/tracker-indexer/tracker-module.h: New header, modules must
	conform to the API described in it.

	* src/tracker-indexer/tracker-indexer-module.[ch]: Use definitions
	from tracker-module.h
	(tracker_indexer_module_file_new) (tracker_indexer_module_file_free):
	New functions to create/free TrackerFile structs.
	(tracker_indexer_module_file_iter_contents): New function to iterate
	through a file contents, the meaning of this will depend on the module
	implementation.

	* src/tracker-indexer/tracker-indexer.c: Deal with TrackerFile
	structs.
	(process_file): Iterate through file contents, once the file doesn't
	have more elements to process, the file will be removed from the
	queue.

	* src/tracker-indexer/modules/applications.c:
	* src/tracker-indexer/modules/files.c: Adapt to the new API.

2008-06-24  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer.c:
	* src/libtracker-db/tracker-db-manager.c:
	* src/libtracker-db/tracker-db-manager.h:

	First piece of the puzzle for transactions in the indexer

2008-06-24  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-config.c:
	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/modules/Makefile.am: Monitor config file for
	changes and reload if it does.

2008-06-24  Ivan Frade  <ivan.frade@nokia.com>

	* tests/common/Makefile.am
	* tests/scripts/Makefile.am
	* tests/trackerd/xesam/Makefile.am: Including Makefile.decl to
	allow "make test" to run smoothly.

	* tests/Makefile.am
	* tests/libtracker-db/Makefile.am
	* tests/libtracker-db/run-test-in-tmp-dir.sh
	* tests/libtracker-db/tracker-db-manager-test.c: Initial
	tracker_db_manager test files.

2008-06-24  Martyn Russell  <martyn@imendio.com>

	* src/libtracker/tracker.c:
	(tracker_search_metadata_by_text_async): Re-added the async DBus
	API we removed which breaks tracker being installed to /usr due to
	applications depending on this API.

2008-06-24  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-index.[ch]:
	* src/tracker-indexer/tracker-indexer.c: Added a timer and a count
	so we know when we are finished how long it took and how many
	items were indexed. Also, don't flush after every item, flush
	every 10 seconds or so.

2008-06-24  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-monitor.[ch]: Now we detect the backend
	used for monitoring and set the limits accordingly. We also now
	provide the warning (if we reach the limit) only once and make the
	number of monitors we couldn't add available by API.

2008-06-24  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/libtracker-db/tracker-db-manager.c:
	* data/sqlite-stored-procs.sql:

	Fix for a warning about table Events not existing

2008-06-24  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c:
	* src/libtracker-db/tracker-db-manager.c:
	* src/libtracker-db/tracker-db-manager.h:

	tracker_db_manager_shutdown must not remove the directory in tmp with
	cache.db in case the indexer calls it.

2008-06-24  Philip Van Hoof  <philip@codeminded.be>

	src/tracker-indexer/tracker-indexer.c: The table Events for
	tracker_db_create_event only exists in cache.db, not in common.db,
	therefore patched it to use a priv->cache instead of priv->common

2008-06-24  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Normalizing attachments (for
	example cache.db was attached twice, which gave warnings).

2008-06-23  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Fix for "database cache is
	already in use" warning (removing a hack that is no longer needed,
	this hack was put in place because before fixes that were done today
	was tracker-indexer removing cache.db after some time. The hack caused
	an unwanted warning, though)

2008-06-23  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-interface-sqlite.c: Improve error
	reporting here so we say if the query used is foobar OR if it is a
	geniune error.

	* src/libtracker-db/tracker-db-manager.c: Strip whitespace before
	trying to load queries from SQL files. Also, present a count when
	done so we know how many we loaded as a measure of testing it
	worked properly.

2008-06-23  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Also setting DB parameters
	in case of attach_all=true. Fixes load_sql_file for sqlite-services.sql
	for file-meta.db and email-meta.db (UTF8 collate function was not set)

2008-06-23  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.[ch]:
	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c: Make the force_reindex, remove
	cache and attach all settings into a flag we pass when
	initialising the database manager.

2008-06-23  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Putting a warning in case of
	problems while loading a .sql file

2008-06-23  Philip Van Hoof  <philip@codeminded.be>

	* tests/scripts/dummy_data_start.sh.in
	* tests/scripts/data/email-contents.sql
	* tests/scripts/data/file-meta.sql
	* tests/scripts/data/common.sql
	* tests/scripts/data/file-contents.sql
	* tests/scripts/data/email-meta.sql
	* tests/scripts/data/xesam.sql:

	Cleaned up the test data now that the databases are (more or less)
	initialized correctly

2008-06-20  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c:
	* data/sqlite-service-triggers.sql:
	* data/sqlite-tracker-triggers.sql:

	Using a transaction around database initializations. This speeds up
	initialization, makes it more robust (what if we get killed while
	initializing) and it seems to avoid a call for fsync() when we have
	PRAGMA synchronous = NORMAL (which we currently do have for all
	database connections).

	Point of opinion about this commit: we should utilize transactions more
	often in the code. It helps us avoid corruption and massively speeds up
	INSERTs and UPDATEs:

	http://www.sqlite.org/speed.html:

	At Executive Summary: SQLite works best if you group multiple
	operations together into a single transaction.

	* svn merge -r 1683:1726 ../xesam-support

2008-06-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.c: Default to attach_all =
	TRUE for database creation.

	* src/trackerd/tracker-main.c: Don't remove the cache directory on
	startup and shutdown, let the database manager handle that.

2008-06-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.c: Keep a reference to
	each TrackerDBInterface and set the attach_iface to be the first
	one we create and use that to attach all new interfaces we create.
	Also don't create the XESAM database unless we have an
	attach_iface because that is needed. This all works except now the
	Services and Events tables are no longer created so the indexer
	spits out warnings. If we DON'T attach_all when creating the
	databases, the Services table is created but the Events table
	still is not. This needs fixing.

2008-06-20  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/tracker-indexer/tracker-indexer.[ch]: Removed
	DatabaseReindex and DatabaseCheck, now the daemon ALWAYS makes
	sure the database is ready instead of the indexer.

	* data/sqlite-tracker.sql: Remove the ANALYZE statement after
	creating the tables, this is what was causing the hang when
	attaching ALL databases during creation.

	* src/libtracker-db/tracker-db-manager.[ch]: Reworked the way we
	initialise so we create all databases on startup and check for
	each database file too. If even one of them doesn't exist we
	recreate all databases (with the exception of the cache). We also
	don't remove directories now, just the database files when
	cleaning up.

	* src/tracker-indexer/tracker-main.c: No need to check if a
	reindex is required now and removed all reindex command line
	options.

	* src/trackerd/tracker-main.c: Don't call the indexer over dbus,
	just rely on tracker_db_manager_init() to set up the databases
	correctly and to check if they exist properly.

2008-06-19  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.c:
	* src/trackerd/tracker-main.c: Again, create the databases when
	needed on demand and don't create them when we initialise the
	database manager so the trackerd doesn't try to create the
	databases. Also, make sure we create the directories we need for
	the nfs locking before we do it.

2008-06-19  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.[ch]: Clean up the API a bit,
	separate the functionality so we have an API to create the
	databases, delete the databases and close them all.

	* src/trackerd/tracker-dbus.[ch]: Removed
	tracker_dbus_indexer_start(), it is unused now.

	* src/tracker-indexer/tracker-metadata.c:
	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c: DON'T use PID, since it is shared
	between the indexer and the daemon.

	* src/trackerd/tracker-main.c: Added a call to the blocking
	version of the DBus API to check the database state from the
	indexer so we make sure the indexer ALWAYS creates the database if
	it doesn't exist in the first place. Plus if we force a reindex on
	start up, the indexer is the one that does it. Also, when creating
	the system temporary directory,

	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-monitor.c: Updated to renamed API.

	* data/dbus/tracker-indexer.xml:
	* src/tracker-indexer/tracker-indexer.[ch]: Renamed some API calls
	and also added a call to check the database state and return if it
	is the first time it will be indexed. Plus the user can force a
	reindex while checking. This is meant to be called from the daemon
	on start up to make sure the database is ready to use.

2008-06-19  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-files.xml:
	* data/dbus/tracker-keywords.xml:
	* data/dbus/tracker-metadata.xml:
	* data/dbus/tracker-search.xml: Re-added the Nautilus API we
	commented out and set all API which is to be removed as deprecated.

	* src/libtracker/tracker.c:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-files.[ch]:
	* src/trackerd/tracker-metadata.c: Readded and fixed APIs relating
	to XML file changes.

2008-06-19  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (set_up_databases): Fix typo.

2008-06-19  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (set_up_databases): Create
	databases on DB manager initialization.
	(tracker_db_manager_init): Ensure the tmp dir is created.
	(tracker_db_manager_shutdown): And removed here.
	(tracker_db_manager_get_db_interface): No need to create the database
	lazily here.

2008-06-18  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-ontology.c: Make sure we finalize
	properly by setting all lists and hash tables to NULL. Also, when
	returning a TrackerService or any other GObject from the hash
	tables, don't return it as a gpointer*, it is just a gpointer.

	* src/libtracker-db/tracker-db-interface-sqlite.c: Added some
	messaging to know when the databases are opened and closed.

	* src/libtracker-db/tracker-db-manager.c: Initialise and shutdown
	the ontology module in this module since we depend on it. We also
	shut it down and reinitialise it when we reindex the database
	because there is information we check against there when adding
	new tables to the new databases.

	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c: Don't initialise and shutdown the
	ontology module now the tracker-db-manager does it.

	* src/tracker-indexer/modules/files.c: Fixed crasher where service
	type is returned as NULL before using strcmp.

	* src/tracker-indexer/tracker-indexer.c: Added some sliff and
	sloff :)

	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-utils.c: Removed tracker_db_close()
	and tracker_db_refresh_all() they are unused or do nothing.

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/libtracker-db/tracker-db-manager.[ch]:
	* src/tracker-indexer/tracker-indexer.[ch]:
	* src/tracker-indexer/tracker-main.c: Initial work to make
	reindexing the database done ONLY by the tracker-indexer, not by
	the daemon. Needs a little more work. But command line -r works
	nicely for the indexer so far, just need the dbus part to work
	properly.

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.c: Improved the
	tracker_dbus_async_queue_to_strv() function so it doesn't crash
	when handling large numbers of files.

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-monitor.c: Turned off debugging.

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* data/dbus/tracker-indexer.xml:
	* src/libtracker-common/tracker-dbus.c:
	(tracker_dbus_async_queue_to_strv): Don't wait if there is no data
	in the async queue with g_async_queue_timed_pop().

	* src/tracker-indexer/tracker-indexer.[ch]: Added functions to be
	notified of created, deleted or updated files from the daemon.

	* src/trackerd/tracker-crawler.c: Don't block when shutting down
	by calling g_async_queue_pop() on an empty queue.

	* src/trackerd/tracker-monitor.c: Push all events to the indexer
	after queueing them first.

2008-06-17  Philip Van Hoof  <philip@codeminded.be>

	* tests/scripts/dummy_data_start.sh.in:
	* tests/scripts/xdg_dirs.source:
	* tests/scripts/xdg_dirs.unsource:
	* tests/scripts/dummy_data_stop.sh.in:
	* tests/scripts/data/email-contents.sql:
	* tests/scripts/data/file-meta.sql:
	* tests/scripts/data/common.sql:
	* tests/scripts/data/file-contents.sql:
	* tests/scripts/data/email-meta.sql:
	* tests/scripts/data/xesam.sql:
	* configure.ac:

	Added dummy test data for the unit tests

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-indexer.c:
	* src/trackerd/tracker-crawler.c:
	* src/trackerd/tracker-main.c: Use the config initial_sleep
	setting for the daemon only, not the indexer, this way we don't
	wait for the indexer to be "running".

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.c:
	* src/libtracker-common/tracker-log.c:
	* src/libtracker-common/tracker-nfs-lock.c:
	* src/libtracker/tracker-files.c:
	* src/libtracker/tracker-get-meta-for-folder.c:
	* src/libtracker/tracker-query.c:
	* src/tracker-applet/tracker-applet.c:
	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-main.c: Changed all locations to use
	"initialize" and "finalize" instead of the en_GB version for
	consistency.

2008-06-17  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (path_should_be_ignored): Do
	UTF-8 validity check here instead of later on when we have wasted
	more time processing files and folders.

2008-06-16  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-crawler.c: Bugfix, no longer freeing up
	already freed GStrv

2008-06-16  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (crawler_finalize): Make sure we
	clean up the async queue if we finalise the crawler and that means
	cleaning up the data on the queue too.

2008-06-16  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: Make all calls to GIO
	asynchronous. This has increased the speed of traversing the file
	system. Also we now only get the name and type of every file we
	traverse, this significantly improved performance. Debug
	statements are turned off now by default to improve performance.

	* src/trackerd/tracker-monitor.c: Debug statements are turned off
	now by default to improve performance.

2008-06-16  Ivan Frade  <ivan.frade@nokia.com>

	* configure.ac
	* tests/Makefile.am
	* tests/common/Makefile.am
	* tests/common/tracker-test-helpers.c
	* tests/common/tracker-test-helpers.h: New library with common
	code for all tests.

	* tests/libtracker-common/tracker-ontology-test.c
	* tests/libtracker-common/Makefile.am
	* tests/libtracker-common/tracker-type-utils-test.c: Added unit
	tests to tracker-type-utils.

	* src/libtracker-common/tracker-type-utils.c: Minor fixes to pass
	the tests.

2008-06-13  Philip Van Hoof  <philip@codeminded.be>

	* svn merge -r 1656:1683 ../xesam-support

2008-06-13  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-crawler.c: No more blocking of the mainloop

2008-06-13  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-dbus.c:
	Replaced g_warning with g_message. g_warning abort unit tests.

	* tests/libtracker-common/Makefile.am
	* tests/libtracker-common/non-utf8.txt
	* tests/libtracker-common/tracker-dbus-test.c: Unit tests to
	tracker-dbus helper methods, using non-utf8 strings.

2008-06-13  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.c:
	(tracker_dbus_slist_to_strv), (tracker_dbus_async_queue_to_strv):
	* src/libtracker-db/tracker-db-dbus.c:
	(tracker_dbus_query_result_to_strv),
	(tracker_dbus_query_result_to_hash_table),
	(tracker_dbus_query_result_to_ptr_array): Now we UTF-8 check ALL
	strings in these functions since they are sent over DBus and we
	don't want DBus calling _exit() for us if the string is invalid
	UTF-8.

2008-06-13  Philip Van Hoof  <philip@codeminded.be>

	* tests/trackerd/tracker-xesam-test.c:
	* tests/trackerd/tracker-xesam-session-test.c:
	* tests/trackerd/tracker-xesam-hit-test.c:
	* tests/trackerd/tracker-xesam-hits-test.c:
	* tests/trackerd/tracker-xesam-test.h:

	Making the Xesam unit tests work

2008-06-13  Philip Van Hoof  <philip@codeminded.be>

	* tests/trackerd/tracker-xesam-test.c
	* tests/trackerd/tracker-xesam-hit-test.c
	* tests/trackerd/Makefile.am
	* tests/trackerd/tracker-xesam-hits-test.c
	* tests/trackerd/tracker-xesam-hit-test.h
	* tests/trackerd/xesam/xesam-g-globals-private.h
	* tests/trackerd/xesam/Makefile.am
	* tests/trackerd/tracker-xesam-hits-test.h

	Ported two more tests from xesam-glib's tests repository over. These
	tests are not fully functional at the moment of writing (we need to
	make them succeed in order to support Xesam, the tests themselves are
	or should be ~ correct).

2008-06-13  Philip Van Hoof  <philip@codeminded.be>

	* tests/trackerd/tracker-xesam-test.c:
	* tests/trackerd/tracker-xesam-session-test.c:
	* tests/trackerd/Makefile.am:
	* tests/trackerd/tracker-xesam-session-test.h:
	* tests/trackerd/xesam/xesam-g-testsearcher.h:
	* tests/trackerd/xesam/xesam-g-debug-private.h:
	* tests/trackerd/xesam/xesam-g-utils.h:
	* tests/trackerd/xesam/xesam-g-test-query-builder.c:
	* tests/trackerd/xesam/gtestextensions.c:
	* tests/trackerd/xesam/Makefile.am:
	* tests/trackerd/xesam/xesam-g-test-query-builder.h:
	* tests/trackerd/xesam/gtestextensions.h:
	* tests/trackerd/xesam/xesam-g-testsearcher.c:
	* configure.ac:

	Added infrastructure and first test example (ported from xesam-glib's
	tests repository) for testing Xesam

2008-06-12  Mikael Ottela <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-main.c
	* src/trackerd/tracker-crawler.c
	* src/libtracker-db/tracker-db-manager.c
	* src/libtracker-common/tracker-xesam-field.c
	* src/libtracker-common/tracker-xesam-field.h
	* src/libtracker-common/tracker-xesam-ontology.c
	* src/libtracker-common/tracker-field.h
	* src/libtracker-common/tracker-xesam-ontology.h
	* src/libtracker-common/Makefile.am
	* data/sqlite-stored-procs.sql
	* data/sqlite-xesam.sql

	Switched xesam to use standard XesamField and XesamOntology.

	* src/trackerd/tracker-xesam-live-search.c

	Bugs in handling of list-type return values fixed.

2008-06-13  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.[ch]:
	* src/trackerd/tracker-crawler.c: Moved
	tracker_path_list_filter_duplicates() to the file utils.

	* src/trackerd/tracker-monitor.[ch]:  Use GFile instead of strings
	in the API and added work to print file changes to the console.

	* src/libtracker-common/tracker-dbus.[ch]: Added a new function to
	convert 'n' items from a GAsyncQueue to a GStrv for sending files
	to the indexer process.

	* src/trackerd/tracker-crawler.c: Use the new
	tracker_dbus_async_queue_to_strv() API to generate the GStrv
	instead of using a GPtrArray.

	* src/trackerd/tracker-monitor.c: Save the config variable on
	initialisation.

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-process-files.c: Removed all
	tracker_monitor_() calls, this shouldn't be done from here.

2008-06-12  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.[ch]: Added a new function to
	convert 'n' items from a GAsyncQueue to a GStrv for sending files
	to the indexer process.

	* src/trackerd/tracker-crawler.c: Use the new
	tracker_dbus_async_queue_to_strv() API to generate the GStrv
	instead of using a GPtrArray.

	* src/trackerd/tracker-monitor.c: Save the config variable on
	initialisation.

2008-06-12  Philip Van Hoof  <philip@codeminded.be>

	* svn merge -r 1538:1656 ../xesam-support

2008-06-12  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c
	(tracker_indexer_process_files): Queue files that get through DBus
	calls. At the moment we just assume we want the files module.

2008-06-12  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-indexer.c:
	* src/trackerd/tracker-crawler.c: Change all instances of
	g_strfreev() on dynamically allocated GPtrArrays, since they grow,
	the strings should be freed separately and the array itself after
	that, this is also better than g_strfreev() in case one or the
	other changes to a GSlice implementation.

	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-monitor.[ch]: Pass the TrackerConfig since
	we need it to know if we shouldn't monitor certain locations.

2008-06-12  Philip Van Hoof  <philip@codeminded.be>

	* svn merge -r 1538:1656 ../xesam-support

2008-06-12  Philip Van Hoof  <philip@codeminded.be>

	* tests/trackerd/tracker-xesam-test.c:
	* tests/trackerd/Makefile.am:
	* tests/Makefile.am:
	* configure.ac:

	Added unit test infrastructure for Xesam

2008-06-12  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.c: Always initialise the hash
	tables to avoid errors when we can't contact the HAL DBus service.

	* src/trackerd/linux-inotify-syscalls.h: Removed now we don't need
	it thanks to the GIO file monitoring.

	* src/trackerd/tracker-crawler.c: Get the locations to crawl from
	the config now and add a default of $HOME. Also added function to
	check that we don't crawl the same location more than once and
	added more locations to the ignore list.

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-process-files.c: Removed the need for the
	TrackerDBInterface when adding or removing monitors.

	* src/trackerd/tracker-main.c: Added back the initial_sleep
	command line argument so we can at least inspect the startup
	details and logging before the console is spammed with file
	crawling information.

	* src/trackerd/tracker-monitor.[ch]: Implemented the basics of
	file monitoring here using the new GFileMonitor API.

2008-06-12  Ivan Frade  <ivan.frade@nokia.com>

	* tests/libtracker-common/tracker-ontology-test.c:
	Added unit test to tracker-ontology

2008-06-12  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c: Actually deal with a single
	TrackerDBInterface if attach_all is TRUE.

2008-06-12  Ivan Frade  <ivan.frade@nokia.com>

	* Makefile.decl: Make rules to build unit tests. Copied from glib.
	* configure.ac: Added rules to build unit tests when the glib
	installed version supports it.

2008-06-12  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-ontology.c
	(ontology_hash_lookup_by_str) (tracker_ontology_add_service_type)
	(tracker_ontology_add_field): Use collation keys for hashtable
	lookups.

2008-06-12  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (db_get_static_data)
	(db_row_to_service): Plug a few leaks
	* src/libtracker-common/tracker-ontology.c (tracker_ontology_init):
	Set the GDestroyNotify handler for mime/metadata keys, as these
	hashtables have to take ownership of the strings passed.


2008-06-11  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c:
	* src/libtracker-common/tracker-xesam-field.c:
	*src/libtracker-common/tracker-xesam-field.h:

	List-field values in get_hit_data

2008-06-11  Mikael Ottela <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-db.c
	* src/trackerd/tracker-main.c
	* src/trackerd/Makefile.am
	* src/trackerd/tracker-xesam-live-search.c
	* src/tracker-indexer/tracker-indexer.c
	* src/tracker-indexer/tracker-indexer-db.c
	* src/tracker-indexer/tracker-indexer-db.h
	* src/libtracker-common/tracker-parser.c
	* src/libtracker-common/Makefile.am
	* src/libtracker-common/tracker-xesam-ontology.c
	* src/libtracker-common/tracker-xesam-ontology.h
	* src/libtracker-common/tracker-xesam-field.c
	* src/libtracker-common/tracker-xesam-field.h
	* src/libtracker-db/tracker-db-manager.c
	* data/sqlite-stored-procs.sql
	* data/services/xesam-metadata.mmapping

	Added framework for xesam field handling.

2008-06-11  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: (tracker_crawler_start): Changed
	jthe default location to $HOME from some testing directory of mine.

2008-06-11  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-main.c: Removed commented out code.

	* src/trackerd/tracker-crawler.c: Renamed internal functions
	better and fixed a nasty crasher because we weren't NULL
	terminating the GStrv we send to the indexer to process.

	* src/trackerd/tracker-main.c: Don't initiate and shutdown the
	process-files module, it is no longer used. Also make sure we
	shutdown properly when using Ctrl+C. Now when we initiate the db
	manager we set the attach_all to TRUE now that Carlos has fixed
	that bug. This means we use one connection for all transactions in
	the daemon now.

2008-06-11  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.c: Make sure we set the ignored
	file types each time the TrackerConfig object is set for the
	TrackerCrawler. This fixes the warning about TrackConfig not
	existing for tracker_config_get_no_index_file_types().

	* src/trackerd/tracker-main.c: Removed the initial sleep from the
	daemon, this is only meant for the indexer which implements the
	feature and this also means that we don't respond to dbus events
	in that interval.

2008-06-11  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-crawler.[ch]: Added a _stop() function and
	also iterate main context events after each file is iterated. This
	means we respond to DBus events. Fixed a nasty crash where we were
	fixing static strings added to the database when the
	TrackerCrawler was created.

	* src/trackerd/tracker-daemon.c: Changed message from "restarting" to
	"shuting down" when shutting down the daemon.

	* src/trackerd/tracker-main.[ch]: Create the crawler in the
	Tracker struct so the shutdown function can stop it immediately.


2008-06-10  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c: Preserving the sort order
	in get_hit_data

2008-06-10  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-db.c:

	Further preparations for get_hit_data, support for fields that
	contain a list-value. Added the ServiceID field to the query so
	that you can distinguish between actual items-to-return and
	records (lines) that will add a item to the list-value field

2008-06-10  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-db.c:
	* src/libtracker-db/tracker-db-manager.c:

	Fixed the ATTACH statements in tracker-db-manager.c
	Fixed an invalid assertion on fields for
	tracker_db_live_search_get_hit_data

2008-06-10  Martyn Russell  <martyn@imendio.com>

	* configure.ac: Bumped the version dependency of GLib to 2.16 for
	the new GIO API and remove the old backend code checks.

	* data/dbus/tracker-indexer.xml: Added a "ProcessFiles" API call
	and updated the "GetRunning" to return the state as a function
	parameter.

	* src/tracker-indexer/tracker-indexer.[ch]: Update all DBus
	functions to include the GError and other parameters so we return
	valid errors when functions fail.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-crawler.[ch]:
	* src/trackerd/tracker-monitor.[ch]:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-process-files.c: Added to handle directory
	monitoring and for crawling the file system. The crawler module
	now contacts the indexer and sends files it finds across DBus.

	* src/trackerd/tracker-db.c: Use tracker_monitor_() instead of
	tracker_watcher_().

	* src/trackerd/tracker-dbus.[ch]: Added a function to get the
	DBusGProxy for the indexer client connection.

	* src/trackerd/tracker-main.c: Initialise the TrackerCrawler
	object so it crawls $HOME for now for testing.

	* src/trackerd/tracker-watcher*.[ch]: Removed in favour of
	tracker-monitor.[ch].

2008-06-10  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (db_interface_get): Run
	"analyze" here, before actually attaching any database. This prevents
	sqlite from blocking when running this command after having attached a
	database.
	(db_interface_get_common) (db_interface_get_cache)
	(db_interface_get_file_metadata) (db_interface_get_file_contents)
	(db_interface_get_email_metadata) (db_interface_get_email_contents)
	(db_interface_get_xesam): Do not analyze the DB here. It's already
	done in db_interface_get().

2008-06-10  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.[ch]
	(tracker_db_set_metadata): Add argument to pass the parsed string for
	a value. Store data in the correct tables depending on the field data
	type.
	* src/tracker-indexer/tracker-indexer.c (index_metadata_foreach): pass
	the parsed value string to tracker_db_set_metadata().

2008-06-10  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-parser.c
	(tracker_parser_text_to_string): Return a stripped string.

2008-06-10  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/libtracker-gtk/tracker-metadata-tile.c:
	* src/libtracker/tracker-search.c: (main):
	* src/libtracker/tracker-tag.c: (main):
	* src/tracker-indexer/tracker-main.c: (main):
	* src/trackerd/tracker-main.c: (main):
	* src/trackerd/tracker-watcher.h: Removed the RECENT_GLIB
	definition, it was checking for GLib 2.12, when we depend on 2.14
	anyway. Also removed all places where we uses #if statements for
	RECENT GLIB.


2008-06-09  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c: get_hit_data improvements

2008-06-09  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-dbus.[ch]:
	(tracker_dbus_query_result_to_strv) Added new parameter to select
	the column.
	* src/trackerd/tracker-files.c
	* src/trackerd/tracker-keywords.c
	* src/trackerd/tracker-metadata.c
	* src/trackerd/tracker-search.c: Updated method calls
	This fixes the get_registered_metadata method.

2008-06-09  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.[ch] (tracker_db_set_text):
	New function, saves text into the content database.
	* src/tracker-indexer/tracker-indexer.c (init_indexer): create content
	database.
	(process_file): get text content and store it in the database.
	(tracker_indexer_finalize): Do not unref here the database
	connections, they're already taken care of by the DB manager.

2008-06-09  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (function_compress_string)
	(function_compress): Added, database function to compress a passed
	string using zlib.
	(db_interface_get_file_contents) (db_interface_get_email_contents):
	Create that function for these database connections.
	* data/sqlite-stored-procs.sql (SaveServiceContents): Use compress(),
	so the indexer code doesn't have to compress the contents itself.

2008-06-09  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (set_up_databases)
	(db_interface_create) (tracker_db_manager_init)
	(tracker_db_manager_shutdown) (tracker_db_manager_get_db_interface)
	(tracker_db_manager_get_db_interface_content): Allow creating
	databases lazily, instead of creating them all on initialization.

2008-06-09  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.[ch]: Removed more unused members from
	the Tracker struct.

2008-06-09  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-daemon.c:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-utils.c:
	* src/trackerd/tracker-watcher-inotify.c: Removed unused threading code.

2008-06-09  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-main.c: initialise_directories before
	tracker_db_manager_init. Removed second call to tracker_watcher-init.
	* src/trackerd/tracker-db.c: Fixed assert. Offset must be equal or
	greater than 0.

2008-06-09  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.[ch]: Removed a lot of
	public API here because it is no longer needed. Simplified the way
	we set up TrackerDBInterface objects. Improved the logging. Added
	support for attaching all databases to one connection. Fixed the
	odd bug found.

	* src/tracker-indexer/tracker-main.c: Initialise the database
	manager without attaching all databases.

	* src/trackerd/tracker-main.c:  Initialise the database manager
	with attach_all_dbs set to FALSE for now, setting this to TRUE
	causes problems when running the daemon with --reindex.

2008-06-09  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c
	(db_manager_row_to_field_def): Plug a leak.

2008-06-09  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-utils.h:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.[ch]:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-utils.h:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-keywords.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-search.c:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-query.c:
	* src/trackerd/tracker-xesam.h: Removed tracker-db-sqlite.[ch] and
	merged it with tracker-db.[ch].

2008-06-09  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-db/tracker-db-manager.[ch]:
	* src/trackerd/tracker-daemon.[ch]:
	* src/trackerd/tracker-db-email.[ch]:
	* src/trackerd/tracker-db-sqlite.[ch]:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-plugin.h:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.[ch]:
	* src/trackerd/tracker-email.[ch]:
	* src/trackerd/tracker-files.[ch]:
	* src/trackerd/tracker-keywords.[ch]:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-metadata.[ch]:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-rdf-query.[ch]:
	* src/trackerd/tracker-search.[ch]:
	* src/trackerd/tracker-watcher-fam.c:
	* src/trackerd/tracker-watcher-inotify.c:
	* src/trackerd/tracker-watcher.h:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/trackerd/tracker-xesam-query.[ch]:
	* src/trackerd/tracker-xesam.[ch]: Changed DBConnection into
	TrackerDBInterface. This is interesting because the DBConnection
	contained ALL connections. The TrackerDBInterface doesn't, it is
	ONE connection to ONE database. This means we have to know which
	database to use to call certain database API. This is less than
	helpful to the application. This should be changed over time so
	that all DB functions don't take a TrackerDBInterface and we just
	get it automatically from the tracker-db-manager. This is the
	first stage in removing DBConnection. The attach statements and
	threadding have yet to be finished here.

2008-06-06  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c: Memory leak fixes
	* src/trackerd/tracker-xesam-live-search.c: SearchDone's delayer
	correction

2008-06-06  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-interface-sqlite.c:
	* src/trackerd/tracker-xesam-live-search.c: Some minor bugfixes. Delaying
	the SearchDone for a second (maybe we can remove this later)
	* data/sqlite-stored-procs.sql: Two syntax errors in the SQL queries

2008-06-06  Carlos Garnacho  <carlos@imendio.com>

	* data/services/*.metadata: Change DataType to match TrackerFieldType
	enum nicks.

2008-06-06  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-manager.c (load_metadata_file): Try to
	find enum value based on the nick, not the name.
	(db_manager_row_to_field_def): Set data type when creating
	TrackerField objects.

2008-06-05  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.c
	(tracker_db_create_service): Take into account directories when
	marking services as disabled.

2008-06-05  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c: Fixed a crash for searches
	that yield no results.

2008-06-05  Ivan frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-action.[ch]
	* src/trackerd/tracker-watcher-inotify.c:
	(is_delete_event) moved to tracker-db-action

2008-06-05  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-db/tracker-db-file-info.[ch]
	* src/trackerd/tracker-db.c
	* src/trackerd/tracker-process-files.[ch]
	* src/trackerd/tracker-watcher-inotify.c:
	(tracker_process_files_is_file_info_valid) moved to
	tracker-db-file-info (tracker_db_file_info_is_valid).


2008-06-05  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c (check_exclude_file): Exclude
	also *.bak files.
	(tracker_module_get_file_metadata): Insert missing things in the
	metadata table, they're strings at the moment, although there should
	be some way to deal with them as integer/times/boolean, etc...
	* src/tracker-indexer/tracker-indexer-db.c
	(tracker_db_create_service): Insert some missing data in the Services
	table.

2008-06-05  Ivan Frade <ivan.frade@nokia.com>

	* src/trackerd/tracker-email-plugin.h: Email plugin interface.

	* src/trackerd/tracker-email.c: Consistent function names. _init
	is now _start_watching_emails and _shutdown is now
	_end_watching_emails.

	* src/trackerd/tracker-email-[modest,kmail,evolution,thunderbird].c:
	Renamed method names to "implement" the plugin interface.

	* src/trackerd/tracker-main.c: Use the new
	(_start,_end)_watching_emails functions.


2008-06-04  Mikael Ottela  <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.c
	Initial xesam get_hits implementation

2008-06-04  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-manager.c: Fixed the db-names of
	certain ATTACH statements

2008-06-04  Carlos Garnacho  <carlos@imendio.com>

	* filters/application/*:
	* filters/text/*: Dump text in stdout instead of a temp file.

2008-06-04  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.[ch]
	(tracker_indexer_module_get_text): New
	function, returns the contained/extracted text for a file.
	* src/tracker-indexer/modules/files.c (tracker_module_get_file_text)
	(tracker_metadata_call_text_filter): Added, either get the text for
	text/development files, or call the external filter, which returns the
	contained text.

2008-06-04  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c (tracker_metadata_get_embedded):
	Check ontology to see whether the file could contain embedded
	metadata.
	(check_exclude_file) (tracker_module_get_file_metadata): Check whether
	the file should be excluded for any kind of data extraction.

2008-06-04  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-interface-sqlite.c
	(tracker_db_interface_sqlite_execute_procedure)
	(tracker_db_interface_sqlite_execute_procedure_len): Do not choke with
	NULL arguments, instead trust the caller on the number of arguments
	passed and allow passing NULL values to these functions.

2008-06-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-type-utils.h: Fixed glib include
	build warning.

	* src/libtracker-db/tracker-db-manager.[ch]:
	* src/tracker-indexer/tracker-indexer-db.[ch]:
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-main.c:  Added functions from
	tracker-indexer/tracker-indexer-db.c[ch] which set up databases.
	So now when we request a database type like the common database or
	the file metadata database, we return an interface and it is
	already set up if it had to be created first, etc.

	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-indexer.c: Changed the TrackerDB type names
	for metadata from "META" to "METADATA".

2008-06-03  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db-sqlite.h:
	* src/trackerd/tracker-rdf-query.c: Cleaned up some uses of
	FieldData and changed them to TrackerFieldData instead.

2008-06-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.c:
	* src/libtracker-common/tracker-os-dependant-unix.c:
	* src/libtracker-common/tracker-os-dependant-win.c:
	* src/libtracker-common/tracker-os-dependant.h:
	* src/trackerd/tracker-process-files.c: Removed
	tracker_check_uri(), it is hardly used and it is only a pointer
	check.

	* src/trackerd/tracker-db.c: Refactored the code in places.

2008-06-03  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-file-utils.h: Fixed includes so we
	don't get warnings if glib isn't already included.

	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-files.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-watcher-inotify.c: Removed a lot of
	tracker_db_() API which is only needed by the indexer.

2008-06-03  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-index-stage.[ch]:
	* src/trackerd/tracker-main.h: Removed tracker-index-stage, it is
	no longer used.

2008-06-02  Michael Biebl  <mbiebl@gmail.com>

	* src/trackerd/Makefile.am:
	* src/libtracker-common/Makefile.am: The accent stripping
	functionality using unac, is now in libtracker-common, so link
	libtracker-common against unac, not trackerd.


2008-06-02  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/trackerd/tracker-xesam-manager.h:

	Waking up the LiveSearches for not-yet refactored methods that also
	(still) insert, delete and update the database


2008-06-02  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-indexer/tracker-indexer-db.h:
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-indexer.h:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-dbus.h:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/trackerd/tracker-xesam-manager.h:
	* data/dbus/tracker-indexer.xml:

	IndexerUpdated signal emitted by the indexer-process to notify trackerd
	about changes it should act on in case LiveSearches are active that are
	influenced by said changes.

	Events table updating reinstalled after refactoring the indexing to a
	separate process removed this functionality.

2008-06-02  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-fam.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-poll.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-watch.h:
	* src/trackerd/tracker-watcher-fam.c:
	* src/trackerd/tracker-watcher-inotify.c:
	* src/trackerd/tracker-watcher-poll.c:
	* src/trackerd/tracker-watcher-win.c:
	* src/trackerd/tracker-watcher.h:
	* src/trackerd/tracker-win-fs-changes.c: Moved all watch files so
	they use the prefix tracker-watch-*. Updated the API to have a
	consistent tracker_watcher_() prefix. Refactored the FAM, inotify,
	poll and windows backends.

2008-06-02  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-field.h: Add TRACKER_TYPE_FIELD_TYPE
	define for the TrackerFieldType enum GType.
	* src/libtracker-common/tracker-ontology.c (tracker_ontology_init)
	(tracker_ontology_shutdown): Make the class for the TrackerFieldType
	enum is created during the ontology lifetime.
	* src/tracker-indexer/tracker-indexer-db.c (load_metadata_file): Moved
	from trackerd.
	(tracker_indexer_db_get_common): Load all necessary
	sql/metadata/services definitions into the common DB.

2008-06-02  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-cache.[ch]:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-utils.c: Removed tracker-cache.[ch]
	now used in the tracker-indexer code and cleaned up all places
	that call cache functions.

	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-indexer.c:

	* src/trackerd/tracker-watch.h:
	* src/trackerd/tracker-inotify.c: Refactored the code here and
	changed the API to be more consistent.

	* src/trackerd/tracker-main.[ch]: Updated the shutdown process so
	we initialize and shutdown the process-files module which will
	scan the disk for files to index. Also removed the
	tracker->shutdown member, there is no point in having that AND the
	->is_running member.

	* src/trackerd/tracker-process-files.[ch]: Removed a lot of the
	indexer functionality and just left most of the directory
	processing functions.

	* src/trackerd/tracker-utils.c: Removed the _add_io_grace()
	function now it is no longer used.

2008-06-02  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/tracker-indexer-db.c:
	* src/tracker-indexer/tracker-indexer-db.h:
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-indexer.h:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-dbus.h:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-xesam-manager.c:
	* src/trackerd/tracker-xesam-manager.h:
	* data/dbus/tracker-indexer.xml:

	IndexerUpdated signal emitted by the indexer-process to notify trackerd
	about changes it should act on in case LiveSearches are active that are
	influenced by said changes.

	Events table updating reinstalled after refactoring the indexing to a
	separate process removed this functionality.

2008-06-02  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-utils/tracker-file-utils.[ch] (tracker_dir_remove):
	Renamed to tracker_path_remove(). Use g_remove() instead of g_rmdir(),
	so it can be used too on files.
	* src/tracker-indexer/tracker-indexer.c:
	* src/trackerd/tracker-main.c: Replace all occurrences.

2008-06-02  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.c (load_sql_file): Moved from
	trackerd, executes the queries contained in a text file.
	(tracker_indexer_db_get_file_metadata): Load sql files necessary to
	create the tables/triggers if the DB file didn't exist.
	* src/tracker-indexer/tracker-indexer.c (init_indexer): Create the
	DB directory if it didn't exist or was deleted.

2008-06-02  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-index.c: (cache_flush_foreach):
	Fixed some warnings.

2008-05-30  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.[ch]
	(tracker_db_set_metadata): Added, stores metadata values into
	Service*MetaData tables.
	* src/tracker-indexer/tracker-indexer.c (index_metadata_foreach): use
	tracker_db_set_metadata() to store metadata contents.

2008-05-30  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-index.[ch]: New files. Provide methods
	to store data in the QDBM index.
	* src/tracker-indexer/Makefile.am: Added these files to build.
	* src/tracker-indexer/tracker-indexer.c: Pass all metadata contents
	through the parser and store all the results with TrackerIndex.

2008-05-30  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/Makefile.am: Do not force -g.

2008-05-30  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-parser.c
	(tracker_parser_text_into_array): reverse wrongly passed arguments to
	tracker_parser_text_to_string(). Also strip leading and trailing
	whitespaces in order not to end with "\0" strings in the array.

2008-05-30  Carlos Garnacho  <carlos@imendio.com>

	* tracker-indexer-db.[ch] (tracker_db_increment_stats)
	(tracker_db_create_service):
	* tracker-indexer.c (process_file): Pass around the TrackerService
	instead of having to look it up in the ontology several times.

2008-05-30  Philip Van Hoof  <philip@codeminded.be>

	* Merged indexer-split with xesam-support
	svn merge -r 1495:1538 ../xesam-support


2008-05-30  Philip Van Hoof  <philip@codeminded.be>

	* data/sqlite-stored-procs.sql: Fixed syntax error of a stored
	procedure (LiveSearchStopSearch)
	* src/trackerd/tracker-xesam-manager.c: Unneeded casting removed

2008-05-30  Philip Van Hoof  <philip@codeminded.be>

	* tracker-xesam-live-search.h:
	* tracker-xesam-ontology.c:
	* tracker-xesam-ontology.h:
	* tracker-xesam-query.c:
	* tracker-xesam-query.h:

	Normalizing copyright notes and original author names to the
	respective authors of the files involved in this patch (i.e.
	Ottela Mikael for xesam-query and xesam-ontology)

2008-05-29  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-xesam.c:
	* src/trackerd/tracker-dbus-xesam.h:

	Refactored tracker_dbus_xesam_emit_search_done to
	tracker_xesam_live_search_emit_done


2008-05-30  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-live-search.h:
	* src/trackerd/tracker-xesam-manager.c:

	Making it possible to pass which exact events occurred, to better
	finetune the periodic LiveSearch query in future


2008-05-29  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-xesam.c:
	* src/trackerd/tracker-dbus-xesam.h:

	Refactored tracker_dbus_xesam_emit_search_done to
	tracker_xesam_live_search_emit_done

2008-05-29  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-xesam.c:
	* src/trackerd/tracker-dbus-xesam.h:

	Refactored tracker_dbus_xesam_emit_search_done to
	tracker_xesam_live_search_emit_done

2008-05-29  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* data/Makefile.am:
	* data/dbus/Makefile.am:
	* data/org.freedesktop.Tracker.Indexer.service.in:
	* data/org.freedesktop.Tracker.service.in:
	* data/tracker-dbus-daemon.xml:
	* data/tracker-dbus-files.xml:
	* data/tracker-dbus-keywords.xml:
	* data/tracker-dbus-metadata.xml:
	* data/tracker-dbus-search.xml:
	* data/tracker-dbus-xesam.xml:
	* data/tracker-indexer.xml: Moved to data/dbus/ and the -dbus-
	prefix has been removed from the daemon xml files.

	* data/tracker.cfg: Removed, it is generated initially now.

	* src/libtracker/Makefile.am:
	* src/libtracker/tracker.c: Used the new data/dbus/*.xml files and
	removed the -dbus- name space from the included generated files.

	* src/tracker-indexer/Makefile.am:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-daemon.[ch]:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-dbus-daemon.[ch]:
	* src/trackerd/tracker-dbus-files.[ch]:
	* src/trackerd/tracker-dbus-keywords.[ch]:
	* src/trackerd/tracker-dbus-metadata.[ch]:
	* src/trackerd/tracker-dbus-search.[ch]:
	* src/trackerd/tracker-dbus-xesam.[ch]:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-status.c:
	* src/trackerd/tracker-utils.c: Renamed all tracker_dbus_ files
	and functions to tracker_ to make things simpler.

	* src/trackerd/tracker-xesam-manager.[ch]: Moved the old
	tracker-xesam.[ch] to tracker-xesam-manager.[ch].

	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-session.[ch]: Improved the code here
	as well as changed all tracker_xesam_() to tracker_xesam_manager_().

2008-05-29  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am: Don't include the HAL files
	twice, this was causing some serious headaches today.

	* src/libtracker-common/tracker-hal.h: Put the HAVE_HAL check
	after the already included check.

	* src/libtracker-db/Makefile.am: Make sure we depend on
	libtracker-common because we need some of the dbus API calls
	there.

	* src/tracker-indexer/modules/Makefile.am: Remove commented out
	libtracker-common include. Not needed.

	* src/tracker-indexer/tracker-dbus.c:
	* src/tracker-indexer/tracker-main.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.c: Some logging/debugging updates. Now
	we say where the log file is and print it to the terminal so users
	know where to look. Also state when we are done loading so the
	user knows we aren't hanging for some startup processes.

2008-05-29  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-hal.[ch]: Consistency fixes.

	* src/tracker-indexer/modules/Makefile.am: Reorder some of the
	linking so it is done in the right order. This doesn't matter on
	Linux, but it does on Windows. Linking must occur with the system
	deps last. Yes that sucks.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-dbus.[ch]:
	* src/trackerd/tracker-main.c: Added the tracker-indexer.xml file
	to the Makefile here but to produce the client side API so we can
	call _set_running() on the indexer to exec() the binary and start
	indexing when we are ready. So now we start the indexer when it is
	needed through DBus.

2008-05-29  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-dbus.[ch]
	(tracker_dbus_register_object): Added, registers to the bus an already
	created object.
	(tracker_dbus_register_object) (tracker_dbus_get_object): Removed, no
	longer necessary.
	(dbus_register_object): Modify to register an already created object.
	* src/tracker-indexer/tracker-main.c: Create the TrackerIndexer prior
	to registering it in DBus, so we can pass it construct only
	properties.

2008-05-29  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-db.[ch]: Added, These files are
	going to contain all DB related functions.
	* src/tracker-indexer/Makefile.am: Added these files to build.
	* src/tracker-indexer/tracker-main.c: Initialize DB manager and
	ontology.
	* src/tracker-indexer/tracker-indexer.c: Added initial support to data
	indexing.

2008-05-29  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-db/tracker-db-interface-sqlite.c: Make sure the
	procedures table is unreferenced when setting a new one. Also, don't
	create one during initialization.

2008-05-29  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-dbus.h:
	* src/libtracker-db/tracker-db-dbus.h:
	* src/tracker-indexer/tracker-dbus.h: Forgot to svn add these
	files for the last commit!

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* data/Makefile.am:
	* data/org.freedesktop.Tracker.Indexer.service.in:
	* data/org.freedesktop.TrackerIndexer.service.in:
	* src/tracker-indexer/tracker-indexer.h: Changed name
	TrackerIndexer to Tracker.Indexer.

	* src/tracker-indexer/Makefile.am:
	* data/tracker-indexer.xml: Add introspection support for the
	indexer.

	* src/tracker-indexer/tracker-dbus.c:
	* src/tracker-indexer/tracker-main.c: Make sure we register the
	DBus objects properly on startup.

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-dbus.c: Added this for the most
	common DBus functionality, such as creating requests and logging
	request comments, etc.

	* src/libtracker-db/Makefile.am:
	* src/libtracker-db/tracker-db-dbus.c: Added for converting
	TrackerDBResultSet information into Glib types to be transported
	over DBus.

	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-dbus.c:
	* src/tracker-indexer/tracker-indexer.h:
	* src/tracker-indexer/tracker-main.c: Added initial DBus support
	to register the tracker-indexer name on startup to start receiving
	requests from the daemon.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-dbus-daemon.[ch]:
	* src/trackerd/tracker-dbus-files.[ch]:
	* src/trackerd/tracker-dbus-keywords.[ch]:
	* src/trackerd/tracker-dbus-metadata.[ch]:
	* src/trackerd/tracker-dbus-search.[ch]:
	* src/trackerd/tracker-dbus-xesam.[ch]:
	* src/trackerd/tracker-dbus.[ch]:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-xesam-live-search.c: Cleaned up the
	includes which were overly bloated. Also improved the tracker-dbus
	API so it is obvious we initialise it first (for registering the
	name) and we register objects later. Before with init() and
	preinit() it wasn't clear why we needed that.

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* data/Makefile.am:
	* data/tracker-indexer.service.in:
	* data/trackerd.service.in: Renamed these files to the name they
	will use on the session bus (i.e. org.freedesktop.Tracker...).

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* data/Makefile.am:
	* data/tracker-indexer.service.in:
	* data/tracker.service.in: Added a service for the indexer to
	start when we try to communicate with it. This is an initial step,
	there launching the binary will not associate itself with the DBus
	name in the session just yet.

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-apps.c:
	* src/trackerd/tracker-apps.h:
	* src/trackerd/tracker-db.h:
	* src/trackerd/tracker-process-files.c: Removed the
	src/trackerd/tracker-apps.[ch] files because there is a module to
	do that now in the src/tracker-indexer code. The process-files
	module now won't try to index applications, but the process-files
	module is obsolete now anyway. All commented out code is
	marked with the comment FIXME-indexer-split.

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/main.c: Renamed to tracker-main.c

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-metadata.[ch]:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.h:
	* src/trackerd/tracker-dbus-files.c: Moved the
	tracker-metadata.[ch] to the tracker-indexer directory, this also
	is a transitional state for some of this code. Some of the code
	from tracker-db.c has been commented out with #if 0 since it is
	being moved to the indexer at some point. All of this code is
	marked with the comment FIXME-indexer-split.

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* configure.ac: Changed the IOPRIO_SUPPORT to HAVE_IOPRIO since
	thats more consistent with naming conventions.

	* src/tracker-indexer/Makefile.am:
	* src/tracker-indexer/tracker-indexer.c:
	* src/tracker-indexer/tracker-ioprio.[ch]:
	* src/trackerd/Makefile.am: Moved the tracker-ioprio.[ch] to the
	indexer directory, they are only needed there. Also, moved the
	nice() function call to the indexer, the daemon doesn't need jthat
	either.

	* src/tracker-indexer/main.c: Removed all command line options
	except verbosity and reindex, these will not be needed except for
	debugging generally. Also use the same jargon about copyright, etc
	when starting up as the daemon. Added log support, we write to the
	same place as the daemon does, except it is called
	tracker-indexer.log.

	* src/trackerd/tracker-main.c: Changed the log to trackerd.log
	from tracker.log.

2008-05-28  Martyn Russell  <martyn@imendio.com>

	* data/Makefile.am:
	* data/sqlite-service-stored-procs.sql: Removed this, it is no
	longer used.

2008-05-28  Philip Van Hoof  <philip@codeminded.be>

	 * src/trackerd/tracker-xesam-live-search.c:
	 * src/trackerd/tracker-db-sqlite.c:
	 * src/trackerd/tracker-db-sqlite.h:
	 * data/sqlite-stored-procs.sql:

	Detecting Creates, fixed the initial HitsAdded after StartSearch

2008-05-28  Philip Van Hoof  <philip@codeminded.be>

	 * src/trackerd/tracker-xesam-live-search.c:
	 * src/trackerd/tracker-db-sqlite.c:
	 * src/trackerd/tracker-db-sqlite.h:
	 * data/sqlite-stored-procs.sql:

	The initial HitsAdded after a search is activated. Updated the
	stored-proc executers to also remove and add items into the
	LiveSearches table

	New TODO item: we are only detecting the Updates and Deletes for
	the live searches, not the creates

2008-05-27  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-db/Makefile.am:
	* src/libtracker-db/tracker-db-interface.[ch]:
	* src/libtracker-db/tracker-db-manager.[ch]:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.c: Moved the tracker-db-manager.[ch]
	over to libtracker-db and improved some parts of it.

2008-05-27  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-hal.[ch]:
	* src/libtracker-common/tracker-ontology.[ch]:
	* src/libtracker-common/tracker-parser.[ch]:
	* src/libtracker-common/tracker-service.[ch]:
	* src/libtracker-common/tracker-field.[ch]:
	* src/libtracker-common/tracker-field-data.[ch]:
	* src/tracker-indexer/Makefile.am:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.[ch]:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-dbus-metadata.c:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-dbus-xesam.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-query-tree.c:
	* src/trackerd/tracker-xesam-ontology.[ch]:
	* src/trackerd/tracker-xesam-query.c: Moved tracker-hal,
	tracker-ontology, tracker-service, tracker-parser, tracker-field
	and tracker-field-data modules to libtracker-common because they
	are shared by the indexer and the daemon.

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c
	* src/trackerd/tracker-xesam-query.c
	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-dbus-xesam.h:

	Xesam behaviour fixes:
	Emit HitsAdded after StartSearch
	Emit StartDone after StartSearch is finished searching

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-query.c: Memory corruption fix in
	tracker_xesam_query_to_sql

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

        * Merged indexer-split with xesam-support
	 svn merge -r 1481:1495 ../xesam-support

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-ontology.[ch]:
	* src/tracker-indexer/tracker-service.[ch]:
	* src/tracker-indexer/tracker-field.[ch]: Copied here meanwhile we
	decide where should they go.

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.[ch]: Add "reindex" property, to
	begin indexing from scratch at startup.
	* src/tracker-indexer/main.c: connect reindex to command line option.

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus.c: On/Off configuration of Xesam

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* Fixed the Xesam DBus namespaces for Xesam r0.95

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* Fixes some bugs with xesam search structures and
	field definitions
	* Patch by Ottela Mikael <mikael.ottela@ixonos.com>

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

        * Merged indexer-split with xesam-support
	 svn merge -r 1481:1495 ../xesam-support

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-ontology.[ch]:
	* src/tracker-indexer/tracker-service.[ch]:
	* src/tracker-indexer/tracker-field.[ch]: Copied here meanwhile we
	decide where should they go.

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.[ch]: Add "reindex" property, to
	begin indexing from scratch at startup.
	* src/tracker-indexer/main.c: connect reindex to command line option.

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus.c: On/Off configuration of Xesam

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* Fixed the Xesam DBus namespaces for Xesam r0.95

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* Fixes some bugs with xesam search structures and
	field definitions
	* Patch by Ottela Mikael <mikael.ottela@ixonos.com>

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-ontology.[ch]:
	* src/tracker-indexer/tracker-service.[ch]:
	* src/tracker-indexer/tracker-field.[ch]: Copied here meanwhile we
	decide where should they go.

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.[ch]: Add "reindex" property, to
	begin indexing from scratch at startup.
	* src/tracker-indexer/main.c: connect reindex to command line option.

2008-05-26  Ottela Mikael <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-xesam-live-search.c
	* src/trackerd/tracker-xesam-ontology.c
	* src/trackerd/tracker-xesam-ontology.h
	* src/trackerd/tracker-xesam-session.c
	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-xesam.c
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-db-manager.c
	* src/trackerd/Makefile.am
	* src/trackerd/tracker-db-manager.h
	* data/services/xesam-metadata.mmapping:

	Various improvements to the database handling
	Added Xesam ontology mapping helper functions

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* Fixed the Xesam DBus namespaces for Xesam r0.95

2008-05-27  Philip Van Hoof  <philip@codeminded.be>

	* Fixes some bugs with xesam search structures and
	field definitions
	* Patch by Ottela Mikael <mikael.ottela@ixonos.com>

2008-05-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-search.c: Bugfix in
	dbus_search_highlight_terms
        * Merged xesam-support with indexer-split
	 svn merge -r 1475:1479 ../indexer-split
	 svn merge -r 1479:1481 ../indexer-split

2008-05-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-search.c: Bugfix in
	dbus_search_highlight_terms
        * Merged xesam-support with indexer-split
	 svn merge -r 1481:1487 ../indexer-split

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-ontology.[ch]:
	* src/tracker-indexer/tracker-service.[ch]:
	* src/tracker-indexer/tracker-field.[ch]: Copied here meanwhile we
	decide where should they go.

2008-05-26  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.[ch]: Add "reindex" property, to
	begin indexing from scratch at startup.
	* src/tracker-indexer/main.c: connect reindex to command line option.

2008-05-26  Ottela Mikael <mikael.ottela@ixonos.com>

	* src/trackerd/tracker-xesam-live-search.c
	* src/trackerd/tracker-xesam-ontology.c
	* src/trackerd/tracker-xesam-ontology.h
	* src/trackerd/tracker-xesam-session.c
	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-xesam.c
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-db-manager.c
	* src/trackerd/Makefile.am
	* src/trackerd/tracker-db-manager.h
	* data/services/xesam-metadata.mmapping:

	Various improvements to the database handling
	Added Xesam ontology mapping helper functions

2008-05-26  Philip Van Hoof  <philip@codeminded.be>

        * Merged xesam-support with indexer-split
	 svn merge -r 1475:1479 ../indexer-split
	 svn merge -r 1479:1481 ../indexer-split

2008-05-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-search.c: Bugfix in
	dbus_search_highlight_terms

2008-05-26  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-main.c/h: Fixed the build
	for --disable-hal
	* svn merge -r 1423:1480 ../xesam-support

2008-05-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db-sqlite.h:
	* src/trackerd/tracker-dbus-metadata.c:
	* src/trackerd/tracker-field-data.[ch]:
	* src/trackerd/tracker-field.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-xesam-query.c: Added the
	tracker-field-data.[ch] to handle all FieldData code that used to
	exist. Also fixed up some errors in the tracker-xesam-query.c
	module where is_end_operator() and is_operator() were not proper
	logic statements.

2008-05-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-field.[ch]:
	* src/trackerd/tracker-ontology.[ch]: Don't use "const" for
	TrackerField, it is unnecessary. When cleaning up the
	TrackerFieldData, there is no need to check the pointer value
	before calling g_free() either, since g_free() does this for us.

2008-05-23  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-main.h: Removed tracker->request_waiting,
	it was only ever set, not used. Moved
	tracker->black_list_timer_active, it is only used in the
	tracker-db module.

2008-05-23  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-nfs-lock.[ch]:
	* src/libtracker-db/Makefile.am:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-manager.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-hal.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-utils.c:
	* src/trackerd/tracker-xesam.[ch]: Added 2 API calls,
	tracker_get_sys_tmp_dir() and tracker_get_data_dir() for other
	modules to request when they need it. Other directory information
	is calculated when and where it is needed. All directory
	information in the tracker struct has been removed now in favour
	of this.

2008-05-21  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-parser.c (strip_word): Also, don't check for
	tracker->strip_accents, it doesn't exist anymore, and was always set
	to TRUE.

2008-05-21  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-parser.c (strip_word): use GLib API to issue
	a warning.

2008-05-20  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-main.h:
	* src/trackerd/tracker-process-files.[ch]:
	* src/trackerd/tracker-utils.c: Moved the
	tracker->file_process_queue and tracker->file_metadata_queue to
	tracker-process-files.c and wrapped the GAsyncQueue with an API
	for external modules to push TrackerDBFileInfo pointers into the
	queue.

2008-05-20  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c (tracker_metadata_get_embedded):
	Added here, calls the external extractor.

2008-05-20  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-process-files.c: Moved the
	tracker->dir_queue to tracker-process-files.c since it is only
	used there.

2008-05-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.[ch]: Changed
	tracker_log_term() to tracker_log_shutdown() and removed the
	domain parameter when initialising because we want to log ALL
	domains.

	* src/libtracker-common/tracker-nfs-lock.[ch]:
	* src/trackerd/tracker-db-manager.[ch]:
	* src/trackerd/tracker-ontology.[ch]: Changed _term() function to
	_shutdown() to be consistent.

	* src/libtracker-db/Makefile.am:
	* src/trackerd/Makefile.am: Make sure we define the G_LOG_DOMAIN
	correctly.

	* src/trackerd/tracker-db.[ch]: Added an _init() and _shutdown()
	function to handle the GQueue creation and clean up.

	* src/trackerd/tracker-main.[ch]: Moved the file_change_queue out
	of the Tracker struct and into tracker-db.c since that's the only
	place it is used.

2008-05-20  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-main.[ch]: Moved the database connections
	only used in the tracker-dbus module out of the Tracker struct.

2008-05-20  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.[ch]:
	(tracker_db_search_text_mime)
	(tracker_db_search_text_location)
	(tracker_db_search_text_mime_location): Not used anywhere in the
	code. Removed.

2008-05-20  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-thunderbird.c: Fixed some
	tracker_log() calls to use g_message() and the same for
	tracker_error(), etc.

	* src/trackerd/tracker-ontology.h: Renamed the header #define to
	ONTOLOGY and lined up functions.

2008-05-20  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-file-utils.c:
	* src/libtracker-common/tracker-language.c:
	* src/libtracker-common/tracker-log.c:
	* src/libtracker-common/tracker-log.h:
	* src/libtracker-common/tracker-nfs-lock.c:
	* src/libtracker-common/tracker-os-dependant-unix.c:
	* src/libtracker-common/tracker-os-dependant-win.c:
	* src/libtracker-common/tracker-type-utils.c:
	* src/libtracker-db/Makefile.am:
	* src/libtracker-db/tracker-db-file-info.c:
	* src/libtracker-db/tracker-db-interface-sqlite.c:
	* src/tracker-indexer/modules/files.c:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-apps.c:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-daemon.c:
	* src/trackerd/tracker-dbus-keywords.c:
	* src/trackerd/tracker-dbus-metadata.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-fam.c:
	* src/trackerd/tracker-hal.c:
	* src/trackerd/tracker-index-stage.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-ioprio.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-service-manager.c:
	* src/trackerd/tracker-utils.c:
	* src/trackerd/tracker-xesam-query.c: Use the
	g_{message|debug|warning|critical|error}() functions instead of
	the tracker_log_() variants instead. Fixes bug #529373 (Carlos
	Garnacho, Martyn Russell).

2008-05-19  Ivan Frade <ivan.frade@nokia.com>

	* src/trackerd/Makefile.am
	* src/trackerd/tracker-service-manager.[ch] (removed)
	* src/trackerd/tracker-ontology.[ch] Renamed tracker-service-manager
	to tracker-ontology. Added logic to handled Fields.

	* src/trackerd/tracker-field.[ch] Old FieldDef struct is now
	TrackerField GObject

	* src/trackerd/tracker-apps.c
	* src/trackerd/tracker-db-email.c
	* src/trackerd/tracker-db-sqlite.[ch]
	* src/trackerd/tracker-db.[ch]
	* src/trackerd/tracker-dbus-files.c
	* src/trackerd/tracker-dbus-keywords.c
	* src/trackerd/tracker-dbus-metadata.c
	* src/trackerd/tracker-dbus-search.c
	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-email-utils.c
	* src/trackerd/tracker-indexer.c
	* src/trackerd/tracker-metadata.c
	* src/trackerd/tracker-process-files.c
	* src/trackerd/tracker-query-tree.c
	* src/trackerd/tracker-rdf-query.c
	* src/trackerd/tracker-xesam-query.c
	* src/trackerd/tracker-main.c: Using new tracker-ontology.

	* src/trackerd/tracker-main.h: (tracker->metadata_table removed)

2008-05-19  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.[ch]: add
	tracker_indexer_module_get_ignore_directories().
	* src/tracker-indexer/modules/files.c: implement it to ignore the
	directories specified in the config file.
	* src/tracker-indexer/tracker-indexer.c
	(tracker_indexer_add_directory): Ignore files specified by the module.
	* src/libtracker-db/Makefile.am: do not link libtracker-db with
	libtracker-common, it's not necessary.

2008-05-16  Philip Van Hoof  <philip@codeminded.be>

	* DBus initialization. We must be more early at detecting whether or
	not another DBus trackerd service is already running. Else during the
	creation of the SQLite tables, a client that makes the DBus trackerd
	service start would cause two trackerd instances to be running.

2008-05-16  Philip Van Hoof  <philip@codeminded.be>

	* Fixed a few g_warnings about tracker_log not being initialized yet

2008-05-16  Philip Van Hoof  <philip@codeminded.be>

	* Merge from our own repository back to GNOME's Subversion server. We
	did this because caused by the SSH exploit, the GNOME Subversion
	servers were closed for commit access.

2008-05-16  Martyn Russell  <martyn@imendio.com>

	* src/tracker-search-tool/tracker-search-tool.c: Add other email
	services so they are recognised when requesting hit counts. It
	used to be just "Emails" as the service type, now we have
	"ThunderbirdEmails", "EvolutionEmails", etc.

	* src/trackerd/tracker-main.c: (main): Fix the command line option
	parsing so we actually set the verbosity and some of the other
	options. Also, don't start the indexer thread if it is disabled.

2008-05-16  Philip Van Hoof  <philip@codeminded.be>

	* data/sqlite-stored-procs.sql: Prepended a query with its db-name
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-main.h:
	* src/trackerd/tracker-dbus.c: Renamed index_db to mainloop_db
	* src/trackerd/tracker-process-files.c: Gave the indexer thread its
	own DBConnection

2008-05-16  Philip Van Hoof  <philip@codeminded.be>

	* Reverted the GThreadPool trick to exclude it from being the possible
	cause of various problems
	* Added tracker->xesam_db, it seems that using index_db in a
	GMainLoop's idle handler ain't working without the GThreadPool trick
	* Bugfix GetStats is not supposed to use db_con->common (it's attached
	to db_con already)
	* Same bugfix for GetRelatedServiceIDs

2008-05-16  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.c: Fixed two bugs, one
	where the padding was being set when setting the thread stack
	size. The second was that the max text to index was being set when
	setting the max words to index. This meant 0 words were being
	indexed.

	* src/trackerd/tracker-main.c: Added more configuration to the
	sanity check list so we can confirm things are starting up
	correctly.

2008-05-16  Philip Van Hoof  <philip@codeminded.be>

	* Applied a patch that fixes the DBConnection tracker->index_db

2008-05-14  Philip Van Hoof  <philip@codeminded.be>

	* src/tracker-indexer/modules/Makefile.am: Linker error fix
	* src/trackerd/tracker-dbus.c: Corrected a GStrv to be NULL terminated
	* src/trackerd/tracker-db-sqlite.c: Corrected tracker->index_db to be
	the one which as the ATTACH statements done

2008-05-14  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/tracker-indexer.c (process_module): just print
	one warning when some module couldn't be loaded.

2008-05-14  Carlos Garnacho  <carlos@imendio.com>

	* src/tracker-indexer/modules/files.c: get mimetype.
	* src/tracker-indexer/modules/Makefile.am: make files module link to
	the necessary libraries.

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.c:
	* src/libtracker-common/tracker-language.[ch]:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-main.c:
	* src/trackerd/tracker-query-tree.c: Use a GObject for
	TrackerLanguage so we can keep reference counts on it. It is
	becoming increasingly used now.

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-query-tree.c: (tracker_query_tree_new):
	Make sure we set the "query" after setting the "config" and
	"language" properties since they are required in the _set_query()
	function. This fixes several warnings to the console.

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-email.[ch]: Fix crash where we wouldn't
	pass TrackerConfig to the _init() function of email modules and it
	would return due to TRACKER_IS_CONFIG() failing on a NULL pointer.

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.h:
	* src/trackerd/tracker-process-files.c: Moved the indexer time
	taken information from the Tracker struct to the process-files
	module. This information is not used publically.

2008-05-14  Philip Van Hoof  <philip@codeminded.be>

	* Merged xesam-support to indexer-split
	->  svn merge -r 1398:1423 ../xesam-support

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db-sqlite.[ch]: Removed unused functions.

	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email.[ch]: Pass the TrackerConfig to the
	init() function to avoid using tracker->config.

	* src/trackerd/tracker-main.[ch]: Make sure we call all the
	missing _shutdown() functions for modules, like
	tracker_service_manager_shutdown(), etc.

	* src/trackerd/tracker-process-files.c: Don't try to set up signal
	handlers for the HAL object if we don't have HAL support compiled
	in to Tracker.

	* src/trackerd/tracker-service-manager.[ch]: Renamed
	tracker_service_manager_term() to _shutdown().

	* src/trackerd/tracker-xesam.[ch]: Added a _shutdown() function
	and moved the GHashTable of sessions to this module and out of the
	Tracker struct.

2008-05-14  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-interface-sqlite.c: No reply queries
	must not immediately return for their arguments might otherwise be
	freed by the caller context, before the GThreadPool thread reached
	reading the argument.

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:

	* src/trackerd/tracker-dbus-daemon.c: Changed the "config"
	property to be an object spec instead of a pointer spec. Also
	fixed the way we set the object.

	* src/trackerd/tracker-dbus-search.[ch]: Added "config" and
	"language" properties to be used with the TrackerQueryTree API.

	* src/trackerd/tracker-dbus-xesam.c:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-session.h: Fix includes.

	* src/trackerd/tracker-dbus.[ch]: Use Tracker pointer instead of
	gpointer for dbus initialisation and set the config/language for
	TrackerDBusSearch.

	* src/trackerd/tracker-main.[ch]: Removed the "stop_words" member
	of the Tracker struct, it is not used. Also removed the
	"index_number_min_length" member and replaced the one time it is
	used for a #define in tracker-parser.c.

	* src/trackerd/tracker-parser.[ch]: Refactored this module and
	made it not depend on TrackerConfig and TrackerLanguage, instead,
	we parse the values in that we need in the public API.

	* src/trackerd/tracker-query-tree.[ch]: Add properties for
	TrackerConfig and TrackerLanguage so we can use them when using
	the tracker-parser API.

	* src/trackerd/tracker-xesam.[ch]: Use proper GQuarks for the
	xesam error system and reordered the functions in the header to be
	more logical and inline with the .c file.

2008-05-14  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c:
	File loaders using TrackerDBInterface instead of DBConnection.

2008-05-14  Ivan Frade  <ivan.frade@nokia.com>

	* data/Makefile.am
	* data/sqlite-contents.sql: SQL code to create Contents table.

	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-db-sqlite.c:
	Using SQL file instead of hardcoded SQL to create ServiceContents
	table.
	(open_common_db): Removed. Using directly open_db_interface.
	(tracker_db_exec_proc): New. tracker_exec_proc but using
	TrackerDBInterface.
	(tracker_exec_no_reply)
	(tracker_metadata_is_key): Now static functions only in .c
	(tracker_db_integrity_check): Removed. Unused function.


2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: Don't initialise Tracker members
	unnecessarily.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.[ch]: Removed the log_filename from
	the Tracker struct, it didn't need to be there. Also added a
	function to clean up the directory locations separately to
	actually physically removing particular directories when we exit
	the daemon.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.[ch]:
	* src/tracker-indexer/tracker-indexer.[ch]: Added indentation
	information to the top of each file.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-index-stage.[ch]:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-process-files.c: Added TrackerIndexStage
	type to hold the current indexer state and type information.

2008-05-13  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-config.c (config_finalize): Free all
	allocated data.
	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_finalize):
	Instead, do not free unowned memory here.

2008-05-13  Carlos Garnacho  <carlos@imendio.com>

	Initial work on the separate indexer executable, implemented as a
	modular, single-threaded state machine.

	* src/tracker-indexer/main.c:
	* src/tracker-indexer/tracker-indexer.[ch]:
	* src/tracker-indexer/tracker-indexer-module.[ch]: Added, this is the
	indexer core.

	* src/tracker-indexer/modules/applications.c:
	* src/tracker-indexer/modules/dummy.c:
	* src/tracker-indexer/modules/files.c:
	* src/tracker-indexer/modules/gaim-conversations.c: Added, independent
	modules, called out by the indexer core.

	* src/libtracker-common/tracker-config.[ch]
	(tracker_config_class_init) (config_get_property)
	(config_set_property) (config_load_string_list)
	(tracker_config_get_index_modules): Added configuration option, plus
	methods to know which modules to query.
	(config_create_with_defaults): ensure TrackerConfig contains the
	default values if the configuration file didn't exist.

	* src/tracker-indexer/modules/Makefile.am:
	* src/tracker-indexer/Makefile.am:
	* configure.in: autofoo glue to make this build.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.h: Removed function definitions which
	are redundant.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.h: Use proper pointer types instead
	of gpointer for TrackerConfig, etc.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-convert-file.c: Removed, it is not in use.

2008-05-14  Philip Van Hoof  <philip@codeminded.be>

	* Merged with indexer-split (rev 1417)
	-> svn merge -r 1409:1417 ../indexer-split
	-> svn merge -r 1417:1422 ../indexer-split
	* Fixed Xesam error reporting
	* Fixed a few warnings

2008-05-13  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/*xesam*: Various infrastructure for Xesam added
	* Merged with indexer-split (Rev 1410)
	 -> svn merge -r 1398:1410 ../indexer-split/

2008-05-13  Ottela Mikael <mikael.ottela@ixonos.com>

	* Initial patch for Xesam queries
	* Committed by Philip Van Hoof

2008-05-13  Philip Van Hoof  <philip@codeminded.be>

	* First removed xesam-support branch
	* Branchpoint from indexer-split to xesam-support

2008-05-14  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-interface-sqlite.c: No reply queries
	must not immediately return for their arguments might otherwise be
	freed by the caller context, before the GThreadPool thread reached
	reading the argument.

2008-05-14  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:

	* src/trackerd/tracker-dbus-daemon.c: Changed the "config"
	property to be an object spec instead of a pointer spec. Also
	fixed the way we set the object.

	* src/trackerd/tracker-dbus-search.[ch]: Added "config" and
	"language" properties to be used with the TrackerQueryTree API.

	* src/trackerd/tracker-dbus-xesam.c:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-session.h: Fix includes.

	* src/trackerd/tracker-dbus.[ch]: Use Tracker pointer instead of
	gpointer for dbus initialisation and set the config/language for
	TrackerDBusSearch.

	* src/trackerd/tracker-main.[ch]: Removed the "stop_words" member
	of the Tracker struct, it is not used. Also removed the
	"index_number_min_length" member and replaced the one time it is
	used for a #define in tracker-parser.c.

	* src/trackerd/tracker-parser.[ch]: Refactored this module and
	made it not depend on TrackerConfig and TrackerLanguage, instead,
	we parse the values in that we need in the public API.

	* src/trackerd/tracker-query-tree.[ch]: Add properties for
	TrackerConfig and TrackerLanguage so we can use them when using
	the tracker-parser API.

	* src/trackerd/tracker-xesam.[ch]: Use proper GQuarks for the
	xesam error system and reordered the functions in the header to be
	more logical and inline with the .c file.

2008-05-14  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c:
	File loaders using TrackerDBInterface instead of DBConnection.

2008-05-14  Ivan Frade  <ivan.frade@nokia.com>

	* data/Makefile.am
	* data/sqlite-contents.sql: SQL code to create Contents table.

	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-db-sqlite.c:
	Using SQL file instead of hardcoded SQL to create ServiceContents
	table.
	(open_common_db): Removed. Using directly open_db_interface.
	(tracker_db_exec_proc): New. tracker_exec_proc but using
	TrackerDBInterface.
	(tracker_exec_no_reply)
	(tracker_metadata_is_key): Now static functions only in .c
	(tracker_db_integrity_check): Removed. Unused function.


2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.c: Don't initialise Tracker members
	unnecessarily.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.[ch]: Removed the log_filename from
	the Tracker struct, it didn't need to be there. Also added a
	function to clean up the directory locations separately to
	actually physically removing particular directories when we exit
	the daemon.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/tracker-indexer/tracker-indexer-module.[ch]:
	* src/tracker-indexer/tracker-indexer.[ch]: Added indentation
	information to the top of each file.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-index-stage.[ch]:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-process-files.c: Added TrackerIndexStage
	type to hold the current indexer state and type information.

2008-05-13  Carlos Garnacho  <carlos@imendio.com>

	* src/libtracker-common/tracker-config.c (config_finalize): Free all
	allocated data.
	* src/tracker-indexer/tracker-indexer.c (tracker_indexer_finalize):
	Instead, do not free unowned memory here.

2008-05-13  Carlos Garnacho  <carlos@imendio.com>

	Initial work on the separate indexer executable, implemented as a
	modular, single-threaded state machine.

	* src/tracker-indexer/main.c:
	* src/tracker-indexer/tracker-indexer.[ch]:
	* src/tracker-indexer/tracker-indexer-module.[ch]: Added, this is the
	indexer core.

	* src/tracker-indexer/modules/applications.c:
	* src/tracker-indexer/modules/dummy.c:
	* src/tracker-indexer/modules/files.c:
	* src/tracker-indexer/modules/gaim-conversations.c: Added, independent
	modules, called out by the indexer core.

	* src/libtracker-common/tracker-config.[ch]
	(tracker_config_class_init) (config_get_property)
	(config_set_property) (config_load_string_list)
	(tracker_config_get_index_modules): Added configuration option, plus
	methods to know which modules to query.
	(config_create_with_defaults): ensure TrackerConfig contains the
	default values if the configuration file didn't exist.

	* src/tracker-indexer/modules/Makefile.am:
	* src/tracker-indexer/Makefile.am:
	* configure.in: autofoo glue to make this build.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.h: Removed function definitions which
	are redundant.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-main.h: Use proper pointer types instead
	of gpointer for TrackerConfig, etc.

2008-05-13  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-convert-file.c: Removed, it is not in use.

2008-05-12  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-cache.[ch]: Reworked this module and
	cleaned up the code a bit.

	* src/trackerd/tracker-db.c: Fix some build warnings.

	* src/trackerd/tracker-email-utils.c: Renamed Tracker member.

	* src/trackerd/tracker-main.[ch]: More clean ups, also made the
	main thread wait for the process-files thread to finish before
	exiting. For some reason, we can't clean up the mutexes after that
	though because they are busy? Looks like the threading here needs
	looking at more thoroughly.

	* src/trackerd/tracker-process-files.c: Log when the thread exits.

2008-05-12  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c
	* src/trackerd/tracker-xesam-live-search.h
	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-dbus-xesam.h
	* data/tracker-dbus-xesam.xml: Support for range queries

2008-05-12  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-main.c:
	(tracker_db_close): Now uses TrackerDBInterface instead of
	DBConnecion.
	(tracker_db_needs_data): Now called tracker_db_common_need_build

2008-05-10  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-type-utils.c
	* src/libtracker-common/tracker-type-utils.h:
	(tracker_boolean_as_text_to_number): New function.

	* src/libtracker-common/tracker-utils.c
	* src/libtracker-common/tracker-utils.h
	(tracker_escape_string): Moved from tracker-db-sqlite to here.

	* src/trackerd/tracker-db-sqlite.c
	(tracker_db_load_service_file): Splitted in three functions, for
	.metadata, .services and .extensions files. Renamed to
	load_service_configuration_file, and now it is an static function.
	Removed duplicate code betwwen load_sql_file and load_sql_trigger.

	* src/trackerd/tracker-db-sqlite.h:
	(tracker_db_load_service_file) removed from the public API.

	* src/trackerd/tracker-db.c: Commented unused lines.

2008-05-09  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/Makefile.am
	* src/trackerd/tracker-db-manager.c
	* src/trackerd/tracker-db-manager.h: New module to handle
	databases locations, names and parameters.

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-indexer.c: Using new module.
	(open_db) is now open_db_interface.

	* src/trackerd/tracker-indexer.h: DB filenames moved to new
	module.

	* src/trackerd/tracker-main.c: Init/term the new module

	* src/trackerd/tracker-main.h:
	(tracker->services_dir): Removed

2008-05-09  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h:
	(tracker_db_set_default_pragmas): Now static function
	called set_default_pragmas and using TrackerDBInterface
	(set_params): Uses TrackerDBInterface instead of DBConnection.

2008-05-09  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-main.c
	* src/trackerd/tracker-process-files.c
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h:
	(tracker_db_exec_no_reply): Uses TrackerDBInterface instead of
	DBConnection.

2008-05-09  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db-sqlite.c:
	* src/libtracker-db/tracker-db-interface.h:
	* src/libtracker-db/tracker-db-interface-sqlite.c:
	* src/libtracker-db/tracker-db-interface.c: Improvement for queries
	that have no reply

2008-05-09  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/tracker-config.c
	* src/libtracker-common/tracker-config.h
	* src/libtracker-common/tracker-nfs-lock.c
	* src/libtracker-common/tracker-nfs-lock.h
	* src/trackerd/tracker-main.c
	* src/trackerd/tracker-main.h: NFS locking activated from config
	file.

	* src/trackerd/tracker-db-sqlite.c: Code style

2008-05-08  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-nfs-lock.c: Improve logging.

	* src/trackerd/tracker-dbus-daemon.c: Renamed  _do_cleanup() to
	_shutdown() and make it ONLY stop the main loop so we clean up
	every time after the mainloop stops.

	* src/trackerd/tracker-main.[ch]: Refactored this heavily to make
	the code start up and shut down flow easier to follow.

	* src/trackerd/tracker-process-files.c: Removed
	tracker->update_count since it was redundant.

2008-05-08  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-nfs-lock.[ch]: Cleaned up code to
	be consistent.

	* src/trackerd/tracker-db-sqlite.c: Fixed warning.

	* src/trackerd/tracker-dbus-search.c: Always call
	tracker_dbus_query_result_to_ptr_array() since it creates the
	return value even if the result set is empty.

2008-05-08  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db-sqlite.c:
	* src/libtracker-db/tracker-db-interface-sqlite.h:
	* src/libtracker-db/tracker-db-interface-sqlite.c: Corrected the
	GThreadQueue to have ALL sqlite_* calls in the same thread. This
	work needs some refactoring later. Especially the changes in
	tracker-db-sqlite.c are not quite the way I eventually want them.

2008-05-08  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-search.c: Bugfix when the amount of search
	results was 0

2008-05-08  Ivan Frade  <ivan.frade@nokia.com>

	* src/libtracker-common/Makefile.am
	* src/libtracker-common/tracker-nfs-lock.c
	* src/libtracker-common/tracker-nfs-lock.h
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-main.c:
	Moved NFS lock code to his own module in libtracker-common.

2008-05-08  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus-daemon.c:
	* src/trackerd/tracker-main.[ch]:
	* src/trackerd/tracker-process-files.c: Cleaned up the Tracker
	structure by removing members which are not used. Also removed the
	structures in the tracker-main.h file which are not used.

2008-05-08  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db-sqlite.c:
	* src/libtracker-db/tracker-db-interface.h:
	* src/libtracker-db/tracker-db-interface-sqlite.c:
	* src/libtracker-db/tracker-db-interface.c: Improvement for void returning
	queries

2008-05-08  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db-sqlite.h:
	* data/sqlite-stored-procs.sql:
	* data/sqlite-cache.sql:
	* data/Makefile.am:
	* data/sqlite-temp-tables.sql: Moved LiveSearches and Events to the
	cache db

2008-05-08  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-dbus-daemon.h:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-parser.c:
	* src/trackerd/tracker-process-files.h:
	* src/trackerd/tracker-utils.c:
	* src/trackerd/tracker-xesam.c:
	* src/trackerd/trackerd.[ch]: Renamed trackerd.[ch] to tracker-main.[ch].

2008-05-08  Philip Van Hoof  <philip@codeminded.be>

	* src/libtracker-db/tracker-db-interface-sqlite.c:
	Moved all sqlite3 queries to one thread in GThreadPool, prepared the
	ground for future asynchronous calling back.

2008-05-07  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db.c
	* src/trackerd/tracker-db-sqlite.h:
	Removed DBConnection from ServiceTypeInfo struct.

2008-05-07  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/trackerd.c:
	(tracker_db_initialize -> tracker_db_load_prepared_queries)
	(tracker_create_db -> tracker_create_common_db)
	Removed duplicate code. Databases are opened using open_db and
	set_params.

2008-05-07  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-config.h:
	* src/libtracker-common/tracker-configuration.[ch]:
	* src/libtracker-common/tracker-file-utils.h:
	* src/libtracker-common/tracker-language.h:
	* src/libtracker-common/tracker-log.h:
	* src/libtracker-common/tracker-os-dependant.h:
	* src/libtracker-common/tracker-type-utils.h:
	* src/libtracker-common/tracker-utils.h:
	* src/libtracker-db/tracker-db-action.h:
	* src/trackerd/tracker-apps.h:
	* src/trackerd/tracker-cache.h:
	* src/trackerd/tracker-db-email.h:
	* src/trackerd/tracker-db-sqlite.h:
	* src/trackerd/tracker-db.h:
	* src/trackerd/tracker-dbus-daemon.h:
	* src/trackerd/tracker-dbus-files.h:
	* src/trackerd/tracker-dbus-keywords.h:
	* src/trackerd/tracker-dbus-metadata.h:
	* src/trackerd/tracker-dbus-search.h:
	* src/trackerd/tracker-dbus-xesam.h:
	* src/trackerd/tracker-dbus.h:
	* src/trackerd/tracker-email-utils.h:
	* src/trackerd/tracker-email.h:
	* src/trackerd/tracker-hal.h:
	* src/trackerd/tracker-indexer.h:
	* src/trackerd/tracker-ioprio.h:
	* src/trackerd/tracker-metadata.h:
	* src/trackerd/tracker-parser.h:
	* src/trackerd/tracker-process-files.h:
	* src/trackerd/tracker-query-tree.h:
	* src/trackerd/tracker-rdf-query.h:
	* src/trackerd/tracker-service-manager.h:
	* src/trackerd/tracker-service.h:
	* src/trackerd/tracker-status.h:
	* src/trackerd/tracker-watch.h:
	* src/trackerd/tracker-xesam-live-search.h:
	* src/trackerd/tracker-xesam-session.h:
	* src/trackerd/tracker-xesam.h: Updated the header files to be
	more consistent and make sure we use the namespace of the binary
	we are creating to avoid two header files with the same
	name/definitions causing each other to not be included properly.

2008-05-07  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-utils.h: Fixed #ifndef issue where
	this utils file had the same name that the trackerd utils file
	had.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.[ch]:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-daemon.h:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-parser.c:
	* src/trackerd/tracker-process-files.h:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/tracker-xesam.c:
	* src/trackerd/trackerd.[ch]: Added trackerd.h for all stuff
	related to the Tracker struct. Kept all other utils based
	functions in tracker-utils.h. Fixed all the places where this
	broke things based on everything being included from
	tracker-utils.h and everwhere including that.

2008-05-07  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/tracker-xesam-session.c:
	* src/trackerd/tracker-xesam.[ch]: Moved tracker_unique_key() here
	from tracker-utils since it is an xesam thing only at the moment.

2008-05-07  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-dbus-daemon.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-indexer.[ch]:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/trackerd.c: Removed tracker_is_index_too_big() from
	tracker-utils.c to tracker-indexer.c and also made all database
	filenames in the code use a defined filename. The tracker_pause()
	and tracker_pause_on_battery() now has been renamed to
	tracker_should_pause...() and cleaned up.

2008-05-06  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h:
	(tracker_db_fsync): Removed function. Never used.
	Removed temporal variable: Easier to know who is using what in
	DBConnection.

2008-05-06  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-email.c
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-db.c
	* src/trackerd/trackerd.c: Removed DBConnection->index. It was
	always a pointer to the struct itself.

2008-05-06  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-parser.c: Renamed WordType to
	TrackerParserWordType to avoid conflicts.

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-utils.h
	* src/trackerd/trackerd.c:
	(tracker_db_connect_all): Removed unused param.
	Replaced gpointer with Indexer in Tracker struct.

	* src/trackerd/tracker-indexer.c
	* src/trackerd/tracker-indexer.h: Removed unused code.

2008-05-06  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-apps.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-service-manager.[ch]:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/trackerd.c: Moved all tracker_add_service_dir() API
	to tracker-service-manager and renamed it accordingly. This was
	moved out of tracker-utils.[ch].

	* src/libtracker-common/tracker-file-utils.[ch]: Moved the
	function which removes directory roots to here from the daemon.

2008-05-06  Philip Van Hoof  <philip@codeminded.be>

	* Bumped the version of SQLite from 3.4 to 3.5 because
		- We require --enable-threadsafe
		- This version allows concurrent access from different
		threads sharing the same connection

2008-05-06  Philip Van Hoof  <philip@codeminded.be>

	* Xesam property setters and getters

2008-05-05  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/tracker-db-sqlite.c: Removed tracker_timer_start()
	and tracker_timer_end() since they are only used in one place.
	Used a GTimer instead of GTimeVal and also optimised the loading
	of the prepared queries by using the GMappedFile API.

2008-05-05  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-cache.c
	* src/trackerd/trackerd.c
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h: Removed unused fields in DBConnection

2008-05-05  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h: Removed unused code and empty
	functions.

	* src/trackerd/tracker-db.c
	* src/trackerd/tracker-db.h:
	* src/trackerd/tracker-dbus-files.c:
	(tracker_db_get_field_def) Removed db_con parameter (unused)


2008-05-05  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-xesam.c
	* src/trackerd/tracker-db-sqlite.c: Added proper locking for the db
	while dealing with Events for LiveSearches

2008-05-02  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-xesam-live-search.c
	* src/trackerd/tracker-xesam-live-search.h
	* src/trackerd/tracker-dbus.c
	* src/trackerd/tracker-dbus-xesam.c
	* src/trackerd/tracker-dbus-xesam.h
	* src/trackerd/tracker-xesam.c
	* src/trackerd/tracker-xesam.h
	* src/trackerd/tracker-db-sqlite.c
	* src/trackerd/tracker-db-sqlite.h
	* src/libtracker-common/tracker-config.c
	* src/libtracker-common/tracker-config.h
	* data/sqlite-stored-procs.sql
	* data/sqlite-tracker.sql
	* data/Makefile.am: Xesam support infrastructure

2008-04-30  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-file-utils.[ch]: Added to handle
	IO operations.

	* src/libtracker-db/Makefile.am:
	* src/libtracker-db/tracker-db-action.[ch]:
	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-action.[ch]: Moved TrackerAction to
	libtracker-db and renamed to TrackerDBAction.

	* src/trackerd/tracker-apps.[ch]:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.[ch]:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email.c:
	* src/trackerd/tracker-email.h:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-process-files.[ch]:
	* src/trackerd/tracker-status.[ch]:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/trackerd.c: Moved FileInfo and WatchTypes to
	libtracker-db and renamed to TrackerDBFileInfo and
	TrackerDBWatch.

2008-04-30  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-os-dependant-unix.c:
	* src/libtracker-common/tracker-os-dependant-win.c:
	* src/libtracker-common/tracker-os-dependant.h: Moved to
	libtracker-common from trackerd.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-os-dependant-unix.c:
	* src/trackerd/tracker-os-dependant-win.c:
	* src/trackerd/tracker-os-dependant.h:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-utils.c:
	* src/trackerd/tracker-utils.h: Moved file utility functions to
	libtracker-common.

2008-04-29  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-action.[ch]: Added to handle TrackerAction
	type.

	* src/trackerd/tracker-db-sqlite.h:
	* src/trackerd/tracker-db.[ch]:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-fam.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/tracker-win-fs-changes.c: Renamed
	TrackerChangeAction to TrackerAction and moved it to
	tracker-action.[ch].

2008-04-29  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-dbus-xesam.[ch]:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-xesam-live-search.c:
	* src/trackerd/tracker-xesam-search.[ch]:
	* src/trackerd/tracker-xesam-session.h:
	* src/trackerd/tracker-xesam.[ch]: Renamed tracker-xesam-search to
	tracker-dbus-xesam.

2008-04-29  Martyn Russell  <martyn@imendio.com>

	* data/Makefile.am:
	* data/tracker-xesam-search.xml: Renamed to
	tracker-dbus-xesam.xml.

	* src/trackerd/tracker-xesam-live-search.[ch]:
	* src/trackerd/tracker-xesam-search.[ch]:
	* src/trackerd/tracker-xesam-session.[ch]:
	* src/trackerd/tracker-xesam.[ch]: Code clean ups.

2008-04-29  Martyn Russell  <martyn@imendio.com>

	* Reverted Philips changes.

2008-04-28  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-type-utils.c:
	* src/libtracker-common/tracker-type-utils.h:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-rdf-query.c: Clean up the
	tracker-type-utils function names to be more consistent.

2008-04-28  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-type-utils.[ch]:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-utils.[ch]: Created tracker-type-utils.[ch]
	to handle type a to type b conversions (e.g. GSList* to gchar **).

2008-04-28  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
 	* src/Makefile.am:
	* src/libtracker-db/Makefile.am: Created new libtracker-db to
	handle the shared database API between daemon and other
	components of Tracker.

	* src/trackerd/tracker-db-interface-sqlite.[ch]:
	* src/trackerd/tracker-db-interface.[ch]: Moved to libtracker-db.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-db-sqlite.[ch]:
	* src/trackerd/tracker-dbus.h:
	* src/trackerd/tracker-indexer.h: Updated files to include new
	libtracker-db files.

2008-04-28  Philip Van Hoof  <philip@codeminded.be>

	* Merged branches/xesam-support back to brances/indexer-split

2008-04-25  Philip Van Hoof  <philip@codeminded.be>

	* Adapted the TrackerXesamSearch DBus proxy to use
	org.freedesktop.DBus.GLib.Async

2008-04-23  Philip Van Hoof  <philip@codeminded.be>

	* Added error reporting
	* Added some more ad-hoc implementations in TrackerXesamSearch

2008-04-22  Philip Van Hoof  <philip@codeminded.be>

	* Branched as xesam-support
	* Added Xesam skeleton
	* Introduced TrackerXesamSearch
	* Introduced TrackerXesamLiveSearch
	* Introduced TrackerXesamSession

2008-04-21  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am: Fixed make distcheck issues.

2008-04-21  Martyn Russell  <martyn@imendio.com>

	* src/libtracker/tracker.[ch]: Fixed some left over issues from
	the DBus patch which were caused by left over cruft in
	$prefix/include.

2008-04-21  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-interface.[ch]:
	* src/trackerd/tracker-db-interface-sqlite.c: Implement API to
	start/end a transaction. Do not allocate (and later free) any
	memory if a stmt doesn't return any rows. Add a GError parameter to
	all query methods.

	* src/trackerd/tracker-db-sqlite.h: do forward declaration for
	DBConnection, so it can hold pointers to structures of the same type
	instead of just gpointers.

	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-dbus-keywords.c:
	* src/trackerd/tracker-dbus-metadata.c:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/trackerd.c: Update to use new API.

2008-04-21  Martyn Russell  <martyn@imendio.com>

	Added DBus introspection support for the DBus API and reworked the
	code to use the glib bindings.

	* configure.ac: Added check for DBus bindings tool to create
	server side and client side glue header files.

	* data/Makefile.am:
	* data/tracker-dbus-daemon.xml:
	* data/tracker-dbus-files.xml:
	* data/tracker-dbus-keywords.xml:
	* data/tracker-dbus-metadata.xml:
	* data/tracker-dbus-search.xml: Added to separate DBus interfaces
	into their respective files.

	* data/tracker-introspect.xml: Removed in favour of new DBus
	interface files.

	* src/libtracker-common/tracker-language.[ch]:
	* src/libtracker-common/tracker-log.[ch]: Fixed copyright
	information.

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-utils.[ch]:
	* src/trackerd/tracker-db-sqlite.c: Added tracker-utils.[ch] to
	handle some of the commonly shared utility functions which are
	used across more than just the tracker daemon.

	* src/libtracker/Makefile.am:
	* src/libtracker/tracker.c: Fixed object paths for DBus
	connectivity to the various interfaces we use.

	* src/libtracker/tracker.h: For the typedef enum MetadataTypes,
	use METADATA_ as the prefix to all these values so we don't cause
	namespace issues elsewhere.

	* src/tracker-preferences/tracker-preferences.c: Don't depend on
	the tracker daemon DBus definitions for the various interfaces we
	connect to, instead define them specifically ourselves.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-dbus-daemon.[ch]: Added to handle daemon
	specific DBus requests like shutting down and getting the current
	status, etc.

	* src/trackerd/tracker-dbus-files.[ch]:
	* src/trackerd/tracker-dbus-keywords.[ch]:
	* src/trackerd/tracker-dbus-metadata.[ch]:
	* src/trackerd/tracker-dbus-search.[ch]: Rewritten to use the
	DBus glib bindings. This results in less code and a nicer way to
	implement DBus APIs with introspection thrown in for free.

	* src/trackerd/tracker-dbus.[ch]: Updated to just initialise DBus
	support in the tracker daemon and host utility functions needed
	for each interface.

	* src/trackerd/tracker-dbus-methods.[ch]:
	* src/trackerd/tracker-process-requests.[ch]: Removed. None of
	these functions are necessary any longer.

	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-modest.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/trackerd.c: Updates reflecting the new DBus changes.

	* src/trackerd/tracker-marshal.list:
	* src/trackerd/tracker-marshal-main.c: Added to include generated
	marshal files built for extended signalling with unique	callback
	signatures.

	* src/trackerd/tracker-status.[ch]: Added to handle the current
	state and to also signal changes when the global tracker daemon
	state changes.

	* src/trackerd/tracker-utils.[ch]: Moved functions to relevant
	modules and removed all other unused code.

2008-04-17  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-email-modest.c
	* src/trackerd/tracker-utils.c
	* src/trackerd/tracker-utils.h
	* src/trackerd/trackerd.c
	* src/trackerd/tracker-email-evolution.c
	* src/trackerd/tracker-process-files.c
	* src/trackerd/tracker-indexer.c

	Introduced tracker_set_status

2008-04-16  Patch from Szilveszter Farkas <szilveszter.farkas@gmail.com>

	* src/libstemmer/src_c/stem_UTF_8_hungarian.c
	* src/libstemmer/src_c/stem_UTF_8_hungarian.h
	* src/libstemmer/Makefile.am
	* src/libtracker-common/tracker-language.c
	* src/tracker-preferences/tracker-preferences.glade
	* data/languages/stopwords.hu
	* data/languages/Makefile.am

	Added hungarian stemmer and stopword list

2008-04-14  Carlos Garnacho  <carlos@imendio.com>

        Implement a database abstraction interface, with a sqlite
        implementation. Queries/procedures return a TrackerDBResultSet object,
        which simplifies result data extraction.

        * src/trackerd/tracker-db-interface.[ch]: Added. Interface to access
        databases.

        * src/trackerd/tracker-db-interface-sqlite.[ch]: Added. Sqlite
        implementation.

        * src/trackerd/Makefile.am: add these files.

        * src/trackerd/tracker-db-email.[ch], tracker-db-sqlite.[ch],
        tracker-db.c, tracker-dbus-files.c, tracker-dbus-keywords.c,
        tracker-dbus-metadata.c, tracker-dbus-search.c,
        tracker-email-evolucion.c, tracker-email-modest.c, tracker-inotify.c,
        tracker-process-files.c, trackerd.c: Use the new API.

        * src/trackerd/tracker-dbus-methods.[ch]: Modify to build a
        DBusMessage from a TrackerDBResultSet.

2008-04-14  Martyn Russell  <martyn@imendio.com>

        * configure.ac:
        * src/Makefile.am:
        * src/tracker-indexer/Makefile.am:
        * src/tracker-indexer/tracker-indexer.c: Created initial binary
        for tracker-indexer.

2008-04-11  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/libtracker-common/tracker-config.[ch]: Added options
	"index-mounted-directories" and "index-removable-devices".

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-hal.[ch]: Added to do all things HAL.

	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-methods.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-fam.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-process-files.[ch]:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/trackerd.c: Moved a LOT of code out of
	tracker-utils.[ch] and into tracker-process-files.[ch] since
	that's the only place they were used. Moved HAL code out to new
	module. Fixes bug #503725.

2008-04-11  Philip Van Hoof  <philip@codeminded.be>

	* src/trackerd/tracker-email-modest.c
	* src/trackerd/tracker-utils.c
	* src/trackerd/tracker-utils.h
	* src/trackerd/tracker-email-utils.c
	* src/trackerd/tracker-email-utils.h
	* src/trackerd/trackerd.c: Added stopping watching E-mail service
	paths. Also fixes a potential memory leak with the Hashtable
	service_directory_table

2008-04-10  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-email.c (tracker_email_index_file): Revert last
	change, it was already fixed in r1261.

2008-04-10  Carlos Garnacho  <carlos@imendio.com>

	Add a query extension tree, at the moment supports And and Or
	operations. Fixes #509607.

	* src/trackerd/tracker-query-tree.[ch]: New files, implement the
	expression tree, and return a hit list based on the evaluation of the
	search terms with the logical expressions.
	* src/trackerd/Makefile.am: Added these files.
	* src/trackerd/tracker-indexer.[ch]: Remove SearchQuery related code,
	implemented now by TrackerQueryTree.
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-dbus-search.c: Use new TrackerQueryTree API.

2008-04-10  Philip Van Hoof  <philip@codeminded.be>

	* python/deskbar-handler/tracker-module.py
	* python/deskbar-handler/tracker-handler.py
	* src/trackerd/tracker-db-email.c
	* src/trackerd/tracker-db-email.h
	* src/trackerd/tracker-email-thunderbird.c
	* src/trackerd/tracker-dbus-search.c
	* src/trackerd/tracker-email-modest.c
	* src/trackerd/tracker-email-modest.h
	* src/trackerd/tracker-email-utils.c
	* src/trackerd/tracker-email.c
	* src/trackerd/tracker-email-utils.h
	* src/trackerd/tracker-email-evolution.c
	* src/trackerd/tracker-email-kmail.c
	* src/trackerd/Makefile.am
	* src/libtracker-common/tracker-configuration.c
	* src/tracker-search-tool/tracker-search-tool-callbacks.c
	* src/tracker-preferences/tracker-preferences.glade
	* src/tracker-preferences/tracker-preferences.c
	* docs/tracker.cfg.5
	* data/services/default.service: Added support for the mobile
	E-mail client Modest

2008-04-09  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-process-files.c (process_index_entity): Use the
	correct database when indexing mail archives.

2008-04-08  Ivan Frade <ivan.frade@nokia.com>

	* data/sqlite-stored-procs.sql: Fixed names in stored proc.

2008-04-08  Claude Paroz  <claude@2xlibre.net>

	* src/tracker-applet/tracker-applet-prefs.glade: Removed translatable
	property from stock label.

2008-04-08  Ivan Frade  <ivan.frade@nokia.com>

	Hide indexer struct to improve modularity. Bug #525403

	* src/trackerd/tracker-utils.h: WordDetails moved to the indexer.

	* src/trackerd/tracker-dbus-search.c: Levenshtein algorythm moved
	to the indexer.

	* src/trackerd/tracker-cache.c:
	* src/trackerd/trackerd.c: Updated to new functions

	* src/trackerd/tracker-indexer.[ch]: Hide indexer struct
	implementation. Added Levenshtein code and WordDetails struct.


2008-04-08  Ivan Frade  <ivan.frade@nokia.com>

	* src/trackerd/tracker-service.h
	* src/trackerd/tracker-service-manager.c
	* src/trackerd/tracker-service-manager.h
	* src/trackerd/tracker-service.c: Added files missing in previous
	commit.

2008-04-08  Ivan Frade  <ivan.frade@nokia.com>

	Service type information encapsulated in TrackerService GObject.
	Service-type/mime/mime prefixes relations in tracker_service_manager.
	Bug #523200

	* data/services/default.service: Add HasFulltext, HasMetadata,
	HasThumbs properties with proper values.

	* data/sqlite-stored-procs.sql: Add method to obtain service
	type related mimes.

	* src/trackerd/Makefile.am: Add new files for compilation.

	* src/trackerd/tracker-process-files.c:
	* src/trackerd/trackerd.c:
	* src/trackerd/tracker-dbus-keywords.c
	* src/trackerd/tracker-dbus-search.c
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-dbus-metadata.c
	* src/trackerd/tracker-dbus-methods.c:
	* src/trackerd/tracker-rdf-query.c
	* src/trackerd/tracker-db-sqlite.h
	* src/trackerd/tracker-db.c
	* src/trackerd/tracker-db-email.c: Use new methods.

	* src/trackerd/tracker-db-sqlite.c: Use new methods.
	(tracker_db_mime_query): New helper function to obtain mime and mime
	prefixes for a service type.
	(tracker_db_get_mimes_for_service_id):
	(tracker_db_get_mime_prefixes_for_service_id): New wrapper functions to
	tracker_db_mime_query.
	(db_row_to_service): Convert a service type row in the database to
	a new TrackerService object.

	* src/tracker-preferences/tracker-preferences.c:
	* src/trackerd/tracker-dbus.[ch]: renamed TRACKER_SERVICE to
	TRACKER_DBUS_SERVICE

	* src/trackerd/tracker-indexer.c: Reformatted code.

	* src/trackerd/tracker-metadata.c: Removed hardcoded mimes and
	logic to solve mime->service_type

	* src/trackerd/tracker-service-manager.[ch]: Code handling service
	types, mimes and mime prefixes.

	* src/trackerd/tracker-service.[ch]: GObject representing a
	service type

	* src/trackerd/tracker-utils.[ch]: Removed ServiceDef struct and
	related methods.

2008-04-08  Michael Biebl  <mbiebl@gmail.com>

	* NEWS: Revamp the NEWS file. Patch by Tshepang Lekhonkhobe.
	* README: Update the documentation about compilation, runtime
	requirements, configuration and usage. Patch by Tshepang Lekhonkhobe.

2008-04-07  Ivan Frade  <ivan.frade@nokia.com>

	Using standard C functions to parse dates. Bug #526727
	Replaced iso8160 with iso8601

	* tracker-extract.[ch]: Replaced tracker_generic_data_extractor
	and his	auxiliar functions with tracker_generic_date_to_iso8601,
	strftime and strptime.

	* tracker-extract-ps.c:
	* tracker-extract-png.c:
	* tracker-extract-exif.c: Updated to use the new function.

2008-04-07  Carlos Garnacho  <carlos@imendio.com>

	Make Mail indexing modular. Bug #526761.

	* src/libtracker-common/tracker-config.[ch]: Add a string
	configuration parameter instead of a boolean value for each mail
	client.

	* src/trackerd/Makefile.am: Build mail client dependent code in
	separate modules

	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-thunderbird.c: Modified to run as a
	module.

	* src/trackerd/tracker-email-evolution.h:
	* src/trackerd/tracker-email-kmail.h:
	* src/trackerd/tracker-email-thunderbird.h: Removed, no longer
	necessary. The three modules share now the same public interface,
	and these are called through GModule.

	* src/trackerd/tracker-email.[ch]: Use GModule to load the selected
	mail client code and call the module methods.

	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-process-files.c:
	* src/trackerd/trackerd.c:
	* src/trackerd/tracker-dbus-methods: Change to work with modular mail
	indexing.

2008-03-29 Laurent Aguerreche <laurent.aguerreche at free fr>

	* src/tracker-preferences/tracker-preferences.c:
	avoid tracker-preference crashes when configuration file does not
	have a "/Indexing/Language" entry.

2008-03-28  Jerry Tan <jerry.tan@sun.com>

	* src/libtracker-common/tracker-configuration.c:
	to make it build on solaris with sunstudio.

2008-03-27  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-parser.c: Fix compiler warning.

2008-03-27  Martyn Russell  <martyn@imendio.com>

	* data/sqlite-stored-procs.sql:
	* src/trackerd/tracker-dbus-files.c:
	(tracker_dbus_method_files_get_text_contents): Implemented the
	GetTextContents method. This fixes bug #514553.

2008-03-26  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-process-files.[ch]:
	* src/trackerd/tracker-process-requests.[ch]:
	* src/trackerd/trackerd.c: Added these files to split out the
	indexing functionality which was in trackerd.c. Fixes bug #521803.

	* src/trackerd/tracker-utils.h: Removed two members of the Tracker
	struct which are not used globally.

2008-03-17  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.c:
	(tracker_log_init): Safe guard initialising the tracker log more
	than once. Patch by Ivan Frade.

2008-03-10  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-configuration.c: (string_replace):
	* src/libtracker-gtk/tracker-keyword-store.c:
	(tracker_keyword_store_drag_data_get):
	* src/libtracker-gtk/tracker-metadata-tile.c: (_int_to_label):
	* src/qdbm/myconf.c: (_qdbm_mmap):
	* src/text-filters/ooo_converter/ChangeLog:
	* src/text-filters/ooo_converter/o3read.c:
	* src/tracker-applet/tracker-applet.c: (reindex):
	* src/tracker-search-tool/tracker-search-tool.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/trackerd.c: (get_update_count): Fixed all warnings
	generated when building the tracker project with the exception of
	xdgmime which is imported. This fixes bug #520789.

2008-03-10  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-methods.c:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-utils.h: Fix missing
	libtracker-common/tracker-config.h and
	libtracker-common/tracker-log.h dependencies which requires it.

2008-03-10  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-log.c: (tracker_log_term):
	* src/libtracker-common/tracker-log.h:
	* src/trackerd/trackerd.c: Remove the dependency on tracker-config
	by the tracker-log module.

2008-03-07 Jamie McCracken <jamiemcc at gnome org>

	* Fix for possible email crasher


2008-03-06  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/tracker-configuration.c:
	* src/qdbm/myconf.c:
	* src/text-filters/ooo_converter/o3read.c:
	* src/tracker-applet/tracker-applet.c: Fixed compiler warnings.

	* src/libtracker-gtk/tracker-keyword-store.c:
	(tracker_keyword_store_drag_data_get): Change
	gtk_selection_data_set() to gtk_selection_data_set_text() instead,
	saves us casting to a guchar pointer.

	* src/libtracker-gtk/tracker-metadata-tile.c: Removed unused
	date_to_str() function.

	* src/tracker-search-tool/tracker-search-tool.c: Removed unused
	tracker_search_select_service_type_by_string() function.

	* src/trackerd/tracker-email-thunderbird.c: Remove unused
	get_boolean_from_string() function.

	* src/trackerd/tracker-indexer.c: Include ISO definitions before
	including math.h so we don't get warnings about lrintf() usage.

	* src/trackerd/trackerd.c: Removed unused set_update_count()
	function.

2008-03-06  Martyn Russell  <martyn@imendio.com>

	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-config.[ch]:
	* src/libtracker-common/tracker-language.[ch]: Moved these files
	here from src/trackerd so the API can be shared by all components.

	* src/libtracker-common/tracker-log.[ch]: Created by taking these
	functions from the src/trackerd/tracker-utils.c log functions.
	This is based on a patch from Ivan Frade.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-apps.c:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-email.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-files.c:
	* src/trackerd/tracker-dbus-keywords.c:
	* src/trackerd/tracker-dbus-metadata.c:
	* src/trackerd/tracker-dbus-methods.c:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-kmail.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-email.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-inotify.c:
	* src/trackerd/tracker-ioprio.c:
	* src/trackerd/tracker-metadata.c:
	* src/trackerd/tracker-parser.c:
	* src/trackerd/tracker-rdf-query.c:
	* src/trackerd/tracker-utils.c:
	* src/trackerd/trackerd.c: Update the include statments in most of
	these files to use libtracker-common's config/log headers.

2008-03-05  Martyn Russell  <martyn@imendio.com>

	* src/trackerd/tracker-config.[ch]: Added.
	* src/trackerd/tracker-language.[ch]: Added.
	* src/trackerd/tracker-stemmer.[ch]: Removed.

	* src/trackerd/Makefile.am:
	* src/trackerd/tracker-cache.c:
	* src/trackerd/tracker-db-sqlite.c:
	* src/trackerd/tracker-db.c:
	* src/trackerd/tracker-dbus-methods.c:
	* src/trackerd/tracker-dbus-search.c:
	* src/trackerd/tracker-dbus.c:
	* src/trackerd/tracker-email-evolution.c:
	* src/trackerd/tracker-email-thunderbird.c:
	* src/trackerd/tracker-email-utils.c:
	* src/trackerd/tracker-email.c:
	* src/trackerd/tracker-indexer.c:
	* src/trackerd/tracker-parser.c:
	* src/trackerd/tracker-utils.[ch]:
	* src/trackerd/trackerd.c: Moved all configuration options to
	their own module for type and limit checking combined with
	property notification and signalling. This fixes bug #513486.

2008-03-04  Saleem Abdulrasool  <compnerd@compnerd.org>

	* src/libtracker-common/Makefile.am:
		libtracker-common is really a private library, dont install it to the
		system.  Thanks to Michael Biebl <mbiebl at gmail dot com> for noticing.

2008-03-04  Martyn Russell  <martyn@imendio.com>

	* autogen.sh:
	* configure.ac: Make build work for Maemo platform, changes
	autoconf prereq to 2.59 not 2.59c and uses 1.9 instead of 1.7.
	This fixes bug #511752.

2008-03-03  Saleem Abdulrasool  <compnerd@compnerd.org>

	* configure.ac:
	* src/Makefile.am:
	* src/libtracker-common/Makefile.am:
	* src/libtracker-common/tracker-configuration.c:
	(get_default_language_code), (write_default_config),
	(string_replace), (tracker_configuration_load),
	(tracker_configuration_save), (tracker_configuration_free),
	(tracker_configuration_get_string_list),
	(tracker_configuration_set_string_list),
	(tracker_configuration_get_list), (tracker_configuration_set_list):
	* src/libtracker-common/tracker-configuration.h:
	* src/tracker-preferences/Makefile.am:
	* src/tracker-preferences/tracker-configuration.c:
	* src/tracker-preferences/tracker-configuration.h:
	* src/tracker-preferences/tracker-preferences.c:
	(tracker_preferences_init), (tracker_preferences_finalize),
	(set_bool_option), (set_int_option), (setup_page_general),
	(setup_page_performance), (setup_page_files),
	(setup_page_ignored_files), (setup_page_emails),
	(name_owner_changed), (restart_tracker),
	(tracker_preferences_cmd_apply), (tracker_preferences_cmd_cancel):
		Beginings of libtracker-common.  Migrate tracker-preferences to it.

2008-03-02 Jamie McCracken <jamiemcc at gnome org>

	* Lots of minor tweaks
	* make  aplet prefs more hig compliant


2008-02-27 Jamie McCracken <jamiemcc at gnome org>

	* stopped applet respawn of trackerd (via dbus activation unpause method) when killed whilst smart paused
	* Made progress/animation of email indexing in step
	* Added index merging progress to tooltip
	* Fixed clean exiting of trackerd when paused and in index merge state
	* Fixed final index replacing main index at startup if no tmp merge indexes exist


2008-02-27 Jamie McCracken <jamiemcc at gnome org>

	* fixed applet
	* added pref screen for applet
	* aded reindex option to applet
	* fixed bugs in blacklists

2008-02-26 Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-sqlite.c (sqlite3_get_service_name):
	* src/trackerd/tracker-dbus-metadata.c
	(tracker_dbus_method_metadata_set) (tracker_dbus_method_metadata_get):
	* src/trackerd/tracker-dbus-search.c
	(tracker_dbus_method_search_get_hit_count_all)
	(tracker_dbus_method_search_text_detailed): Plug some leaks. Fixes
	#518882.

2008-02-25 Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-sqlite.c (tracker_exec_proc)
	(tracker_exec_proc_ignore_nulls): Plug 2 memleaks introduced
	by the switch to GPtrArray.

2008-02-25 Jerry Tan <jerry.tan@sun.com>
        * add firefox extension for web history indexing

2008-02-24 Jamie McCracken <jamiemcc at gnome org>

	* added tmp black list of frequently changing files

2007-02-24 patches from Jerry Tan <jerry.tan@sun.com>

	* added web history


2008-02-22  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-applet/tracker-applet.c: (set_status_hint),
	(create_context_menu):
	More strings for translation and fix capitalization.


2008-02-21 Jamie McCracken <jamiemcc at gnome org>

	* Updated applet
	* removed popup window and replaced with tooltip to indicate status/progress
	* added smart pause by tracking X events for mouse and keyboard
	* added more options to not show animation and hide icon

2008-02-17  Saleem Abdulrasool  <compnerd@compnerd.org>

	* src/tracker-applet/tracker-applet.c: (set_progress),
	(index_finished), (index_state_changed), (tray_icon_show_message),
	(main):
	Inline translatable strings and fix some whitespace issues

2008-02-16  Jaap Haitsma  <jaap@haitsma.org>

	* src/tracker-applet/tracker-applet.c: (create_context_menu),
	(statistics_menu_activated), (open_uri), (about_url_hook),
	(about_email_hook), (about_menu_activated), (main):
	Add about dialog to applet. Fixes bug #507339

2008-02-14  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-metadata.c (tracker_metadata_get_embedded):
	Rewrite function so it's less indented, and copies a bit less memory
	around. Bug #513688.

2008-02-14  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-sqlite.c (tracker_exec_proc): Store directly
	results in a GPtrArray. Bug #513691.

2008-02-14  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-sqlite.h:
	* src/trackerd/tracker-utils.h: Pack booleans in guints to make most
	used structs smaller. Bug #513692.

2008-02-08  Rich Burridge <rich.burridge@sun.com>

	* src/libtracker-gtk/tracker-utils.h:
	  src/libtracker-gtk/tracker-utils.c:
	  src/libtracker-gtk/tracker-tag-bar.c:
          Fix for bug #494892 - Label for/labeled by relation missing for
          add tag button.

	* src/libtracker-gtk/tracker-metadata-tile.c:
	  From Wendy Hu <Huiwe.Hu@sun.com>
	  Fix for bug #494907 – Labels should be set as focusable.

        * src/tracker-search-tool/tracker-search-tool.c:
          From Patrick Wade <patrick.wade@sun.com>
          Fix for bug #495205 – Warning message label should be accessible
          to at-tools.

        * src/tracker-search-tool/tracker-search-tool-support.c:
          src/tracker-search-tool/tracker-search-tool-support.h:
          src/tracker-search-tool/tracker-search-tool.c:
          Fix for bug #494878 – Search hit number can not be reported by Orca.

2008-02-05  Rich Burridge <rich.burridge@sun.com>

        * src/tracker-preferences/tracker-preferences.glade:
          Fix for bug #503215 – The time unit is not reported by default.

2008-02-03 Patch from Carlos Garnacho  <carlos@imendio.com>

	* GNOME Bug #509601: make tracker-extract more modular using dynamically loaded libraries

2008-01-30 Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-preferences/tracker-preferences.c:
	(tracker_preferences_cmd_apply):
	Fix my bad English, courtesy of A. Walton and Michael Biebl.

2008-01-30 Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-preferences/tracker-preferences.c:
	(tracker_preferences_cmd_apply):
	HIGfication of reindex/restart alerts.

2008-01-29 Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-sqlite.c (tracker_db_search_text): Avoid
	doing too many relocations of data in memory. Bug #511781.
	* src/trackerd/tracker-utils.c (array_to_list): Same here.

2008-01-28  Carlos Garnacho  <carlos@imendio.com>

	* src/trackerd/tracker-db-sqlite.c (tracker_exec_proc_ignore_nulls):
	Store directly results in a GPtrArray. Bug #511788

2008-01-27 Patches from from Thiago Marcos P. Santos <tmpsantos@gmail.com>

	* Fixed missing gobject ldadd in libtracker
	* Made thread stack size configurable

2008-01-23 Halton Huo   <Halton.Huo@Sun.COM>

	Implement explicit apply for t-p.
	* src/tracker-preferences/tracker-preferences.c:
	* src/tracker-preferences/tracker-preferences.glade:

2008-01-21 Halton Huo   <Halton.Huo@Sun.COM>

	* src/trackerd/trackerd.c: (process_files_thread):
	  Refresh index when deleting files

2008-01-17 Michal Pryc <michal dot pryc at sun dot com>

	* Patch from Mathieu Dimanche <mdimanche at free dot fr>
	Fixed character encoding problems between Thunderbird
	and trackerd, a.k.a. UTF-8 encoded TMS files

2008-01-11 Laurent Aguerreche <laurent.aguerreche at free fr>

	* Patch from Dan Bryant <dan.bryant at jhuapl edu>
	Implements access to imap accounts with MD5-DIGEST authentication


2008-01-05 Jaap Haitsma  <jaap@haitsma.org>

	* src/tracker-preferences/tracker-preferences.c:
	Change CamelCase function name to lowercase seperated by _


2008-01-05 Jaap Haitsma  <jaap@haitsma.org>

	* src/tracker-applet/tracker-applet.c:
	* src/tracker-applet/tracker-applet.h:
	Add license file to top of file


2008-01-05 Jaap Haitsma  <jaap@haitsma.org>

	* src/tracker-applet/Makefile.am:
	* src/tracker-applet/tracker-applet-private.h:
	* src/tracker-applet/tracker-applet.c:
	* src/tracker-preferences/Makefile.am:
	* src/tracker-preferences/tracker-configuration-private.h:
	* src/tracker-preferences/tracker-configuration.c:
	* src/tracker-preferences/tracker-preferences-private.h:
	* src/tracker-preferences/tracker-preferences.c:
	Remove *-private.h files. Just put these declarations in the
	respective *.c files


2007-12-13 Jamie McCracken <jamiemcc at gnome org>

	* Fixed issue with log file being null
	* Fixed typo of metadata name Audio:PeakTrackGain in the gstreamer extractor
	* fix for crasher where index name is null during merging
	* make initial indexing on battery off by default
	* Fixed prevention of multiple instances of trackerd causing infinite loop and 100% cpu
	* Fixed reentrant signals to prevent loops by dying quickly


2007-12-09 Jamie McCracken <jamiemcc at gnome org>

	* Increased startup sleep for applet to prevent race condition
	* Made applet handle trackerd being stopped gracefully
	* Fixed GetHitCount service type
	* updated hit counts when duds are present in TST



2007-12-09 Jamie McCracken <jamiemcc at gnome org>

	* Strengthed indeing of emails (utf-8 check on addresses)
	* Stop indexing if index or db is too large (>2GB)
	* Fixed notification of tag delete so index is updated
	* set low disk space to 1% by default
	* added kill timeout if not shutdown cleanly within 20 secs


2007-12-03 Marcus Fritzsch <m at fritschy dot de>

	* python/deskbar-handler/tracer-module.py
	  Even more defensively programmed add_all_actions () to get
	  around *older* deskbar releases (prior rev 1701). Another
	  fix to gnome bug #474131


2007-11-30 Jerry Tan <jerry.tan@sun.com>
        fix gnome bug 495528, disable Save Result As when search type like email, applications
        * src/tracker-search-tool/tracker-search-tool.c


2007-11-28 Jerry Tan <jerry.tan@sun.com>
        implement the feature to set ignore filename pattern.
        * src/trackerd/tracker-utils.h
        * src/trackerd/tracker-utils.c
        * src/trackerd/trackerd.c


2007-11-26 Marcus Fritzsch <m at fritschy dot de>

	* pause on low disk space support
	* unified pause call: tracker_pause ()
	* added config option LowDiskSpaceLimit=int - set to < zero to
	  disable, default is 5 (for default cfg) and as default value
	  if not in cfg.


2007-11-25 Halton Huo   <Halton.Huo@Sun.COM>

	Fix several problems for trackerd reload when changing preferences
	through t-p:
	1. Check/uncheck evolution email(maybe more) does not make
	   trackerd restart
	2. Trackerd restart will report another trackerd is running.
	3. Key for BatteryIndex BatteryIndexInitial and FastMerges does
	   not initialized t-p GUI.
	* src/tracker-preferences/Makefile.am: Add TRACKER_BINDIR
	* src/tracker-preferences/tracker-preferences.c:
	(spin_value_changed_cb), (check_toggled_cb), (setup_page_general),
	(setup_page_performance), (setup_page_files), (name_owner_changed),
	(cmdClose_Clicked):
	* src/trackerd/tracker-dbus-methods.c:
	(tracker_dbus_method_set_bool_option): Add some bool option here.
	(tracker_dbus_method_set_int_option): Add some int option here.


2007-11-24 Michael Biebl <mbiebl at gmail com>

	* filters/*/*_filter:
	Fix the shell scripts for the external filters
	- Use mktemp to create safe temp files.
	- Make all scripts respect the TMPDIR environment variable.
	- Remove unnecessary output to stdout.
	- Change the working directory of the msword filter before calling
	  wvText to avoid creating temporary files in $HOME.


2007-11-23  Saleem Abdulrasool  <compnerd@compnerd.org>

	* src/tracker-preferences/tracker-preferences.glade:
	Add accessibility tags for lists in tracker-preferences (bug #495201).  Patch
	from Patrick Wade.  Also add accessibility tags for throttling (bug #195188),
	patch again by Patrick Wade.


2007-11-19 Marcus Fritzsch <m at fritschy dot de>

	* python/deskbar-handler/tracker-{handler,module}.py
	  Fixed KMail identifier to the correct value
	* Updated docs/trackerd.1 and docs/tracker.cfg.5


2007-11-18 Jamie McCracken <jamiemcc at gnome org>

	* Added Get Hit Count call to libtracker
	* Fixed GetServices call
	* Added KeywordAdded and KeywordRemoved signals


2007-11-18 Laurent Aguerreche <laurent.aguerreche at free fr>

	* Read some keys from tracker.cfg file:
	  - BatteryIndexInitial, BatteryIndexInitial,
	  - MaxBucketCount, MinBucketCount, BucketRatio, Divisions
	  - Padding (but not used anywhere in tracker's code...)


2007-11-17 Jamie McCracken <jamiemcc at gnome org>

	* implemented power management options
	* fixed bug with embedded Auth in IMAP URI


2007-11-16 Marcus Fritzsch <m at fritschy dot de>

	* python/deskbar-handler/tracker-module.py
	  fixed URI quoting issues reported as bug #495512
	* src/trackerd/tracker-dbus-search.c
	  additional error check, fixes bug #495810


2007-11-13 Jamie McCracken <jamiemcc at gnome org>

	* Added confirmation dialog to prefs when it needs to be restarted or reindexed
	* fixed error msg when stopwords are passed for searching


2007-11-11 Patch from	Tshepang Lekhonkhobe <tshepang@gmail.com>

	* updated README file
	* fix for configure.ac (libglade not needed for tst)


2007-11-11 Patch from Wendy Hu <Huiwe.Hu@Sun.COM>

	* extract keywords from html
	* fix metadata child relationships


2007-11-11 Jamie McCracken <jamiemcc at gnome org>

	* Added more widgets to tracker-preferences for power management and fast index merges
	* Made throttle and most of the checkboxes change settings in trackerd in real time (without needing to restart trackerd)
	* Fixed deletion of entries


2007-11-09 Saleem Abdulrasool  <compnerd@compnerd.org>

	* src/tracker-preferences/tracker-configuration.c:
	(_g_utf8_make_valid), (g_key_file_parse_value_as_double),
	(g_key_file_get_double), (g_key_file_set_double),
	(g_key_file_get_double_list), (g_key_file_set_double_list),
	(get_default_language_code), (create_config_file),
	(tracker_configuration_init), (tracker_configuration_get_list),
	(string_replace), (_write), (_set_string), (_get_string_list),
	(_set_string_list):
	* src/tracker-preferences/tracker-configuration.h:
	* src/tracker-preferences/tracker-preferences-main.c: (main):
	* src/tracker-preferences/tracker-preferences-utils.h:
	* src/tracker-preferences/tracker-preferences.c:
	(tracker_preferences_init), (setup_page_general),
	(setup_page_performance), (setup_page_files), (setup_page_emails),
	(name_owner_changed), (if_trackerd_start), (cmdClose_Clicked),
	(cmdAddCrawledPath_Clicked), (cmdAddIndexPath_Clicked),
	(append_item_to_list), (treeview_get_values), (populate_list):
	* src/tracker-preferences/tracker-preferences.glade:
	* src/tracker-preferences/tracker-preferences.h:

	Run indent on the configuration tool, and fix the init to hide the help
	button properly.  Edit the preferences layout slightly to arrange the
	tabs in order of usefulness and simplify the email tab.


2007-11-06 Saleem Abdulrasool  <compnerd@compnerd.org>

	* src/tracker-applet/tracker-applet-private.h:
	* src/tracker-applet/tracker-applet.c: (tray_icon_class_init),
	(tray_icon_set_tooltip):
	* src/tracker-applet/tracker-applet.h:

	Drop set_tooltip, there is no reason for this to be a virtual function.


2007-11-05 Laurent Aguerreche <laurent.aguerreche at free fr>

	* Fix infinite loops while indexing in directories containing a single quote in their name
	* Fix "merging of indexes" messages which appear again, and again, and again, etc.


2007-11-04 Patch from Halton Huo   <Halton.Huo@Sun.COM>

	* Added shutdown and restart of trackerd to refresh config settings to tracker-preferences


2007-11-03 Jamie McCracken <jamiemcc at gnome org>

	* made corruption scan active only if trackerd was not cleanly shutdown
	* also repair qdbm index files
	* mutex safeguards around cache
	* allow readonly mode for trackerd when another process is present but on another machine (NFS)
	* bomb out trackerd if not primary owner of tracker dbus name
	* made use of sqlite3_free where needed to by sqlite 3.5


2007-10-31  Saleem Abdulrasool  <compnerd@compnerd.org>
	Patch from Bruce Cowan <bugs@bcowan.fastmail.co.uk>
	Fix spelling error 'occured' -> 'occurred'.  Bug #481651.

	* src/libtracker/tracker-files.c: (main):
	* src/libtracker/tracker-get-meta-for-folder.c: (main):
	* src/libtracker/tracker-query.c: (main):
	* src/libtracker/tracker-stats.c: (main):
	* src/tracker-search-tool/tracker-search-tool.c:
	(display_error_dialog):


2007-10-31 Michael Biebl <mbiebl at gmail com>

	* Merge tracker-inotify.h, tracker-fam.h and tracker-win-fs-changes.h
	into a single file called tracker-watch.h.
	* Remove redundant declarations of the tracker watch functions from
	tracker-db-sqlite.h.
	* Extract the poll implementation of the watch functions from
	trackerd.c into a new file called tracker-poll.c.
	* Update files to #include "tracker-watch.h".
	* Update Makefile.am to build the correct file monitoring backend.
	Drop removed files like tracker-inotify.h, tracker-fam.h,
	tracker-win-fs-changes.h and add tracker-watch.h to trackerd_SOURCES.


2007-10-31 Michal Pryc <michal dot pryc at sun dot com>

	* extensions/thunderbird-extension/content/trackerMailWindow.xul:
	Fixes opening proper mail within Thunderbird.
	* extensions/thunderbird-extension/tracker.xpi: new xpi with the applied patch.


2007-10-31  Patch from	Tshepang Lekhonkhobe <tshepang@gmail.com>

	* updated README file


2007-10-31 Patch from Thiago Marcos P. Santos <tmpsantos@gmail.com>

	* escape string in sql fix


2007-10-29 Jamie McCracken <jamiemcc at gnome org>

	* Check sqlite dbs for corruption on startup and force reindex if necessary
	* mem leak fix
	* improve debug of index creation failure
	* Fixed emails not being indexed if index has been stopped prior to completion of first run
	* reduce inotify max watch count by 500 to leave some spare for other apps
	* made sure only regular files get indexed
	* check dir is not watched before attmpting to watch it again
	* fixed hang when a directory is moved or renamed while indexing is going on


2007-10-20  Marcus Fritzsch <m at fritschy dot de>

	* tracker-extract, added support for application/x-gzpostscript files

2007-10-19  Marcus Fritzsch <m at fritschy dot de>

	* deskbar handlers, Fixed gnome bugs #487444, #486733
	* added some more exception catchers, in general where actions
	  are executed

2007-10-15 Patch from Halton Huo   <Halton.Huo@Sun.COM>

	* fixed crasher on solaris

2007-10-09  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-applet/tracker-applet.c: (create_context_menu):
	Mark strings in rigth click menu translatable and fix
	capitalization and ellipsizing as per GNOME HIG.

2007-10-09 Jamie McCracken <jamiemcc at gnome org>

	* Fixed deletions of words from index


2007-10-08 Jamie McCracken <jamiemcc at gnome org>

	* Fixed applet so that progress and pause options work
	* Implemented fast_merges option
	* Fixes to remove dud hits so a research corrects wrong hit counts
	* Cause tracker to die and delete indexes when corruption is detected
	* Check for overlapping watch dirs
	* Correct email folders count in applet progress
	* TST - display warning when searching while indexing
	* TST - ellipsize first column in search results


2007-10-07  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-preferences/tracker-preferences.desktop.in.in:
	Change the name of capplet launcher, to remove "Preferences"

2007-10-06 Jamie McCracken <jamiemcc at gnome org>

	* Renamed and rephrased tracker-applet source
	* Removed unneeded stuff and merged source files in the applet
	* Made the applet statistics window live and self updating every 2 seconds
	* Integrated signal handlers for state changed, progress and IndexFinsihed into applet
	* Made more translatable strings in applet


2007-10-04 Jamie McCracken <jamiemcc at gnome org>

	* Added in_merge to StateChangeSignal
	* Fixed crasher when merging indexes


2007-10-01 Jamie McCracken <jamiemcc at gnome org>

	* Made battery and pause checks tickless
	* Added signals for index progress ans state changes
	* added dbus methods for setting options and shutdown/reindex
	* renamed tracker-monitor to tracker-applet


2007-10-01 Laurent Aguerreche <laurent.aguerreche at free fr>

	* Make index statistic window a little bit sexier


2007-09-30 Laurent Aguerreche <laurent.aguerreche at free fr>

	* Cleanups for KMail and Thunderbird code
	* KMail emails are indexed but not removed when user move one to trash


2007-09-29 Patch from Wendy Hu

	* Fixed missing category from tst search


2007-09-27 Mikkel Kamstrup Erlandsen   <mikkel.kamstrup@gmail.com>

	* Richer display of hits in deskbar module
	  This was intended all along, but broke with DBA 2.20.


2007-09-27 Jamie McCracken <jamiemcc at gnome org>

	* Added intial tracker-monitor notification applet
	* fixed excessive busy count issue


2007-09-25 Patch from Halton Huo   <Halton.Huo@Sun.COM>

	* Enable search of words beginning with a number


2007-09-24 Laurent Aguerreche <laurent.aguerreche at free fr>

	* KMail emails are not indexed twice anymore because date of indexing is now checked...
	* Some work need to be done to update infos of a maildir email when needed
	* In tracker.h, prefer G_BEGIN_DECLS/G_END_DECLS than direct use of extern "C"
	* Remove some warnings in libtracker-gtk


2007-09-23 Jamie McCracken <jamiemcc at gnome org>

	* Fixed memory leaks
	* Optomised index merging
	* Fixed and tuned battery checking
	* Fixed bug on file read where partial utf-8 crept through
	* Fixed CJK check
	* Replaced GSList based cache with byteArray

2007-09-22 Jamie McCracken <jamiemcc at gnome org>

	* Added index merging
	* Fixed disk IO issues
	* Restored Qdbm as the main index
	* Fixed File move crasher


2007-09-13 Jamie McCracken <jamiemcc at gnome org>

	* Added automatic index pause on battery
	* Check files exist before including in search results
	* Fixed disabling of indexing option
	* Fixed bug where could not open files when O_NOATIME is not supported


2007-09-12 Jamie McCracken <jamiemcc at gnome org>

	* Added basic support for index merging


2007-09-12 Patch from 	Michal Pryc <Michal.Pryc@Sun.COM>

	* added initial thunderbird support (experimental and requires separate thunderbird-extension)
	* added solaris build fixes


2007-09-11 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Split legacy deskbar handler into two files, static and live.
	* Don't show static tracker search option when only live search is enabled
	  This fixes Gnome #474660.

	* Introduce support for MUAs Thunderbird and KMail in both
	  legacy and new deskbar handlers

	* Check that t-s-t is installed before showing static handler as available
	  extension. This closes Debian #441889.

	It should be noted that recent deskbar work has closed Gnome #474131 as well.

	Commited and approved by kamstrup.


2007-09-11 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Do not assume that gint32 or guint32 are gint or guint in tracker-db-sqlite.c


2007-09-10  Christian Persch  <chpe@gnome.org>

	* src/tracker-preferences/tracker-preferences.glade: Use the right
	capitalisations, and add/change some mnemonics. Bug #474339.


2007-09-10 Patch from Marko Anastasov  <marko@marko.anastasov.name>

	* Made tracker.h c++ friendly


2007-09-09 Jamie McCracken <jamiemcc at gnome org>

	* Improved memory usage
	* Optimised text filter reading io using posix_fadvise and O_NOATIME
	* Print out memory usage (linux only) when flushing words


2007-09-08 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Try to use O_NOATIME everywhere is possible in tracker-extract
	* Use O_NOATIME to open Evolution's summary files


2007-09-08 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Use O_NOATIME mode to read emails with GMime


2007-09-07  Patch from Christian Persch

	* Fixed HIG violations in tracker-preferences


2007-09-07 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Remove some useless calls to g_slist_length()
	* Use g_slice_new/free() for SearchQuery and SearchWord
	* Split things like g_return_if_fail(item1 && item2) into:
	  g_return_if_fail(item1);
	  g_return_if_fail(item2);
	  in tracker-indexer.c and tracker-dbus-search.c


2007-09-06 Jamie McCracken <jamiemcc at gnome org>

	* Added initial support for index merging
	* Made sure stats no longer reset
	* Fixed runaway memory usage of sqlite in indexer


2007-09-04 Jamie McCracken <jamiemcc at gnome org>

	* removed qdbm completly
	* replaced with sqlite indexer
	* split up files/emails into separate dbs (meta, content and index)
	* tuned caching
	* tuned indexer to pause when non-tracker disk activity is detected
	* made email indexing 5x faster and lessened iowait times
	* Improved parser
	* Fixed restore of user metadata on reindex (keywords are auto-restored)
	* added source code reserved words to english stopwords
	* added english stopwords on top of non-english stopword lists


2007-09-03 Mikkel Kamstrup Erlandsen <mikkel.kamstrup@mail.com>

	* python/deskbar-handler/tracker-module.py
	  Add additional standard actions

2007-09-03 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Work on KMail support
	* Support of MBox files seems to work well. So indexing works when MBox
	  storage is used with local emails (= sent + POP3 emails) and IMAP emails
	  (but not cached-IMAP emails since they are always stored in a maildir
	  hierarchy)
	* Still issues with mails in maildir directories (trackerd try to index those
	  emails twice!)
	* Indexing of KMail emails is still turned off


2007-09-03 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Make TST able to open KMail emails


2007-08-19 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Added option to skip mounted directories when indexing
	* added safeguards to html and imagemagick extractors to prevent crashers
	* added safeguard to app indexing


2007-08-19 Michael Biebl <mbiebl at gmail com>

	* Fixed gettext support in deskbar-applet plugin
	* Update autofoo to automatically install the correct version of the
	  deskbar-applet plugin.
	  Can be overriden with --enable-deskbar-applet=(handler|module)
	  "handler" is for deskbar-applet < 2.19
	  "module" is for deskbar-applet >= 2.19


2007-08-19 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Reorganization of tracker-handler.py
	* Added support for GaimConversations and Applications
	* Fixed gnome bugs: #403752, #359307
	* Fixed ubuntu bugs: #131247, #130889
	* New deskbar-applet 2.19 module tracker-module.py, fixes ubuntu bug #132921
	* Fixed emails categorization
	* Better display of GaimConversations hits


2007-08-13 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Fix bug #131842 from Ubuntu


2007-08-13 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Replace "g_slist_length(list)>0" with "list!=NULL" to check
	whether a list is empty or not in trackerd.c
	* Cosmetic changes in trackerd.c


2007-08-12 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Escape filenames containing character "'" to make xdg_open()
	working with them


2007-08-11 Jamie McCracken <jamiemcc at gnome org>

	* Put back alarm call to tracker spawn as safeguard


2007-08-10 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Fixed bug #465176 (IMAP e-mail indexing does not work after first
	crawl)
	* Code cleanups in tracker-db-email.{h,c}


2007-08-09 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Remove an error message while loading file sqlite-stored-procs.sql
	due to bad checking of returned value of fgets()


2007-08-09 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Close feature request #397210 (Desensitize Find button when search
	entry is empty)
	* Remove warnings at building time in TST
	* Code cleanups in TST


2007-08-09 Michael Biebl <mbiebl at gmail com>

	* Add missing function prototype definitions


2007-08-07 Jamie McCracken <jamiemcc at gnome org>

	* Fixed memory leaks
	* Fixed crasher due to non valid utf-8 creeping through emails


2007-08-07 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Remove some warnings at building of tracker-extract
	* Adds more recognized date formats for Postscript files in
	tracker-extract
	* Code cleanups in tracker-extract


2007-08-07 Michael Biebl <mbiebl at gmail com>

	* Generate the D-Bus client-side bindings automatically from the
	introspection XML file


2007-08-06 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Adds copyright headers in tracker-preferences' files
	* Remove some code duplications in tracker-configuration.c
	* Code cleanups in tracker-preferences


2007-08-05  Marko Anastasov  <marko@marko.anastasov.name>

	* Implemented tracker_dbus_method_search_get_hit_count.


2007-08-04 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* fixed crasher in email indexing when parsing mimes
	* updated applet
	* added tracker-preferences man page


2007-08-04 Patch from Anders Rune Jensen <anders@iola.dk>

	* Made tracker compilable on windows


2007-08-02 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Made generic error display window
	* fixed crasher in tsts - added check for error when calculating hit count


2007-07-29 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Makes tracker-extract to export dates only in ISO-8601 format
	* Fixed dates for emails
	* cosmetic changes


2007-07-29 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Removed small chunk of whitespace from being parsed into indexer


2007-07-26 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Fixed printing of date for audio files in TST


2007-07-25 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* updated applet to 0.6.0 settings
	* fixed crasher and made read tags case insensitive for html extractor


2007-07-25 Jamie McCracken <jamiemcc at gnome org>

	* Based on patch by Marcus Fritzsch <fritschy@googlemail.com>
	* Fixed crawled directory indexing when they are not a subset of watched directories
	* Removed forced indexing of home dir when no watch dirs specified (home is default in cfg file)


2007-07-24 Michael Biebl <mbiebl at gmail com>

	* Include the deskbar-applet plugin on make dist
	* Show if deskbar-applet support is enabled in the ./configure summary


2007-07-18 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Fixed command line tracker-tag


2007-07-23 Jamie McCracken <jamiemcc at gnome org>

	* Fixed metadata dates display
	* Revamped tracker-preferences
	* added missing prefs
	* fixed bug with additional growing lines


2007-07-22 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* fixed service names on command line tools
	* updated man pages


2007-07-22 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Fixed potential crasher in tracker_set_language() function
	* Cosmetic changes


2007-07-22 Jamie McCracken <jamiemcc at gnome org>

	* Fixed deleting of no watch dirs from index
	* Fixed date formats
	* Added Crawl directory support (indexing without watching)
	* Added missing filters for csv, excel, spreadsheets (requires ssindex/gnumeric) and oo draw


2007-07-22 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Not-named email attachments are not ignored anymore
	* Fixed removing of saved email attachments from spam emails in Tracker's TMP dir
	* Fixed message "saved email attachment..."
	* Added "tracker->email_attachements_dir" variable
	* Added email_make_tmp_name_for_mail_attachment() function
	* Added tracker_is_empty_string() function
	* Fixed SEGFAULT when SIGTERM is sent to Tracker while emails are being indexed
	* Fixed heuristics to detect a text file
	* Fixed calls to pango_get_log_attrs()
	* Unified error messages formats


2007-07-21 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* updated man pages


2007-07-21 Jamie McCracken <jamiemcc at gnome org>

	* Fixed origin of initial sleep in tracker-prefs - based on patch by Tshepang Lekhonkhobe
	* Fixed resetting icon in metatile
	* Always made sure an icon is available in tst
	* Fixed launch of applications (filtered out %U)


2007-07-18 Jamie McCracken <jamiemcc at gnome org>

	* Fixed crasher in tst
	* Fixed tagging
	* created config file if not present when running tracker-prefs


2007-07-18 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Added initial sleep to tracker-prefs
	* fixed email setting too


2007-07-17 Patch from Alexandre Rostovtsev <tetromino@gmail.com>

	* Fixed poppler extractor
	* Fix for AMD64 setrlimit


2007-07-17 Patch from Andreas Eckstein <andreas.eckstein@gmx.net>

	* Made tracker.h more c++ compatible


2007-07-17 Jamie McCracken <jamiemcc at gnome org>

	* Queued snippets for generation to prevent delays
	* Made all tracker calls async
	* Gconf settings for separator position
	* Fixed bug in tagbar where instruction text would be saved as keywords


2007-07-17 Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Fixed build of TST
	* Some cleanups in libtracker-gtk


2007-07-17 Patch from Tshepang Lekhonkhobe <tshepang@gmail.com>

	* updated README
 	* fixed xdg-open order


2007-07-17 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Added MaxTextWords limit to config
	* small compiler warning fixes


2007-07-17 Jamie McCracken <jamiemcc at gnome org>

	* Fixed metadata tile to display for all cats
	* Fixed TST to display all cats
	* Fixed various bugs for the above



2007-07-15 Patch from Marcus Fritzsch <fritschy at googlemail com>

	* Fixed mem leak and some cleanups
	* added initial sleep config variable


2007-07-13  Patch from Luca Ferretti  <elle.uca@libero.it>

	* cosmetic changes to tst


2007-07-13 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Fixed build for Sun compiler


2007-07-13 Jamie McCracken <jamiemcc at gnome org>

	* Replaced tabs in GUI with a sidebar
	* Fixed update of metadata tile when navigating with keys instead of mouse
	* Used theme text colours for snippets


2007-07-12 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Added NULL to terminate some string arrays in tracker-metadata-tile.c


2007-07-10 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Added GetStatus Dbus nmethod and tracker-status app


2007-07-10  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-search-tool/tracker-search-tool.c: (do_search):
	show GtkNotebook labels translated


2007-07-09 Patch from Halton Huo   <Halton.Huo@Sun.COM>

	* Fixed various crashers (solaris specific only)


2007-07-09  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-search-tool/tracker-search-tool.desktop.in.in:
	mark Name and Comment as translatable

	* trackerd.desktop.in.in: update Comment


2007-07-09 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Fixed crasher on solaris for null mimes


2007-07-09 Patch from Michael Biebl <mbiebl at gmail com>

	* Removed test-tracker-indexer
	* small fix to Makefile

2007-07-09  Luca Ferretti  <elle.uca@libero.it>

	* src/trackerd/trackerd.c: (main): inizialize g_thread earlier

2007-07-09 Patch from Tshepang Lekhonkhobe <tshepang@gmail.com>

	* README: updates
	* Low Memory mode added to config file
	* Deskbar handler README


2007-07-09 Jamie McCracken <jamiemcc at gnome org>

	* Optimized tracker_debug and related logging funcs
	* Made use of Setrlimit for limiting memory specific to i386 arch (its buggy on amd64)
	* updated to latest gtk xdgmime
	* modded patch from Halton Huo to fix free problem in tracker_get_vfs_name
	* bug fixes for email indeixng on solaris
	* Fixed saving of key metadata so they show up in search tool and UI


2007-07-09 Patch from Jason Kivlighn <jkivlighn@gmail.com>

	* Added XMP sidecar support
	* Added XMP support to extractors


2007-07-07 Jamie McCracken <jamiemcc at gnome org>

	* Added tracker_unlink that converts to filesystem locale before unlinking
	* fixed crasher in email attachment indexing by using locale encoding for attachemnt files



2007-07-04 Jamie McCracken <jamiemcc at gnome org>

	* removed calls to g_mime_stream_close as they appear to be crashing tracker


2007-07-03  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-preferences/tracker-preferences.desktop.in.in:
	Add X-GNOME-Bugzilla-* stuff, remove .png from Icon key, set
	StartupNotify to true.

	NOTE: I can't access to bugzilla.gnome.org (??), so
	"X-GNOME-Bugzilla-Component=general" could be wrong.

2007-07-03  Luca Ferretti  <elle.uca@libero.it>

	* Makefile.am: really remove tracked.desktop on make clean
	and include trackerd.desktop.in on make dist

2007-07-03  Luca Ferretti  <elle.uca@libero.it>

	* configure.ac:
	* src/tracker-preferences/Makefile.am:
	* src/tracker-preferences/tracker-preferences.desktop.in:
	* src/tracker-preferences/tracker-preferences.desktop.in.in:
	* src/tracker-search-tool/tracker-search-tool.desktop.in:
	* src/tracker-search-tool/tracker-search-tool.desktop.in.in:

	Cleanup .desktop files generation for tracker-search-tool and
	tracker-preferences, just like trackerd. Now, configure generates
	.desktop.in from .desktop.in.in replacing @VERSION@ variable, then
	make generate .desktop from .desktop.in adding translations for
	Name and Comment keys.

	Besides, make clean remove .desktop files and make dist includes
	.desktop.in in released packages. Or, at least, this is the
	desider behavior...

2007-07-03  Luca Ferretti  <elle.uca@libero.it>

	* Makefile.am: add CLEANFILE to remove tracked.desktop
	on "clean" rule

2007-07-02  Luca Ferretti  <elle.uca@libero.it>

	* data/icons/Makefile.am: run gtk-update-icon-cache on
	install-hook and uninstall-hook.
	See http://live.gnome.org/GnomeGoals/AppIcon

2007-07-02  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-preferences/Makefile.am:
	Add -DTRACKER_LOCALEDIR in INCLUDES

	* src/tracker-preferences/tracker-preferences-main.c: (main):
	Enable localization at runtime.

2007-07-02  Luca Ferretti  <elle.uca@libero.it>

	* Makefile.am:
	* configure.ac:
	Enable localization for trackerd.desktop file. It's useful for
	gnome-session-properties 2.19/2.20. I'm not sure 'make dist'
	will include the right files :-(

	* trackerd.desktop.in: moved...
	* trackerd.desktop.in.in: ...here, plus changes to
	enable translations and removal of spurious fr translation.

2007-06-30 Patch from Jason Kivlighn <jkivlighn@gmail.com>

	* Added initial XMP support for images to tracker-extract



2007-06-30 Patch from Michael Biebl <mbiebl at gmail com>

	* fixed typo and removed redundant stuff from configure.ac
	* moved qdbm into private lib and added option to use system version


2007-06-30 Patch from Eric Lesh <eclesh@ucla.edu>

	* Fixed date display when date is missing in the metadata tile


2007-06-30 Patch from Laurent Aguerreche <laurent.aguerreche@free.fr>

	* Evolution mail fixes
	* fix bad parsing of summary file
	* used g_slice
	* fixed mime type of attachments


2007-06-30 Patch from B Berteh <berteh@hotmail.com>

	* Downgraded gtk and glade requirements
	* Added missing functions for those with gtk 2.10


2007-06-30 Patch from Marcus Fritzsch <fritschy@googlemail.com>

	* Fixed invalid double free in tracker-extract
	* made sure time elapsed returns floating point value


2007-06-30 Patch from Jerry Tan <Jerry.Tan@Sun.COM>

	* Fixed crasher in image extractor
	* fixed coredump in ps extractor on solaris


2007-06-30 Patch from asubedi <asubedi@gmail.com>

	* Added djvu filter


2007-06-30 Patch from Deji Akingunola <dakingun@gmail.com>

	* Added OnlyShowIn to desktop file
	* Added missing config var in configure.ac
2007-04-28 Tshepang Lekhonkhobe <tshepang@gmail.com>

       * src/trackerd/trackerd.c:
       * src/trackerd/trackerd-utils.c: Fix verbosity code
       * README: added a note on how to change inotify limits

2007-06-30 Patch from Anders Rune Jensen <anders@iola.dk>

	* Fixed crasher when getting metadata


2007-06-30 Patch from Luca Bellonda <lbellonda@gmail.com>

	* added use of ~ and realpath for all config filename based variables

2007-06-30 Patch from Tshepang Lekhonkhobe <tshepang@gmail.com>

	* updated README and ToDo


2007-06-06 Jamie McCracken <jamiemcc at gnome org>

	* Reworked ranking and hit selection
	* Added support for And/Or
	* Added IDF (inverse document frequency) ranking for multiple word searches
	* added preliminary support for wildcards (not fully operational yet)


2007-06-06  Mikkel Kamstrup Erlandsen  <mikkel.kamstrup@gmail.com>

	* python/deskbar-handler/tracker-handler.py:
	Fix bug 430252, crash on conversion to ascii.

2007-05-26  Claude Paroz  <claude@2xlibre.net>

	* src/tracker-preferences/tracker-preferences.glade: Corrected typo.

2007-05-07 Jamie McCracken <jamiemcc at gnome org>

	* bug fix for crashers in gaim indexing
	* fixed get metadata method to return original data

2007-05-05 Jamie McCracken <jamiemcc at gnome org>

	*Added application and gaim log indexing
	* application indexing based on patch by Marcus Rosell

2007-04-30 Jamie McCracken <jamiemcc at gnome org>

	* fixed reset of stats on reindex
	* removed libmagic from build

2007-05-01 patch from Michael Biebl <mbiebl at gmail com>

	* updated po/linguas

2007-05-01  Patch from Bjoern Gruening <bjoern at gruenings eu>

	* updated tracker-preferences to use XDG config location


2007-04-30 Jamie McCracken <jamiemcc at gnome org>

	* Reverted to using multiple db connections over one virtual (virtual is 3x slower)
	* Got stats working
	* renabled backup of user defined metadata
	* fixed crashers in email indexing
	* fixed too many open file descriptors by closing them


2007-04-28 Tshepang Lekhonkhobe <tshepang@gmail.com>

       * src/trackerd/trackerd.c:
       * src/trackerd/trackerd-utils.c: Fix verbosity code
       * README: added a note on how to change inotify limits

2007-04-27 Jamie McCracken <jamiemcc at gnome org>

	* Restructured Database to be more extensible
	* Made use of triggers in sqlite
	* Cleaned and restructured code to be more extensible and make use of new DB structure
	* Moved Metadata and Services to desktop files
	* Backed all user defined data so that they can be restored on reindex
	* Added --reindex param to trackerd
	* Moved all database files to XDG dirs
	* Separated expendable embedded data (in $Home/.cache) from user defined ones (in $HOME/.local/share/tracker/data)
	* Imporved stat collation
	* make process thread do the watching for fast startup
	* added 5 second delay prior to watch/index so as not to slow down boot time
	* Removed libmagic support
	* Fixed file move issues
	* Default Verbosity is to output almost nothing so as not to pollute xsession-errors
	* Fixed bugs in Dbus interfaces
	* Fixed bugs/crashes during indexing
	* Fixed bug whereby directories exceeding the max number of watches would not be indexed (also fixed/applicable to NFS mounts)
	* Fixed email attachment indexing
	* Improved text parsing



2007-04-05  Edward Duffy <eduffy@gmail.com>

	* src/tracker-search-tool/tracker-search-tool.c:
   "xalign" property given an int, instead of float.
      Thanks to Jay Langseth for point this out.

2007-03-23  Wouter Bolsterlee  <wbolster@svn.gnome.org>

	reviewed by: Jamie McCracken

	* src/tracker-search-tool/tracker-search-tool-callbacks.c:
	(show_file_selector_cb):

	Default to $HOME for saved searches. Fixes bug #421535.

2007-03-15 Pema Geyleg <pema.geyleg@gmail.com>

	* configure.ac: Added 'dz' to ALL_LINGUAS

2007-03-11  Edward Duffy <eduffy@gmail.com>

	* src/tracker-extract/tracker-extract-imagemagick.c:
	Don't send '-ping' to GIMP xcf files (#416905)

2007-03-08  Jamie McCracken <jamiemcc at gnome org>

	* Revamped parsing of text
	* Now uses pango automatically for CJK texts
	* Added optional accent stripper

2007-03-08 patch from Michael Biebl <mbiebl at gmail com>

	* Added new icons
	* Removed old and installed in correct places for themes

2007-03-07  Edward Duffy <eduffy@gmail.com>

	* src/tracker-extract/tracker-extract-imagemagick.c:
	Check exit code of 'identify'

2007-03-07  Josep Puigdemont i Casamajó  <josep.puigdemont@gmail.com>

	* configure.ac: Added "ca" to ALL_LINGUAS.


2007-03-06  Mikkel Kamstrup Erlandsen <kamstrup@cvs.gnome.org>

	* python/deskbar-handler/tracker-handler.py:
	Check that Tracker is available via dbus activation or don't mark the handler
	as available.

2007-03-05  Edward Duffy <eduffy@gmail.com>

	* src/trackerd/tracker-dbus-search.c:
	* src/tracker-search-tool/tracker-search-tool.c:
	Added tracker_dbus_method_search_suggest and support in the GUI

2007-03-04  Jamie McCracken <jamiemcc at gnome org>

	* Removed polling functionality
	* Startup checks now include test for deletions in dirs that have changed
	* Index directories bottom up so indexing resumes from where it left off if stopped
	* made sure tmp dir and /proc and /dev are not indexed


2007-03-04  Mikkel Kamstrup Erlandsen <kamstrup@cvs.gnome.org>

	* python/deskbar-handler/tracker-handler.py:
	Work around dependency for deskbar 2.18. We can do with 2.16 now (hopefully).

2007-03-03  Edward Duffy  <eduffy@gmail.com>

	* src/tracker-search-tool/tracker-search-tool.c:
	Preserve search terms when switching tabs (#399022)

2007-03-03  Edward Duffy  <eduffy@gmail.com>

	* configure.ac:
	* trackerd.desktop.in:
	* src/tracker-search-tool.desktop.in:
	Add X-GNOME-Bugzilla-* keys to the .desktop files (#407348)

2007-03-03  Edward Duffy  <eduffy@gmail.com>

	* src/trackerd/tracker-db-sqlite.c:
	Fix tracker_db_get_files_by_mime (#409729)

2007-03-03  Patch from jerry tan <jerry.tan at sun com>

	* Replaced stdout with tmp_stdout so it compiles under solaris


2007-03-03  Patch from Neil Patel <njpatel at gmail com>

	* Fixed drag and drop of an email create a desktop file
	* Fixed crasher with tile

2007-03-03  Edward Duffy  <eduffy@gmail.com>

	* src/tracker--search-tool/tracker-search-tool.c:
	Update metadata tile when tabs change.
	Closes #413971

	* inotify limit now uses system setting


2007-03-03  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-search-tool/tracker-search-tool.c:
	(update_page_count_label):
	Fix some HIG, i18n and icon issue in Tracker search too.
	See bug #412255 for details.

2007-03-02  Mikkel Kamstrup Erlandsen <kamstrup at cvs gnome org>

	* Add email support to deskbar handler

2007-03-01  Patch from Neil Patel <njpatel at gmail com>

	* Made drag and drop of an email create a desktop file
	* desktop file launches evolution with correct uri.
	* made thumbs bigger in tile

2007-03-01  Jamie McCracken <jamiemcc at gnome org>

	* Made configure auto build stuff like libtracker-gtk if dependencies are met
	* changed --enable-preferences to --disable-preferences


2007-03-01 patch from Michael Biebl <mbiebl at gmail com>

	* Cleaned up libtracker-gtk with John Stowers
	* removed optional dependency on libtracker-gtk for tst
	* added localisation

2007-03-01 patch from John Stowers <john.stowers@gmail.com>

	* Add libtracker-gtk


2007-02-28  Jamie McCracken <jamiemcc at gnome org>

	* Removed superflous subfolders from imap uri


2007-02-28  Patch from Tshepang Lekhonkhobe <tshepang@gmail.com>

	* Patch for README file


2007-02-28 Patch from Anders Rune Jensen <anders@iola.dk>

	*  Fix mem leak in Fam handler


2007-02-28 Patch from Michael Biebl <mbiebl at gmail com>

	* added realpath support to thumbnailer


2007-02-26  Jamie McCracken <jamiemcc at gnome org>

	* Fixed email issues
	* Now handles deleted and junk emails (these are removed when trackerd is next started)
	* Fixed bugs with text Files not being detected


2007-02-26  Luca Ferretti  <elle.uca@libero.it>

	* src/trackerd/trackerd.c:
	Use "VALUE" not "value" in --help for -t and -v explanation
	as any other option

2007-02-18  Jamie McCracken <jamiemcc at gnome org>

	* made sure we call gmime_stream_close before unreffing to release file descriptors
	* a few memory leaks plugged

2007-02-13  Patch from Tshepang Lekhonkhobe <tshepang@gmail.com>

	* tracker.cfg: replaced the unused EnableDebugLogging entry with Verbosity
	* remove unnecessary checks for tracker->verbosity
	* some spelling corrections and other minor changes
	* lowered tracker-preferences' GTK+2.0 version requirement from 2.10 to 2.8
	* README fixes

2007-02-12 Patch from Gergan Penkov <gergan at gmail com>

	* Added missing function prototype


2007-02-12  Jamie McCracken <jamiemcc at gnome org>

	* lots of bug fixes to get imap email support functional


2007-02-11  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-preferences/tracker-preferences.c:
	(tracker_preferences_init):
	Fix the glade name of buttonbox area.

2007-02-10  Jamie McCracken <jamiemcc at gnome org>

	* finished adding evolution email support
	* added revamped tab interface to tracker-search-tool
	* added email searching support to tst
	* added new methods to get hit counts by service
	* added cropping to tst display
	* split up sql scripts
	* added evolution display of emails in tst


2007-02-10  Patch from Saleem Abdulrasool <compnerd at gentoo org>

	* Added preferences capplet


2007-01-29  Jamie McCracken <jamiemcc at gnome org>

	* fixed bug for service types
	* fixed mplayer bug with audio/video.Duration


2007-01-28  Jamie McCracken <jamiemcc at gnome org>

	* fixed bug where moving a file would not update index of the new filename
	* made some of the db data static


2007-01-28 Patch from Michael Biebl <mbiebl at gmail com>

	* removed python header from deskbar module
	* changed Max results to 10


2007-01-28  Patch from Laurent Aguerreche <laurent aguerreche at free fr>

	* email fixes
	* improved imap4 support
	* memory leak fix in indexer

2007-01-27  Patch from Saleem Abdulrasool <compnerd at gentoo org>

	* Made deskbar-handler installation optional

2007-01-27  Nickolay V. Shmyrev  <nshmyrev@yandex.ru>

	* configure.ac: added ru to ALL_LINGUAS.

2007-01-25  Jamie McCracken <jamiemcc at gnome org>

	* fixed update of embedded keywords
	* added deskbar handler to tarball and installation
	* updated man page for trackerd

2007-01-24 Patch from Michael Biebl <mbiebl at gmail com>

	* converted xdgmime to private lib

2007-01-24  Jamie McCracken <jamiemcc at gnome org>

	* Added magic.h to check_headers in configure.ac
	* Created tracker_info and tracker_debug and replaced all the g_log functions that were polluting xsession-errors


2007-01-23  Jamie McCracken <jamiemcc at gnome org>

	* Improved message display
	* Made sure all external stuff is fully protected from excessive memory/cpu
	* Repaired mplayer backend and make it used when gstreamer returns nothing
	* Added libmagic for extra mime checks


2007-01-22 Patch from Michael Biebl <mbiebl at gmail com>

	* Fix to get test suite built


2007-01-22  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-stats.c:

	Port tracker-stats to GOption and mark translatable strings.
	Fix bug 397940.

2007-01-21 Patch from Daniel Fullmer <cgibreak at gmail com>

	* fix for parallel make

2007-01-21 Patch from Michael Biebl <mbiebl at gmail com>

	* Updated License info
	* added LGPL Copying.Lib to libtracker


2007-01-21  Jamie McCracken <jamiemcc at gnome org>

	* Completed optimisation of indexing
	* Added a verbosity command line param
	* Made sure all indeixng occurs under a single transaction
	* removed superflous code


2007-01-21  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.ac: Added nb to ALL_LINGUAS.


2007-01-19  Jamie McCracken <jamiemcc at gnome org>

	* changed mmap back to shared as optimisation would destroy the index
	* made indexing super fast
	* smoothed out indexing so that it (virtually) never slows the system down
	* made default full throttle (turbo)
	* Added new high speed index flusher
	* Improved word descriminator


2007-01-14  Jamie McCracken <jamiemcc at gnome org>

	* added throttling param to control speed of indexing (--throttle)
	* adjusted default throttling so that cpu ~50% during heavy indexin
	* throttled tracker daemon at strategic points
	* removed erroneous cache word deletion when delete_directry
	* removed problem statement that was somehow deleting the cache db
	* Improved word breaker and fixed index roots not being indexed
	* changed shared mmap to private for qdbm to work on FUSE


2007-01-12 Patch from Michael Biebl <mbiebl at gmail com>

	* Fixed make distcheck
	* added bzip2 build
	* fix for configure.in -> configure.ac move


2007-01-12  Jamie McCracken <jamiemcc at gnome org>

	* Sped up word breaker and made it use less memory
	* Fixed bug where root dirs were not getting indexed properly
	* Added some sleeping to reduce stress on machine when heavily indexing


2007-01-11  Patch from Saleem Abdulrasool <compnerd at gentoo org>

	* Detect dbus service directory

2007-01-11 Patch from Michael Biebl <mbiebl at gmail com>

	* based on patch from Saleem Abdulrasool <compnerd at gentoo org>
	* removed mysql files
	* cleaned up build for sqlite

2007-01-10  B Berteh <berteh at hotmail com>

	* added README for deskbar handler and nautilus tags
	* remove temporary included image files left by wvText

2007-01-10  Jamie McCracken <jamiemcc at gnome org>

	* Merged all extraction into one thread to lessen queueing overhead
	* disabled some code in the emails section
	* added some more email db support routines
	* improved support for email attachments indexing

2007-01-10  Patch from Saleem Abdulrasool <compnerd at gentoo org>

	* Build fixes
	* fixed build of test suite
	* fixed --enable-debug-code configure arg
	* made libpng a mandatory dependency
	* added check for thumbnail directory and create it if necessary

2007-01-09  Ignacio Casal Quinteiro  <nacho.resa@gmail.com>

	* configure.in: Added 'gl' to ALL_LINGUAS.

2007-01-07  Tshepang Lekhonkhobe <tshepang@gmail.com>

	* README: Ensured all lines over 79 colums were reduced for readability
	* README: Added xdg-utils, libpng, libexif, and libgsf as dependencies
	* t-s-t: Added xdg-open to 'Open Folder' with a fallback to gnome-open

2007-01-07  Priit Laes  <plaes@svn.gnome.org>

	* configure.in: Added 'et' (Estonian) to LINGUAS.


2007-01-03  Tshepang Lekhonkhobe <tshepang@gmail.com>

	* Added a note on the reason why SQLite is statically-linked

2007-01-03 Laurent Aguerreche <laurent aguerreche at free fr>

	* improved email support
	* added imap support
	* linked in db email support

2007-01-02  Jamie McCracken <jamiemcc at gnome org>

	* Added new crawler to speed up indexing


2007-01-02  Matic Zgur <mr.zgur@gmail.com>

	* configure.in: Added sl to ALL_LINGUAS.


2007-01-01  Patch from Bjoern Gruening <bjoern at gruenings eu>

	* Added tex filter support

2007-01-01  Jamie McCracken <jamiemcc at gnome org>

	* Added db support for emails
	* added indexing support for emails
	* optimised metadata insertion

2007-01-01  David Lodge <dave@cirt.net>

	* configure.in: Added en_GB

2006-12-23  Jamie McCracken <jamiemcc at gnome org>

	* Added debug compile option
	* fixed memory leaks during indexing
	* Made Database changes to support new Metadata engine
	* Changed metadata to reflect RDF style (using colon instead of fullstop for class/metadata)
	* Added Dublin Core metadata
	* modified code to use new metadata names and also Dublin Core
	* added support for metadata relationships
	* made metadata support more than one value per item
	* made keywords use the new metadata engine.
	* changed keyword metadata to "DC:Keywords"
	* Applied some Dublin Core relationships to existing metadata
	* Made RDF QUery function with new metadata engine and also metadata relationships
	* Used file command to check to see if files are plain text or not
	* split filenames by hyphen and underscore so individual parts will show up in searches
	* index meaningful numbers (IE all numbers at least 5 digits long so searchers can now be done for things like telephone no.s, bank accounts, ISBN etc)
	* modified snippet to start/end on a word break if possible

2006-12-19  Francisco Javier F. Serrador  <serrador@openshine.com>

	* configure.in: Added 'es' to ALL_LINGUAS

2006-12-16  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-search-tool/tracker-search-tool.desktop.in:

	Update launcher description to match GNOME HIG.

2006-12-16  Luca Ferretti  <elle.uca@libero.it>

	* src/tracker-search-tool/tracker-search-tool.c:
	(update_search_counts), (update_constraint_info),
	(get_desktop_item_name):

	Comment out some unused strings from gnome-search-tool and
	change other "Search for Files" window title strings to
	"Tracker Search Tool". But those should be unused too.

	Now all strings marked as translatable should really appears
	in the GUI.

2006-12-14  Ilkka Tuohela <hile@iki.fi>

	* configure.in: Added 'fi' and 'sv' to ALL_LINGUAS

2006-12-03  Eugenio <me at eugesoftware com>

	* added a QT based search tool to python directory

2006-11-30  Luca Ferretti  <elle.uca@libero.it>

	* src/trackerd/trackerd.c:
	Add a missing : in --help message to match other tools.

2006-11-30  Luca Ferretti  <elle.uca@libero.it>

	* src/trackerd/trackerd.c:
	Change command line options and enable i18n. Fore more info
	about changes, see http://mail.gnome.org/archives/tracker-list/2006-November/msg00382.html

2006-11-29 Patch from Michael Biebl <mbiebl at gmail com>

	* cleaned up makefiles for debian compliance
	* removed debian subfolder from cvs
	* fixed make dist

2006-11-29  Jamie McCracken <jamiemcc at gnome org>

	* Cleaned up Makefiles
	* set executable scripts to libdir and not datadir
	* added missing license/copyright info to files


2006-11-27 Edward Duffy <eduffy at gmail com>

	* made thumbnailing fdo compliant

2006-11-27  Jamie McCracken <jamiemcc at gnome org>

	* fixed crasher in snippet generator and made it more utf-8 friendly

2006-11-26 Eugenio <me at eugesoftware com>

	* updated fuse based trackerdfs
	* omplete support for move/copy/create dir/file

2006-11-26 Gergan Penkov <gergan at gmail com>

	* Updated configure.in to support more distro firendly options

2006-11-21  Deji Akingunola <dakingun gmail com>

	* removed extra trackerd.desktop file
	* fixed t-s-t desktop file


2006-11-21  Luca Ferretti  <elle.uca@libero.it>

	* python/FUSE/trackerfs.py:
	Updated by Eugenio Cutolo.

2006-11-21  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-search-tool.c:
	Reduce the number of translable messages using C style comment
	blocks to exclude unused functions and remove _() macros from
	unused strings.
	Change the window title to match the launcher label.

2006-11-21  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-tag.c:
	* src/libtracker/tracker-search.c:
	Fix a couple of typos in translatable messages.

2006-11-21  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-tag.c:
	* src/libtracker/tracker-search.c:
	Standardized error messages.

2006-11-20  Luca Ferretti  <elle.uca@libero.i>

	* configure.in: Add a check for glib >= 2.12.0 and
	define HAVE_RECENT_GLIB.

	* src/libtracker/tracker-tag.c: Use g_option_context_set_summary
	only if HAVE_RECENT_GLIB is defined.

2006-11-20  Jamie McCracken <jamiemcc at gnome org>

	* updateded desktop files
	* fixed t-s-t to let back/forward buttons to remain sensitive if applicable
	* fixed resizing of columns in t-s-t
	* improved snippet generation
	* made snippet call async in t-s-t
	* made use of tracker's mime instead of slower Gnome-vfs mime detection in t-s-t

2006-11-19  Jamie McCracken <jamiemcc at gnome org>

	* fixed snippets so that multiple terms are highlighted
	* used a copied version of function g_utf8_strcasestr from gtksourceview to provide caseless utf-8 searching
	* used utf-8 casefold and normalization in parser
	* tidied up t-s-t
	* made font colour of snippet much clearer
	* made snippets wrap around when resizing t-s-t
	* added icon to both t-s-t and desktop file
	* reduced sqlite cache usage


2006-11-18  Jamie McCracken <jamiemcc at gnome org>

	* Limited tracker-extracts memory usage using setrlimit
	* prevents unreasonable memory usage (especially mistaken treatment of large binary files as video files)
	* fixed rdf bug where a search term without a query could not be executed

2006-11-18 Laurent Aguerreche <laurent aguerreche at free fr>

	* added more tmeplate filters
	* improved use of tmp directory for temporary stuff


2006-11-16 Laurent Aguerreche <laurent aguerreche at free fr>

	* added missing OOO templates to our filters


2006-11-16 Eugenio <me at eugesoftware com>

	* added fuse based trackerdfs to our python tools


2006-11-16 Edward Duffy <eduffy at gmail com>

	* added timeout to all external processes used by tracker


2006-11-16  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-tag.c:
	Add l10n/i18n support, changing some messages for a better
	translation experience.

2006-11-15 Edward Duffy <eduffy at gmail com>

	* added xdg-open to t-s-t with fallback to gnome-open

2006-11-15 Laurent Aguerreche <laurent aguerreche at free fr>

	* added desktop files to debs

2006-11-15  Luca Ferretti  <elle.uca@libero.it>

	 * */.cvsignore: Add cvs ingore files.

2006-11-12 Laurent Aguerreche <laurent aguerreche at free fr>

	* changed html filter to use w3m

2006-11-12 Gergan Penkov <gergan at gmail com>

	* fixed dbus warning

2006-11-12 Edward Duffy <eduffy at gmail com>

	* added abiword and xml text filters

2006-11-12  Deji Akingunola <dakingun gmail com>

	* added tracker.spec file
	* added trackerd.desktop file

2006-11-12  Jamie McCracken <jamiemcc at gnome org>

	* fixed fam backend

2006-11-11  Jamie McCracken <jamiemcc at gnome org>

	* fixed bug in rdf query so that non file objects are supported by default
	* fixed gstreamer extractor to time out after a few seconds (this prevents it hanging with some movie files)


2006-11-10 Edward Duffy <eduffy at gmail com>

	* Downgraded libpoppler requirements


2006-11-10  Deji Akingunola <dakingun gmail com>

	* added .desktop file for tracker-search-tool

2006-11-10  Luca Ferretti  <elle.uca@libero.it>

	* configure.in:
	Replace AM_GLIB_DEFINE_LOCALEDIR with a custom test and AC_DEFINE
	due to the bug #343825 (glib vs. autoconf >= 2.60). See also
	http://lists.debian.org/debian-gtk-gnome/2006/06/msg00001.html
	(from Laurent Aguerreche)

2006-11-10  Luca Ferretti  <elle.uca@libero.it>

	* debian/tracker-dev.docs:
	* debian/tracker-dev.install:
	Removed from cvs (from Laurent Aguerreche)

2006-11-09  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-search.c:
	Restore #include <locale.h> (maybe needed on some systems) and
	move setlocale() before *textdomain() (from Laurent Aguerreche)

2006-11-09  Luca Ferretti  <elle.uca@libero.it>

	* Makefile.am:
	* debian/tracker-utils.manpages:
	* dedian/tracker.manpages:
	Add missing manpages for deb packages which have to be
	distributed by "make dist" (patch by Laurent Aguerreche)

2006-11-09  Hendrik Richter  <hendrikr@gnome.org>

	* configure.in: Added "de" to ALL_LINGUAS

2006-11-09  Luca Ferretti  <elle.uca@libero.it>

	* src/libtracker/tracker-search.c:
	Restore "setlocale" call. Now localization should work at runtime
	for this tool (by Laurent Aguerreche)

2006-11-09  Luca Ferretti  <elle uca libero it>

	* fixed "make dist" for intltool-* stuff (by Laurent Aguerreche)

2006-11-07 Luca Ferretti <elle uca libero it>

	* added internationlisation support to tracker and t-s-t

2006-11-07 Laurent Aguerreche <laurent aguerreche at free fr>

	* fixed bad comment tag in mplayer extractor


2006-11-07  Julien <julienc psychologie-fr org>

	* fixed bug in tracker-query so that service types are enabled



2006-11-07  Jamie McCracken <jamiemcc at gnome org>

	* fixed bug in plain text sniffer



2006-11-05 <tpgww@onepost.net>

	* cleanups to remove compiler warnings

2006-11-05 Laurent Aguerreche <laurent aguerreche at free fr>

	* improved use of tmp directory
	* added gstreamer based extractor for audio and video tags
	* cleaned up other extractors


2006-11-01  Jamie McCracken <jamiemcc at gnome org>

	* emebedded sqlite with threadsafe mode enabled
	* inlined sqlite code and made it a prvate non-installable lib which is statically linked in
	* fixed initilaisations of vars in mp3-extract to prevent segfaults


2006-11-01  Luca Ferretti  <elle uca at libero it>

	* fixed build (Makefile, not MakeFile)

2006-10-30 Laurent Aguerreche <laurent aguerreche at free fr>

	* fixed and cleaned debian build
	* fixed build of man pages


2006-10-30 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* created python based notification applet for tracker


2006-10-29 Bastien Nocera <hadess hadess net>

	* totem parsing speedup


2006-10-29 Laurent Aguerreche <laurent aguerreche at free fr>

	* Updated debian build
	* cleaned up process
	* added new package for tracker-search-tool


2006-10-29 Jamie McCracken <jamiemcc at gnome org>

	* fixed tag error when setting a new tag on a file


2006-10-29 Eskil Bylund <eskil at letterboxes org>

	* fixed window sizing of tracker-search-tool
	* added buttonbox for prev/next buttons in t-s-t

2006-10-29 Ulrik Mikaelsson <ulrik mikaelsson gmail com>

	* fixed leak in GetMetadataForFilesInFolder
	* fixed field checking in GetMetadataForFilesInFolder
	* added dbus argument error handling
	* fixed issue with tracker-tag not reporting file not found
	* added comamnd line args to t-s-t


2006-10-29 tobutaz <tobutaz gmail com>

	* imporved ioprio detection and operation


2006-10-29 Mikkel Kamstrup Erlandsen <mikkel kamstrup gmail com>

	* added grey lettering for snippet


2006-10-29 Baptiste Mille-Mathias <baptiste.millemathias gmail com>

	* added initial manpages for the tracker command line tools


2006-10-22 Richard Quirk <quirky@zoom.co.uk>

	* fixed potential crasher in tracker_db_search_text

2006-10-22 Jamie McCracken <jamiemcc at gnome org>

	* updated debian folder and files to build debs
	* fixed tracker.pc to use libtrackerclient
	* fixed bug where data flushing to qdbm could end up in an infinite loop


2006-10-22 Eskil Bylund <eskil at letterboxes org>

	* build fix for make dist
	* fix for tracker-search-tool's handling of filenames by escaping them


2006-10-16 Jamie McCracken <jamiemcc at gnome org>

	* Fixed gui
	* added buttons
	* cleaned up code
	* created dbus methods to get snippets


2006-10-17 Edward Duffy <eduffy at gmail com>

	* Made a totem extractor
	* Fix for pdf extractor



2006-10-16 Jamie McCracken <jamiemcc at gnome org>

	* Added optional periodic fsync and fast mode to make tracker more background friendly
	* Added intermediate temp storage of words so that most common words are applied at the end to prevent fragmentation
	* Added sheduling
	* Made sure tracker daemon is now really smooth
	* fixed a few leaks

2006-10-16 Edward Duffy <eduffy at gmail com>

	* Made an mplayer extractor
	* Fix for potential crasher in tracker-extract
	* Fix for autotools


2006-10-11 Jamie McCracken <jamiemcc at gnome org>

	* Fixed crasher by applying a mutex to guard non-threadsafe stemmer


2006-10-12 Marcus Fritzsch <fritschy at googlemail com>

	* Patch to make sure ignore dirs argument is treated as an array


2006-10-11 Jamie McCracken <jamiemcc at gnome org>

	* Created command line options for trackerd
	* Created more extensive options for tuning performance/memory and disk space usage - new config file format
	* Removed LibExtractor dependency
	* created new mp3 extractor for id3 id3v21, id3v22, id3v23 and id3v24
	* added snowball stemmers (as a static library)
	* added multi language stopword files
	* added support for determining which language to use by default based on locale
	* made sure only lstat is used to prevent symlink directories from being followed

2006-10-11 Jedy Wang <Jedy Wang at Sun COM>

	* Patch to improve compilation on Solaris


2006-10-08 Jamie McCracken <jamiemcc at gnome org>

	* Created tracker-search-tool (based on gnome-search-tool)
	* Bug fix for handling uri's without a leading backslash in indexing
	* tuned indexer



2006-10-07 Laurent Aguerreche <laurent aguerreche at free fr>

	* Made Thunderbird backend aware of vfolders


2006-10-05 Laurent Aguerreche <laurent aguerreche at free fr>

	* Email uri fixes


2006-10-05 Jamie McCracken <jamiemcc at gnome org>

	* blocked extraction of non-regular files


2006-10-05 Marcus Fritzsch <fritschy at googlemail com>

	* Patch to make sure NULL is returned if no date is available in tracker_db_get_field_def


2006-10-03 Laurent Aguerreche <laurent aguerreche at free fr>

	* Cleaned up tracker-db-sqlite source
	* Fixed potential crasher where g_free was being used on a g_lice allocation

2006-10-03 Jamie McCracken <jamiemcc at gnome org>

	* fixed retrieval of metadata types
	* fixed Metadata.Get method
	* fixed Files.GetByMimeType
	* added python stuff to repository
	* added lyrics.py ripped from rhythmbox and modded by Samuel Cormier-Iijima
	* added nautilus tag tabs written by Edward Duffy


2006-10-03 Edward Duffy <eduffy at gmail com>

	* added libgsf extractor for ms office files
	* added open document thumbnailers
	* fix for sqlite sql
	* fixed auto tagging


2006-10-03 Anders Aagaard <aagaande at gmail com>

	* added ionice support


2006-10-02 Laurent Aguerreche <laurent aguerreche at free fr>

	* Force email body to return plain text instead of html
	* Fixed signedness warnings in xdgmime


2006-10-02 Jamie McCracken <jamiemcc at gnome org>

	* restructured database for email support
	* Fixed RDF Query to work with sqlite
	* Added sqlite sql functions (display of dates)
	* Added keywords support to rdf query
	* Changed most of the a{sv} dbus methods to aas
	* Modified command line tools to use aas
	* removed redundant dbus methods and parameters


2006-10-01 Laurent Aguerreche <laurent aguerreche at free fr>

	* Added Kmail email support
	* Added fixes for sqlite


2006-10-01 Jamie McCracken <jamiemcc at gnome org>

	* restructured database
	* Used Curia instead of Depot for inverted index as its more scalable
	* Fixed issues with new indexer
	* Fixed keywords to update indexer properly
	* Fixed keyword search and list methods
	* Added auto tag support for Doc.Keywords and Image.Keywords (based on patch by Edward Duffy)
	* Auto optimize index after first run and automatically after user settable no of updates


2006-09-27 Edward Duffy <eduffy at gmail com>

	* made internal extractors external and intgrated into tracker-extract
	* added extractors for images

2006-09-27 Jamie McCracken <jamiemcc at gnome org>

	* fix bug with search text (correct no of results now returned)
	* got search mime , search location and search mime location working
	* replaced bzip compression with zlib



2006-09-26 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Added #ifdefs to make libpoppler usage optional


2006-09-26 Jamie McCracken <jamiemcc at gnome org>

	* fix bug with get_metadata routine expecting metadata name and not metadata id


2006-09-25 Jamie McCracken <jamiemcc at gnome org>

	* Integrated new indexer and parser into tracker/sqlite
	* Added support for insert, update and delete
	* performs differential indexing for updates
	* got tracker-search to function with it

2006-09-25 Edward Duffy <eduffy at gmail com>

	* added internal extractors for pdf, OpenDocument, Abiword and Postscript

2006-09-25 Fabien VALLON <fabien at sonappart net>

	* Did an initial ogg extractor

2006-09-25 Laurent Aguerreche <laurent aguerreche at free fr>

	* Added thunderbird email support
	* Added fixes for detecting deleted and junk emails in Evolution mail parser

2006-09-21 Laurent Aguerreche <laurent aguerreche at free fr>

	* Added detection of deleted and junk messages to email indexing


2006-09-21 Edward Duffy <eduffy at gmail com>

	* added jpeg and png thumbnailers


2006-09-21 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Inotify patch to clean up code
	* Also made sure inotify timeout for file move detection is removed when no moved files are pending (this prevents tracker from peridoically waking up)
	* added g_message support for logging messages

2006-09-21 Laurent Aguerreche <laurent aguerreche at free fr>

	* Added initial email indexing support
	* Added indexing of evolution emails
	* Added indexing of email attachments


2006-09-21 Jamie McCracken <jamiemcc at gnome org>

	* Created Test suite for new indexer
	* fixed bugs in indexer


2006-09-19 Jamie McCracken <jamiemcc at gnome org>

	* Finished tracker's new indexer


2006-09-19 Fabien VALLON <fabien at sonappart net>

	* Added retrieval of tracke number to tracker-extract


2006-09-18 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Added search by service option to tracker-search


2006-09-17 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Added Goption and limit option to tracker-search


2006-09-16 Jamie McCracken <jamiemcc at gnome org>

	* Fixed erroneous rdf query where returned values were null


2006-09-16 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Patch to fix sqlite sql
	* Patch to fix race condition in request thread


2006-09-16 Jamie McCracken <jamiemcc at gnome org>

	* More work on tracker-indexer



2006-09-12 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Patch to fix segfault when retrieveing metadata
	* Patch to use g_slice_new0 instead of g_slice_new



2006-09-11 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Patch to fix sending of null values on Dbus
	* Also fix for erroneous g_free on a g_slice allocation


2006-09-13 Jamie McCracken <jamiemcc at gnome org>

	* Tidied up tracker-GUI
	* Inline libsexy widget
	* extended parser to support line by line indexing
	* added more functionality to new indexer


2006-09-13 Edward Duffy <eduffy at gmail com>

	* Enhanced tracker GUI
	* fixed display of sexy icon entry


2006-09-13 Jaime Frutos Morales <acidborg at gmail com>

	* Patch to add skeleton for tracker GUI


2006-09-11 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Patch to add Goption support for tracker-tag


2006-09-11 Laurent Aguerreche <laurent aguerreche at free fr>

	* Added option to disable thumbnail generation


2006-09-11 Jamie McCracken <jamiemcc at gnome org>

	* Added bug fixes to sqlite functionality



2006-09-10 Jamie McCracken <jamiemcc at gnome org>

	* Added rough sqlite support


2006-09-10 Laurent Aguerreche <laurent aguerreche at free fr>

	* Fixed symlink problem
	* More code cleanup


2006-09-07 Laurent Aguerreche <laurent aguerreche at free fr>

	* Handled Dbus Connection shutdown gracefully
	* tracker deamon now shuts down smoothly when dbus session bus is stopped
	* Big code cleanup


2006-09-06 Jamie McCracken <jamiemcc at gnome org>

	* Finishsed db abstractions
	* Added initial sqlite support


2006-09-02 Laurent Aguerreche <laurent aguerreche at free fr>

	* Fix for Rdf-query parser to allow "contains" function to be called more easily


2006-09-02 Laurent Aguerreche <laurent aguerreche at free fr>

	* Added locale handling for non utf-8 files
	* Made sure all filenames passed to posix system calls are translated to user's locale
	* made sure all results are displayed in user's locale
	* cleaned up code


2006-09-02 Jamie McCracken <jamiemcc at gnome org>

	* Added more abstractions for db calls

2006-08-25 Jamie McCracken <jamiemcc at gnome org>

	* Improved thread synchronisation speed
	* Fixed potential deadlock as pointed out by Laurent Aguerreche <laurent aguerreche at free fr>
	* Improved exiting

2006-08-21 Gergan Penkov <gergan at gmail com>

	* Fix sql for an SP

2006-08-21 Jamie McCracken <jamiemcc at gnome org>

	* Improved thread synchronisation using G_COND and g_cond_signal and g_cond_wait
	* Eliminated redundant mutexes (file available/metadata available)
	* Restructured threads to be more efficient
	* Added two phase program halt so that stuff ends gracefully and all threads are exited smoothly


2006-08-21 Laurent Aguerreche <laurent aguerreche at free fr>

	* Patch to fix signal handling amongst threads
	* Jamie McCracken heavily modified this patch to make sure it avoids deadlocks and race conditions


2006-08-19 Laurent Aguerreche <laurent aguerreche at free fr>

	* Patch to fix debain build
	* split up tracker into several debs
	* Fixed make dist in autofoo


2006-08-19 Jamie McCracken <jamiemcc at gnome org>

	* Abstracted all mysql specific stuff into tracker-db-mysql
	* Paved the way to support alternative backends like sqlite/qdbm


2006-08-13 Jamie McCracken <jamiemcc at gnome org>

	* Added new tracker-file-convert to convert text file into list of unique words with associated counts
	* Added support for stemming
	* Added new parsing word breaker
	* Added experimental (but currently disabled) qdbm indexing (tracker-indexer c)


2006-08-13 Marcus Fritzsch <fritschy at googlemail com>

	* Patch to make sure a dbus reply is sent if the rdf query string is NULL or erroneous


2006-08-03 Marcus Fritzsch <fritschy at googlemail com>

	* Patch to make sure query is not null in tracker_exec_sql


2006-08-03 Jamie McCracken <jamiemcc at gnome org>

	* Added new Dbus methods for File Exists and File GetServiceType


2006-08-02 Jamie McCracken <jamiemcc at gnome org>

	* Added new command line tool tracker-files


2006-08-02 Edward Duffy <eduffy at gmail com>

	* Patch for small fix to XdgMime



2006-08-02 Jedy Wang <Jedy Wang at Sun COM>

	* Patch to add build instructions for Solaris to README file



2006-08-02 Laurent Aguerreche <laurent aguerreche at free fr>

	* Patch to fix sql


2006-08-01 Jamie McCracken <jamiemcc at gnome org>

	* Added offset parameter to search methods



2006-07-31 Jedy Wang <Jedy Wang at Sun COM>

	* Patch to improve compilation on Solaris



2006-07-31 Jamie McCracken <jamiemcc at gnome org>

	* Added realpath for file parameters in command line tools
	* Improved search terms to *and* them by default
	* added support for OR in search terms
	* added support for excluding a search term
	* added bugfixed XDGMIME from Beagle to prevent crashes


2006-07-30 Marcus Fritzsch <fritschy at googlemail com>

	* Patch to make build more debian friendly


2006-07-30 Jedy Wang <Jedy Wang at Sun COM>

	* Patch to fix crasher on solaris



2006-07-30 Christoph Laimburg <christoph laimburg at rolmail net>

	* Patch to replace deprecated dbus call (dbus_connection_disconnect)


2006-07-30 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Patch to add RegExp rdf query extension support


2006-07-30 Samuel Cormier-Iijima <sciyoshi at gmail com>

	* Modified patch to make no watch directories parameter functional



2006-07-30 Jamie McCracken <jamiemcc at gnome org>

	* Added new command line tools (tracker-tag)
	* Fixed bugs in tracker-search methods
	* Fixed bugs in tracker-query


2006-07-25 Jamie McCracken <jamiemcc at gnome org>

	* Sorted out libtracker
	* updated to reflect new dbus interfaces
	* Added new command line tools


2006-07-22  Jamie McCracken <jamiemcc at gnome org>

	* Created new dbus interface for Search and Files
	* Added new methods to create richer dbus functionality
	* Ported over existing metadata methods to new interface


2006-07-18  Jamie McCracken <jamiemcc at gnome org>

	* Created new dbus interface for Keywords
	* Added new methods for adding, removing and searching keywords


2006-07-11  Jamie McCracken <jamiemcc at gnome org>

	* Created new dbus interface for Metadata
	* Added new methods for registering and querying metadata types
	* Ported over existing metadata methods to new interface



2006-06-30  Jamie McCracken <jamiemcc at gnome org>

	* Added New Dbus Interface Methods
	* Added GetStats, GetServices and GetVersion



2006-06-12  Jamie McCracken <jamiemcc at gnome org>

	* Reworked rdf query functionality
	* Optimised it for performamce
	* Added new extensions for Contains and StartsWith



2006-05-17  Gergan Penkov <gpp666_999 at yahoo de>

	* Fix for conifgure in (added ssl linking due to bug in mysql)


2006-05-14  Jamie McCracken <jamiemcc at gnome org>

	* Improved metadata support for Exif fields
	* Created new stats for indexed files
	* Created new file orientated services

2006-05-07  Jamie McCracken <jamiemcc at gnome org>

	* Fixed crasher in date parser
	* Improved UTF-8 conversion of metadata
	* Improved Inotify header checks (now looks for sys/inotify h as well as linux/inotify h)
	* Fixed build issues on FC5


2006-05-05  Jamie McCracken <jamiemcc at gnome org>

	* Hugely optimised indexing when many files are waiting to be indexed
	* Mass queueing of files no longer blocks the main thread
	* Fixed minor memory leak in new date parser


2006-05-01  Jamie McCracken <jamiemcc at gnome org>

	* Migrated embedded database to mysql 5
	* Removed all parameterized queries and replaced with stored procedures
	* New stored procedures to encapsulate DB functionality and remove most DB logic from application
	* Simplified C code when interfacing with DB
	* Added support for parsing dates in various formats including conversion to/from ISO 8601 format
	* Fixed MsWord filter to prevent looping (WvText causes inotify to report file write change causing endless looping)
	* Redesigned DB structure to be more generic and service orientated
	* Added support for service types (first class objects) to DB
	* Renamed tables to be more service orientated
	* Added DB versioning data to DB so future DB changes can be implemented painlessly (and without requiring a rebuild of all indexed data)


2006-04-22  Dan Nicolaescu <dann at ics uci edu>

	* Patch to fix correct use of argv
	* Ensure correct message printed if wrong no of arguments supplied


2006-04-22  Dan Nicolaescu <dann at ics uci edu>

	* Patch to fix build for Fedora Core 5


2006-04-22  Nate Nielsen  <nielsen at memberwewbs com>

	* Fix compile warnings, crasher


2006-03-28  Jamie McCracken <jamiemcc at gnome org>

	* Redesigned Dbus Interface to be more generic and cleaned up code
	* Corrected search results of hyphenated search terms
	* Added support for maximum hit count to search queries
	* Added optional support for sorting search results by relevance score

2006-03-12  Jamie McCracken <jamiemcc at gnome org>

	* Updated to latest XDGMime
	* Fixed bugs with filename metadata type not being updated in a file move operation
	* Improved speed of some intoify operations



2006-02-27  Jamie McCracken <jamiemcc at gnome org>

	* Added inotify support
	* Optimised inotify move support
	* Improved Build system
	* Can use an external libextractor if found during compilation
	* Fixed some leaks
	* Fixed threading issues with new inotify backend


2006-01-14  Jamie McCracken <jamiemcc at gnome org>

	* Updated libtracker to be more usable especially for Nautilus search


2006-01-11  Jamie McCracken <jamiemcc at gnome org>

	* Improved file change handling by creating a pending file
	  queue and a pending File Database table  This allows changes
	  awaiting processing by the tracker daemon to be handled much
	  more efficiently with respect to memory usage


2006-01-06  Jamie McCracken <jamiemcc at gnome org>

	* Added fallback polling mechanism to trackerd c  This kicks
	  in if iNotify/FAM is not available (IE if home directory
	  is on an NFS mount) or if iNotify/FAM watch limits have
	  been exceeded


2005-12-13  Jamie McCracken <jamiemcc at gnome org>

	* Imported initial version of Tracker into CVS


2005-09-15 Jamie McCracken <jamiemcc at gnome org>

	* Tracker Project started




